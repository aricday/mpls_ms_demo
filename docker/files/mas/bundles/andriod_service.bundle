<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
        <l7:Bundle xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management">
            <l7:References>
                <l7:Item>
                    <l7:Name>OTK Caching Customization</l7:Name>
                    <l7:Id>c2656fd5ff575252902a7e330e355f53</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.242Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="a2206e7c-28e8-489d-862d-3b7c6da78079" id="c2656fd5ff575252902a7e330e355f53" version="0">
                            <l7:PolicyDetail folderId="161861da3a78c5dcdc62696d169147d0" guid="a2206e7c-28e8-489d-862d-3b7c6da78079" id="c2656fd5ff575252902a7e330e355f53" version="0">
                                <l7:Name>OTK Caching Customization</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**********************************************&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;This policy gets executed whenever an OTK Cache * assertion is used.&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;This policy can be modified in order to set default configuration values for caches that are introduced.&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;For each cache follow the example shown below:&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;- Add an 'All assertions must evaluate to true' assertion&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;- Check for the cacheID (name) and set values appropriately&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;**&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;***** OTK Cache Look Up Customization *****&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** Customizable hook for cache lookup.  This is used by OTK Cache Handler as a policy fragment&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** Available context variables:&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** cacheID (String) - the ID of the cache to be stored&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** cacheKey - the key associated with the value to be looked up&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** maxEntryAge - the max age in seconds for entries into this cache&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;**&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;***** OTK Cache Store Customization *****&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** Customizable hook for cache store.  This is used by OTK Cache Handler as a policy fragment, and is called for REMOVE, STORE and FLUSH operations&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** Available context variables:&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** cacheID (String) - the ID of the cache to be stored&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** cacheKey - the key associated with the given value for the cache identified by cacheID&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** maxEntries - the maximum number of entries allowed in the cache.  Adding more than this limit would force some existing items to be removed.&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** maxEntryAge - the max age in seconds for entries into this cache&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** maxEntrySize - the maximum size in bytes allowable for the value&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;**********************************************&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** NOTE:  only one maxEntryAge, maxEntrySize and maxEntries value is supported per cacheID &quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;** Changing any of these values after the cache has been created will result in the cache configuration being updated.&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
        &lt;/wsp:All&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**********************************************&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore L7p:Enabled=&quot;false&quot; wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cacheID}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;myCache&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;myCache&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${maxEntryAge}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;// configure the new lifetime&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;MTIwMA==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;maxEntryAge&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;maxEntryAge&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// check if an entryAge has been given&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// configure number of valid entries&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;maxEntries&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// configure entrySize for cache entries&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAwMDA=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;maxEntrySize&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;myCache&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;// sample configuration where a given maxEntryAge is accepted but maxEntrySize, maxEntries given in the Cache UI are being ignored&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cacheID}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;anotherCache&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;anotherCache&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// configure the new lifetime&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTIwMA==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;maxEntryAge&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// configure number of valid entries&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;maxEntries&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// configure entrySize for cache entries&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAwMDA=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;maxEntrySize&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;anotherCache&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;// sample configuration where maxEntryAge, maxEntrySize, maxEntries given in the Cache UI are being ignored&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:TrueAssertion/&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;example&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// configure default values per cacheID&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Cache Look Up Customization</l7:Name>
                    <l7:Id>161861da3a78c5dcdc62696d16914896</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.243Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="df0a2c11-cf6e-47da-84c0-032bf7f3b6d2" id="161861da3a78c5dcdc62696d16914896" version="0">
                            <l7:PolicyDetail folderId="161861da3a78c5dcdc62696d169147d0" guid="df0a2c11-cf6e-47da-84c0-032bf7f3b6d2" id="161861da3a78c5dcdc62696d16914896" version="0">
                                <l7:Name>OTK Cache Look Up Customization</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;***** OTK Cache Look Up Customization *****&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Available context variables:&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** cacheID (String) - the ID of the cache to be stored&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** cacheKey - the key associated with the value to be looked up&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** maxEntryAge - the max age that the cache was originally created with&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Must return:  the variable 'resp' as a Message for found content&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Must fail if the looked up value does not exist!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Replace the assertion below if desired with an assertion that supports key- value data structures&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** If this assertion is replaced also replace it at 'OTK Cache Store Customization'&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CacheLookup&gt;
            &lt;L7p:CacheEntryKey stringValue=&quot;${cacheKey}&quot;/&gt;
            &lt;L7p:CacheId stringValue=&quot;${actualCacheID}&quot;/&gt;
            &lt;L7p:ContentTypeOverride stringValue=&quot;&quot;/&gt;
            &lt;L7p:MaxEntryAgeSeconds stringValue=&quot;${maxEntryAge}&quot;/&gt;
            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;resp&quot;/&gt;
            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
        &lt;/L7p:CacheLookup&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Cache Store Customization</l7:Name>
                    <l7:Id>161861da3a78c5dcdc62696d16914883</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.244Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="2294fc5e-0adf-4d4b-b44d-8d1252f024c9" id="161861da3a78c5dcdc62696d16914883" version="0">
                            <l7:PolicyDetail folderId="161861da3a78c5dcdc62696d169147d0" guid="2294fc5e-0adf-4d4b-b44d-8d1252f024c9" id="161861da3a78c5dcdc62696d16914883" version="0">
                                <l7:Name>OTK Cache Store Customization</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;***** OTK Cache Store Customization *****&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**********************************************&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Available context variables:&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** cacheID (String) - the ID of the cache to be stored&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** cacheKey - the key associated with the given value for the cache identified by cacheID&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** maxEntries - the maximum number of entries allowed in the cache.  Adding more than this limit would force some existing items to be removed.&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** maxEntryAge - the maximum length (seconds) to keep entries in the cache.  &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** maxEntrySize - the maximum size in bytes allowable for the value&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Replace the assertion below if desired with an assertion that support key- value data structures&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** If this assertion is replaced also replace it at 'OTK Cache Look Up Customization'&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CacheStorage&gt;
            &lt;L7p:CacheEntryKey stringValue=&quot;${cacheKey}&quot;/&gt;
            &lt;L7p:CacheId stringValue=&quot;${actualCacheID}&quot;/&gt;
            &lt;L7p:MaxEntries stringValue=&quot;${maxEntries}&quot;/&gt;
            &lt;L7p:MaxEntryAgeSeconds stringValue=&quot;${maxEntryAge}&quot;/&gt;
            &lt;L7p:MaxEntrySizeBytes stringValue=&quot;${maxEntrySize}&quot;/&gt;
            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;msg&quot;/&gt;
            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
        &lt;/L7p:CacheStorage&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Cache Handler</l7:Name>
                    <l7:Id>161861da3a78c5dcdc62696d16914861</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.269Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="65eff071-9a97-415b-8ebb-8e711ffd738d" id="161861da3a78c5dcdc62696d16914861" version="0">
                            <l7:PolicyDetail folderId="161861da3a78c5dcdc62696d1691481a" guid="65eff071-9a97-415b-8ebb-8e711ffd738d" id="161861da3a78c5dcdc62696d16914861" version="0">
                                <l7:Name>OTK Cache Handler</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Required changes can be implemented in policies in the 'Customizations' folder &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === The policies within that folder are named: &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === OTK Caching Customization, OTK Cache Look Up Customization, OTK Cache Store Customization&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you find you cannot add your customizations using the policies in the 'Customizations' folder&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;******** OTK Cache Handler *******&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;******** DO NOT CALL or use this policy directly.  It is included as a Policy Fragment in the following policies:&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;******** 1. OTK Cache Look Up&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;******** 2. OTK Cache Store&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;******** 3. OTK Cache Remove&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;******** 4. OTK Cache Flush&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;******** Please use one of the above policies instead&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:Expression1 stringValue=&quot;${maxEntryAge}&quot;/&gt;
                &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;// configure default lifetime&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:Base64Expression stringValue=&quot;MzAw&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;maxEntryAge&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;maxEntryAge&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// check if an maxEntryAge has been given&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:Expression1 stringValue=&quot;${maxEntrySize}&quot;/&gt;
                &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;// configure default size in byte&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:Base64Expression stringValue=&quot;MTAwMDA=&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;maxEntrySize&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;maxEntrySize&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// check if an maxEntrySize has been given&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:Expression1 stringValue=&quot;${maxEntries}&quot;/&gt;
                &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;new&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;// configure default number of entries&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:Base64Expression stringValue=&quot;MTAwMDA=&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;maxEntries&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;maxEntries&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// check if an maxEntries has been given&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:Include&gt;
            &lt;L7p:PolicyGuid stringValue=&quot;a2206e7c-28e8-489d-862d-3b7c6da78079&quot;/&gt;
        &lt;/L7p:Include&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHtjYWNoZUlEfSR7bWF4RW50cnlBZ2V9&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;actualCacheID&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cache.op}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;GET&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;GET&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue=&quot;df0a2c11-cf6e-47da-84c0-032bf7f3b6d2&quot;/&gt;
                &lt;/L7p:Include&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;GET&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cache.op}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;GET&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;GET&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${cache.op}&quot;/&gt;
                        &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                        &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item dataType=&quot;included&quot;&gt;
                                &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;FLUSH&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;MA==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;maxEntryAge&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;== SET&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// maxEntryAge to 0 for FLUSH operation&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:Include&gt;
                        &lt;L7p:PolicyGuid stringValue=&quot;2294fc5e-0adf-4d4b-b44d-8d1252f024c9&quot;/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;NTAw&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;OTHER&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;// STORE, REMOVE, FLUSH&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;operations&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Cache Look Up</l7:Name>
                    <l7:Id>161861da3a78c5dcdc62696d16914bbb</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.277Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="fb88be42-83e7-4d36-a865-34e53d4f4218" id="161861da3a78c5dcdc62696d16914bbb" version="0">
                            <l7:PolicyDetail folderId="161861da3a78c5dcdc62696d1691481a" guid="fb88be42-83e7-4d36-a865-34e53d4f4218" id="161861da3a78c5dcdc62696d16914bbb" version="0">
                                <l7:Name>OTK Cache Look Up</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;***** OTK Cache Look Up ********************&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Looks up a cache value from the cache identified by cacheID and maxEntryAge by key: cacheKey.&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**********************************************&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cacheID}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cacheKey}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${maxEntryAge}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;valid&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAz&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;validate&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// check for required fields&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;R0VU&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;cache.op&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;maxEntries&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;maxEntrySize&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;== SET&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// context variables for OTK Cache Handler&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:All&gt;
        &lt;L7p:Include&gt;
            &lt;L7p:PolicyGuid stringValue=&quot;65eff071-9a97-415b-8ebb-8e711ffd738d&quot;/&gt;
        &lt;/L7p:Include&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Cache Look Up</l7:Name>
                    <l7:Id>161861da3a78c5dcdc62696d16914c21</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.321Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="161861da3a78c5dcdc62696d16914c21" version="0">
                            <l7:Name>OTK Cache Look Up</l7:Name>
                            <l7:Guid>68ad78a1-f4a1-4568-91e1-0980d95c75cd</l7:Guid>
                            <l7:PolicyReference id="161861da3a78c5dcdc62696d16914bbb" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>cacheID</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>The Cache ID (required)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>cacheKey</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>The Cache Key (identifier) for this entry (required)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>maxEntryAge</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Max. entry age in seconds (optional if a default value exists)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.msg</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>resp</l7:ResultName>
                                    <l7:ResultType>message</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Looks Up an item associated with key: cacheKey in cache with ID: cacheID and returns it in values, if the item exists. </l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>customAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>lookup16.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="passMetricsToParent">
                                    <l7:StringValue>false</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>fb88be42-83e7-4d36-a865-34e53d4f4218</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>#OTK Fail with error message</l7:Name>
                    <l7:Id>bc9a31b7578652a08a514d7d4fef9afd</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.326Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="1a55cc2a-9996-4978-8473-c2a75e5c59d1" id="bc9a31b7578652a08a514d7d4fef9afd" version="0">
                            <l7:PolicyDetail folderId="161861da3a78c5dcdc62696d16914781" guid="1a55cc2a-9996-4978-8473-c2a75e5c59d1" id="bc9a31b7578652a08a514d7d4fef9afd" version="0">
                                <l7:Name>#OTK Fail with error message</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Target Configuration Policy: &amp;quot;OTK Fail with error message&amp;quot;&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;=== Set custom values for Context Variables below ===&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;=== Set Context Variables to override their values in the target policy below ===&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Customizations:&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;DO NOT CHANGE OR OVERWRITE EXISTING ERROR CODES!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Add error codes as desired! Follow the existing pattern!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Create any code in the 700-899 range!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;custom&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;custom&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJjdXN0b21fZXJyb3IiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJDdXN0b20gZXJyb3IgZGVzY3JpcHRpb24iDQp9&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:RaiseError/&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;== custom&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// custom error handling&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTP Fail with error message</l7:Name>
                    <l7:Id>4523fc52bc5d9d089bb24fe624c30982</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.339Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="26f31754-e487-4cff-a1e0-0c11d18254cb" id="4523fc52bc5d9d089bb24fe624c30982" version="0">
                            <l7:PolicyDetail folderId="cbeedf1e2650e80f4d660a7fdb8fee5f" guid="26f31754-e487-4cff-a1e0-0c11d18254cb" id="4523fc52bc5d9d089bb24fe624c30982" version="0">
                                <l7:Name>OTP Fail with error message</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Required changes can be implemented in OTK policies in the 'Customizations' folder &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === The policy within that folder is named '#OTK Fail with error message' &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you find you cannot add your customizations using the policies in the 'Customizations' folder&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy should be used as an encapsulated assertion&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;OTP has error responses configured that are specified here&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;OTP policies pass in an error code and this encapsulated assertion will return appropriate errors&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;DO NOT CHANGE OR OVERWRITE EXISTING ERROR CODES!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;===&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgcmVxdWVzdCBmYWlsZWQgZHVlIHRvIHNvbWUgdW5rbm93biByZWFzb24iDQp9&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;genericServerErrorMsg&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJWYWxpZGF0aW9uIGVycm9yIg0KfQ==&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;validationFailrMsg&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:HandleErrors L7p:Usage=&quot;Required&quot;
            includeIOException=&quot;false&quot; variablePrefix=&quot;errors&quot;&gt;
            &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;140&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;140&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHt2YWxpZGF0aW9uRmFpbHJNc2d9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;140&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;This page is OTP protected. Please select the channel for OTP delivery&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;142&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;142&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHt2YWxpZGF0aW9uRmFpbHJNc2d9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;142&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;The one-time password  submitted is invalid.&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;143&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;143&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHt2YWxpZGF0aW9uRmFpbHJNc2d9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;143&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;The one-time password submitted is expired.&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;144&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;144&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHt2YWxpZGF0aW9uRmFpbHJNc2d9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;144&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;OTP Max Retry exceeded,Try after some time.&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;145&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;145&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAz&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHt2YWxpZGF0aW9uRmFpbHJNc2d9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;145&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;User is suspended because max retries have exceeded, he can try after some time.&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;147&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;147&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NTAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtnZW5lcmljU2VydmVyRXJyb3JNc2d9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;147&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;OTP configuration is missing in the database&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;148&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;148&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NTAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtnZW5lcmljU2VydmVyRXJyb3JNc2d9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;148&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;OTP related configuration in database is invalid&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;149&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;149&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NTAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtnZW5lcmljU2VydmVyRXJyb3JNc2d9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;149&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;OTP delivery to the user failed&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;150&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;150&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NTAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtnZW5lcmljU2VydmVyRXJyb3JNc2d9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;150&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;OTP deletion of old record failed&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;151&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;151&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NTAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtnZW5lcmljU2VydmVyRXJyb3JNc2d9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;151&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Error in creating a new OTP&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;152&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;152&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NTAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtnZW5lcmljU2VydmVyRXJyb3JNc2d9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;152&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Error in updating the db OTP record for the user&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;154&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;154&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHt2YWxpZGF0aW9uRmFpbHJNc2d9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;154&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;No OTP record found for user&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Find the appropriate error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:OneOrMore&gt;
        &lt;/L7p:HandleErrors&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTP Fail with error message</l7:Name>
                    <l7:Id>4523fc52bc5d9d089bb24fe624c30a28</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.339Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="4523fc52bc5d9d089bb24fe624c30a28" version="0">
                            <l7:Name>OTP Fail with error message</l7:Name>
                            <l7:Guid>c9cca8d0-0795-4cae-9e80-2c754b6301c2</l7:Guid>
                            <l7:PolicyReference id="4523fc52bc5d9d089bb24fe624c30982" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>givenErrorCode</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel></l7:GuiLabel>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.msg</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>status</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>OTP errors are defined in this encapsulated assertion. This allows easy maintenance and gives and overview.
                                Pass in the error code for which the HTTP status and error message should be returned.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>Stop16.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>26f31754-e487-4cff-a1e0-0c11d18254cb</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>MAG Fail with error message</l7:Name>
                    <l7:Id>020d2de3d0ee651635de40e179c5f83a</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.356Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="9d1fb1ac-8953-4cf7-b18b-ae63d6d413ac" id="020d2de3d0ee651635de40e179c5f83a" version="0">
                            <l7:PolicyDetail folderId="cbeedf1e2650e80f4d660a7fdb8fee5f" guid="9d1fb1ac-8953-4cf7-b18b-ae63d6d413ac" id="020d2de3d0ee651635de40e179c5f83a" version="0">
                                <l7:Name>MAG Fail with error message</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Required changes can be implemented in OTK policies in the 'Customizations' folder &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === The policy within that folder is named '#OTK Fail with error message' &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you find you cannot add your customizations using the policies in the 'Customizations' folder&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy should be used as an encapsulated assertion&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;OTK has error responses configured that can be extended here&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;MAG policies pass in an error code and this encapsulated assertion will return appropriate errors&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Customizations:&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;DO NOT CHANGE OR OVERWRITE EXISTING ERROR CODES!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;===&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:HandleErrors L7p:Usage=&quot;Required&quot;
            includeIOException=&quot;false&quot; variablePrefix=&quot;errors&quot;&gt;
            &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;CA Mobile API Gateway OTP feature related&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:Encapsulated&gt;
                        &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;c9cca8d0-0795-4cae-9e80-2c754b6301c2&quot;/&gt;
                        &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTP Fail with error message&quot;/&gt;
                        &lt;L7p:NoOpIfConfigMissing booleanValue=&quot;true&quot;/&gt;
                    &lt;/L7p:Encapsulated&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${error.msg}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;Error cases related to device usage and requests&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;101&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;101&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJkZXZpY2VfcmVnaXN0cmF0aW9uX2Vycm9yIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiVGhlIGdpdmVuIEROIGlzIG5vdCB2YWxpZCINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;101&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid DN&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;102&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;102&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJkZXZpY2VfcmVnaXN0cmF0aW9uX2Vycm9yIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiVGhlIGdpdmVuIGNlcnQtZm9ybWF0IGZvciB0aGUgcmVzcG9uc2UgaXMgbm90IHZhbGlkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;102&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid request certificate format&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;104&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;104&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJkZXZpY2VfcmVnaXN0cmF0aW9uX2Vycm9yIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiQW4gaW52YWxpZCBDU1Igd2FzIGZvdW5kIGFuZCBjb3VsZCBub3QgYmUgc2lnbmVkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;104&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid CSR&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;105&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;105&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJkZXZpY2VfcmVnaXN0cmF0aW9uX2Vycm9yIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiVGhlIGRldmljZSBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;105&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;device is already registered&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;106&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;106&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJkZXZpY2VfcmVtb3ZhbF9lcnJvciIsDQogICJlcnJvcl9kZXNjcmlwdGlvbiI6Ik5laXRoZXIgdGhlIGRldmljZSByZWdpc3RyYXRpb24gbm9yIGFzc29jaWF0ZWQgdG9rZW4gKGlkX3Rva2VuLCBvYXV0aF90b2tlbiwgcmVmcmVzaF90b2tlbikgY291bGQgYmUgcmVtb3ZlZCINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;106&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;device related token could not be removed&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;107&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;107&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgZ2l2ZW4gbWFnLWlkZW50aWZpZXIgaXMgZWl0aGVyIGludmFsaWQgb3IgcG9pbnRzIHRvIGFuIHVua25vd24gZGV2aWNlIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;107&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid mag-identifier&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;108&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;108&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgcmVmZXJlbmNlZCBkZXZpY2UgaXMgbm90IGFjdGl2YXRlZCINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;108&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;deactivated device&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;111&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;111&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJkZXZpY2VfYXV0aG9yaXphdGlvbl9lcnJvciIsDQogICJlcnJvcl9kZXNjcmlwdGlvbiI6IlRoZSBzZXJ2aWNlIGlzIHRlbXBvcmFyaWx5IG5vdCBhdmFpbGFibGUiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;111&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;too many connection attempts&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;206&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;206&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgY2xpZW50IGNlcnRpZmljYXRlIGhhcyBleHBpcmVkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;206&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;expired client certificate&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Find the appropriate error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:OneOrMore&gt;
        &lt;/L7p:HandleErrors&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>MAG Fail with error message</l7:Name>
                    <l7:Id>020d2de3d0ee651635de40e179c5f84e</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.357Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="020d2de3d0ee651635de40e179c5f84e" version="0">
                            <l7:Name>MAG Fail with error message</l7:Name>
                            <l7:Guid>15795857-d8a2-4b45-9722-94fc1ce9098a</l7:Guid>
                            <l7:PolicyReference id="020d2de3d0ee651635de40e179c5f83a" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>givenErrorCode</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.msg</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>status</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="artifactVersion">
                                    <l7:StringValue>5f7d404140d965193eceef33e692971d644f41ed</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>This assertion returns an error message related to MAG. Use 'OTK Fail with error message' to invoke this assertion</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>customAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>Stop16.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>9d1fb1ac-8953-4cf7-b18b-ae63d6d413ac</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Cache Store</l7:Name>
                    <l7:Id>161861da3a78c5dcdc62696d16914be5</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.364Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="58143e14-a1cd-4cca-b25a-e2d637a42bbc" id="161861da3a78c5dcdc62696d16914be5" version="0">
                            <l7:PolicyDetail folderId="161861da3a78c5dcdc62696d1691481a" guid="58143e14-a1cd-4cca-b25a-e2d637a42bbc" id="161861da3a78c5dcdc62696d16914be5" version="0">
                                <l7:Name>OTK Cache Store</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;***** OTK Cache Store *********************&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;** Stores the given msg in the cache identified by cacheID and maxEntryAge with key: cacheKey.&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;**********************************************&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cacheID}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${cacheKey}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${maxEntryAge}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${maxEntries}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${maxEntrySize}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;add&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;valid&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAz&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;validate&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// check for required fields&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;U1RPUkU=&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;cache.op&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;== SET&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// context variables for OTK Cache Handler&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:All&gt;
        &lt;L7p:Include&gt;
            &lt;L7p:PolicyGuid stringValue=&quot;65eff071-9a97-415b-8ebb-8e711ffd738d&quot;/&gt;
        &lt;/L7p:Include&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Cache Store</l7:Name>
                    <l7:Id>161861da3a78c5dcdc62696d16914c44</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.365Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="161861da3a78c5dcdc62696d16914c44" version="0">
                            <l7:Name>OTK Cache Store</l7:Name>
                            <l7:Guid>e5ee8bcf-1796-4297-88dd-c838031a6f6a</l7:Guid>
                            <l7:PolicyReference id="161861da3a78c5dcdc62696d16914be5" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>cacheID</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>The Cache ID (required)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>cacheKey</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>The Cache Key (identifier) for this entry (required)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>maxEntries</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Max. number of entries for this cache (optional if a default value exists)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>maxEntryAge</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Max. entry age in seconds (optional if a default value exists)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>5</l7:Ordinal>
                                    <l7:ArgumentName>maxEntrySize</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Max. size for each entry (optional if a default value exists)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>6</l7:Ordinal>
                                    <l7:ArgumentName>msg</l7:ArgumentName>
                                    <l7:ArgumentType>message</l7:ArgumentType>
                                    <l7:GuiLabel>The message to be cached (required, must exist in the preceeding policy context)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.msg</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Writes an item to cache with ID: cacheID with key: cacheKey.  If the cache does not exist, one will be created.  If the key exists, the existing item will be overwritten.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>customAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconBase64">
                                    <l7:StringValue>R0lGODlhEAAQAPcAAAAAAIAAAACAAICAAAAAgIAAgACAgICAgMDAwP8AAAD/AP//AAAA//8A/wD/&#xD;
/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#xD;
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMwAAZgAAmQAAzAAA/wAzAAAzMwAzZgAzmQAzzAAz/wBm&#xD;
AABmMwBmZgBmmQBmzABm/wCZAACZMwCZZgCZmQCZzACZ/wDMAADMMwDMZgDMmQDMzADM/wD/AAD/&#xD;
MwD/ZgD/mQD/zAD//zMAADMAMzMAZjMAmTMAzDMA/zMzADMzMzMzZjMzmTMzzDMz/zNmADNmMzNm&#xD;
ZjNmmTNmzDNm/zOZADOZMzOZZjOZmTOZzDOZ/zPMADPMMzPMZjPMmTPMzDPM/zP/ADP/MzP/ZjP/&#xD;
mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm&#xD;
zGZm/2aZAGaZM2aZZmaZmWaZzGaZ/2bMAGbMM2bMZmbMmWbMzGbM/2b/AGb/M2b/Zmb/mWb/zGb/&#xD;
/5kAAJkAM5kAZpkAmZkAzJkA/5kzAJkzM5kzZpkzmZkzzJkz/5lmAJlmM5lmZplmmZlmzJlm/5mZ&#xD;
AJmZM5mZZpmZmZmZzJmZ/5nMAJnMM5nMZpnMmZnMzJnM/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwA&#xD;
M8wAZswAmcwAzMwA/8wzAMwzM8wzZswzmcwzzMwz/8xmAMxmM8xmZsxmmcxmzMxm/8yZAMyZM8yZ&#xD;
ZsyZmcyZzMyZ/8zMAMzMM8zMZszMmczMzMzM/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8A&#xD;
mf8AzP8A//8zAP8zM/8zZv8zmf8zzP8z//9mAP9mM/9mZv9mmf9mzP9m//+ZAP+ZM/+ZZv+Zmf+Z&#xD;
zP+Z///MAP/MM//MZv/Mmf/MzP/M////AP//M///Zv//mf//zP///yH5BAEAABAALAAAAAAQABAA&#xD;
AAhWAFGg+EewoEGDAgceXEgwYUOGCAX+UwixocOKBS9OlBjxIop+/PpRZPgxZMiRBwWCFIkS4amE&#xD;
Lyui4IeqDyqOJE/xexkT4syaN1tm1MlTaEagRjsWDAgAOw==</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="passMetricsToParent">
                                    <l7:StringValue>false</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>58143e14-a1cd-4cca-b25a-e2d637a42bbc</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Fail with error message</l7:Name>
                    <l7:Id>d1bde3d2021a469e82ebf8cac288bbd1</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.407Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="9e864ce5-1275-477f-a642-b5e867f367a3" id="d1bde3d2021a469e82ebf8cac288bbd1" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fd08e" guid="9e864ce5-1275-477f-a642-b5e867f367a3" id="d1bde3d2021a469e82ebf8cac288bbd1" version="0">
                                <l7:Name>OTK Fail with error message</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Required changes can be implemented in policies in the 'Customizations' folder &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === The policies within that folder will have the same name as this policy but &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === either prefixed with '#' or suffixed with 'Extensions'&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Prefixed policies can be used to overwrite variables of this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Suffixed policies can be used to extend functionality&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you find you cannot add your customizations using the policies in the 'Customizations' folder&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy should be used as an encapsulated assertion&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;OTK has error responses configured that are specified here&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;OTK policies pass in an error code and this encapsulated assertion will return appropriate errors&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;===&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;cache&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;cache errors for performance reasons&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;ZmFpbEVycm9yTWVzc2FnZUNhY2hl&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;cacheName&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;cache&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;remember if a value if cache&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;ZmFsc2U=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;isCached&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:HandleErrors L7p:Usage=&quot;Required&quot;
            includeIOException=&quot;false&quot; variablePrefix=&quot;errors&quot;&gt;
            &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;From cache&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Encapsulated&gt;
                        &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;68ad78a1-f4a1-4568-91e1-0980d95c75cd&quot;/&gt;
                        &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Cache Look Up&quot;/&gt;
                        &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;cacheID&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;${cacheName}&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;cacheKey&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;${givenErrorCode}&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;maxAcceptableAge&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;300&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;maxEntryAge&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;300&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Parameters&gt;
                    &lt;/L7p:Encapsulated&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLm1haW5wYXJ0fQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;cacheValue&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Regex&gt;
                        &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:CaptureVar stringValue=&quot;errordetail&quot;/&gt;
                        &lt;L7p:OtherTargetMessageVariable stringValue=&quot;cacheValue&quot;/&gt;
                        &lt;L7p:Regex stringValue=&quot;status([0-9]{1,10})description(.+)&quot;/&gt;
                        &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtlcnJvcmRldGFpbFsxXX0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtlcnJvcmRldGFpbFsyXX0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;cache&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;remember if a value if cache&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;dHJ1ZQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;isCached&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;from cache&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue=&quot;1a55cc2a-9996-4978-8473-c2a75e5c59d1&quot;/&gt;
                &lt;/L7p:Include&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;CA Mobile API Gateway related&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:Encapsulated&gt;
                        &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;15795857-d8a2-4b45-9722-94fc1ce9098a&quot;/&gt;
                        &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;MAG Fail with error message&quot;/&gt;
                        &lt;L7p:NoOpIfConfigMissing booleanValue=&quot;true&quot;/&gt;
                    &lt;/L7p:Encapsulated&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${error.msg}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;OAuth token validation related&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;990&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;990&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJWYWxpZGF0aW9uIGVycm9yIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;990&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;expired or unknown token&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;991&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;991&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJWYWxpZGF0aW9uIGVycm9yIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;991&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;missing SCOPE, permissions&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;992&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;992&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJWYWxpZGF0aW9uIGVycm9yIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;992&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;no or multiple access_token were provided&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;993&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;993&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJWYWxpZGF0aW9uIGVycm9yIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;993&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;disabled token&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;OAuth authorization page related&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;114&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;114&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlZGlyZWN0X3VyaSIsDQogICJlcnJvcl9kZXNjcmlwdGlvbiI6Ik1pc21hdGNoaW5nIHJlZGlyZWN0X3VyaSINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;114&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;mismatching redirect uri&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;123&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;123&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ewogICJlcnJvciI6ImF1dGhlbnRpY2F0aW9uX2Vycm9yIiwKICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgcmVzb3VyY2Vfb3duZXIgY2FuY2VsbGVkIGF1dGhlbnRpY2F0aW9uIgp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;123&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;resource owner denied authentication&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;124&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;124&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJhY2Nlc3NfZGVuaWVkIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiVGhlIHJlc291cmNlX293bmVyIGRlbmllZCBhY2Nlc3MgdG8gcmVzb3VyY2VzIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;124&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;resource owner denied access to resources&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;110&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;110&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgc2Vzc2lvbiBoYXMgZXhwaXJlZCBvciBhbHJlYWR5IGJlZW4gZ3JhbnRlZC4gVGhlIGxvZ2luIHByb2Nlc3MgaGFzIHRvIGJlIHJlcGVhdGVkIHRvIGJlIHN1Y2Nlc3NmdWwiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;110&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid session&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;Authentication related&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;201&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;201&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX2NsaWVudCIsDQogICJlcnJvcl9kZXNjcmlwdGlvbiI6IlRoZSBnaXZlbiBjbGllbnQgY3JlZGVudGlhbHMgd2VyZSBub3QgdmFsaWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;201&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Invalid client related&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;202&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;202&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgcmVzb3VyY2Ugb3duZXIgY291bGQgbm90IGJlIGF1dGhlbnRpY2F0ZWQgZHVlIHRvIG1pc3Npbmcgb3IgaW52YWxpZCBjcmVkZW50aWFscyINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;202&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Invalid resource owner credentials&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;203&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;203&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAz&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJTU0wgaXMgcmVxdWlyZWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;203&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Missing SSL&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;204&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;204&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAz&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJTU0wgd2l0aCBjbGllbnQgYXV0aGVudGljYXRpb24gaXMgcmVxdWlyZWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;204&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Missing SSL and/or client certificate&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;205&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;205&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAx&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICJlcnJvciI6ImludmFsaWRfcmVxdWVzdCIsDQogImVycm9yX2Rlc2NyaXB0aW9uIjoiVGhlIGNsaWVudCBjZXJ0aWZpY2F0ZSBpcyBub3QgdmFsaWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;205&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid client certificate&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;Others&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;103&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;103&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:Detail stringValue=&quot;no parameters or duplicate parameters or a missing required parameters&quot;/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJNaXNzaW5nIG9yIGR1cGxpY2F0ZSBwYXJhbWV0ZXJzIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;103&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Invalid parameter related&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;112&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;112&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:Detail stringValue=&quot;either an invalid code_challenge or code_challenge_method&quot;/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJ0aGUgY29kZV9jaGFsbGVuZ2Ugb3IgY29kZV9jaGFsbGVuZ2VfbWV0aG9kIGlzIGludmFsaWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;112&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Invalid PKCE parameter&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;113&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;113&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX2dyYW50IiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiVGhlIGdpdmVuIGdyYW50IGlzIGludmFsaWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;113&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid grant&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;115&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;115&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3Njb3BlIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiTm8gcmVnaXN0ZXJlZCBzY29wZSB2YWx1ZSBmb3IgdGhpcyBjbGllbnQgaGFzIGJlZW4gcmVxdWVzdGVkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;115&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;no matching registered SCOPE&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;116&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;116&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJ1bnN1cHBvcnRlZF9yZXNwb25zZV90eXBlIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiTm9uZSBvZiB0aGUgc3VwcG9ydGVkIHJlc3BvbnNlX3R5cGVzIHdlcmUgdXNlZCINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;116&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;unsupported response type&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;117&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;117&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJ1bmF1dGhvcml6ZWRfY2xpZW50IiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiVGhlIGNsaWVudCBtaXNzZXMgYXV0aG9yaXphdGlvbiBmb3IgdGhpcyByZXF1ZXN0Ig0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;117&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;missing client authorization&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;118&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;118&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NTAz&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJ1bnN1cHBvcnRlZF90b2tlbl90eXBlIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoidGhlIGdpdmVuIHR5cGUgb2YgdG9rZW4gaXMgbm90IHN1cHBvcnRlZCINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;118&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;unsupported token type&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;119&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;119&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJ1bnN1cHBvcnRlZF9ncmFudF90eXBlIiwNCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiVGhlIGdpdmVuIGdyYW50X3R5cGUgaXMgbm90IHN1cHBvcnRlZCINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;119&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;unsupported grant_type&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;120&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;120&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgaWRfdG9rZW4gaGFzIG1pc3NpbmcgY2xhaW1zIG9yIGhhcyBleHBpcmVkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;120&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid id_token&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;121&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;121&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgZ2l2ZW4gSldUIGlzIGludmFsaWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;121&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid JWT&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;122&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;122&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgSldUIC0gaWRfdG9rZW4gY291bGQgbm90IGJlIGNyZWF0ZWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;122&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;JWT - id_token could not be created&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;300&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;300&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJDbGllbnQoX2lkKSB2YWx1ZSBjb3VsZCBub3QgYmUgcGVyc2lzdGVkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;300&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;client_id could not be persisted&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;301&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;301&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgdmFsdWUgZm9yICdwZXJzaXN0X3R5cGUnIGlzIG5vdCBzdXBwb3J0ZWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;301&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;unknown persist_type&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;303&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;303&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiDQogICJlcnJvcl9kZXNjcmlwdGlvbiI6IlRoZSBwYXRoIGNvbXBvbmVudCBvZiB0aGUgVVJMIGlzIGludmFsaWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;303&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invald path&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;125&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;125&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJBIHZlcmlmaWVyIGhhcyBhbHJlYWR5IGJlZW4gc2V0Ig0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;125&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Invalid verifier&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;126&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;126&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgZ2l2ZW4gc3RhdHVzIGRvZXMgbm90IG1hdGNoIHRoZSBhY3R1YWwgY2xpZW50IHN0YXR1cyINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;126&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Invalid client_id status&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;127&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;127&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgZ2l2ZW4gY2xpZW50X2lkIGhhcyBleHBpcmVkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;127&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;expired client_id&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;128&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;128&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgY2xpZW50IG5hbWUgaXMgbm90IHZhbGlkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;128&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid client name&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;129&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;129&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgZW52aXJvbm1lbnQgaXMgbm90IHZhbGlkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;129&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid environment&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;130&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;130&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgY2xpZW50IHR5cGUgaXMgbm90IHZhbGlkIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;130&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid client type&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;131&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;131&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgaWRfdG9rZW4gY291bGQgbm90IGJlIGNyZWF0ZWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;131&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;id_token error&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;132&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;132&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgc2VydmVyIGNvbmZpZ3VyYXRpb24gaXMgaW52YWxpZC4gQ29udGFjdCB0aGUgYWRtaW5pc3RyYXRvciINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;132&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid server configuration&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;133&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;133&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgZ2l2ZW4gbWVzc2FnZSBpcyBub3QgYSB2YWxpZCBKU09OIG9iamVjdCINCn0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;133&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;invalid JSON object&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;134&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;134&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgcmVxdWVzdCBkaWQgbm90IG1hdGNoIENPUlMgcmVxdWlyZW1lbnRzIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;134&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;CORS requirements did not match&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;135&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;135&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgbWF4aW11bSBudW1iZXIgb2YgdG9rZW5zIGhhcyBiZWVuIHJlYWNoZWQiDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;135&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Max number of OAuth Sessions reached&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;136&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;136&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX2NvbmZpZ3VyYXRpb24iLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgcHVibGljIGtleSBoYXNoIGNvdWxkIG5vdCBiZSBjcmVhdGVkLiBDb250YWN0IHRoZSBhZG1pbmlzdHJhdG9yIg0KfQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;136&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// public key hash could not be created&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;000&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;000&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NTAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgcmVxdWVzdCBmYWlsZWQgZHVlIHRvIHNvbWUgdW5rbm93biByZWFzb24iDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;000&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;unknown server side error&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:Detail stringValue=&quot;An unknown or empty error code was given: Given: API-Prefix: '${apiPrefix}', erro code: '${givenErrorCode}'. Setting it to '000'&quot;/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;NTAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;override&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;set to '000' since none was given&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;givenErrorCode&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ew0KICAiZXJyb3IiOiJpbnZhbGlkX3JlcXVlc3QiLA0KICAiZXJyb3JfZGVzY3JpcHRpb24iOiJUaGUgcmVxdWVzdCBmYWlsZWQgZHVlIHRvIHNvbWUgdW5rbm93biByZWFzb24iDQp9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:RaiseError/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;no matching&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;the given error code is not handled&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Find the appropriate error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:OneOrMore&gt;
        &lt;/L7p:HandleErrors&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:Expression1 stringValue=&quot;${isCached}&quot;/&gt;
                &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${givenErrorCode}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;c3RhdHVzJHtzdGF0dXN9ZGVzY3JpcHRpb24ke2Vycm9yLm1zZ30=&quot;/&gt;
                    &lt;L7p:ContentType stringValue=&quot;text/plain; charset=UTF-8&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;cacheValue&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:Encapsulated&gt;
                    &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;e5ee8bcf-1796-4297-88dd-c838031a6f6a&quot;/&gt;
                    &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Cache Store&quot;/&gt;
                    &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;cacheID&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;${cacheName}&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;cacheKey&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;${givenErrorCode}&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;doNotCacheSoapFaults&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;true&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;maxEntries&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;100&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;maxEntryAge&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;300&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;maxEntrySize&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;10000&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;msg&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;cacheValue&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Parameters&gt;
                &lt;/L7p:Encapsulated&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;cache&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;cache the error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:TrueAssertion/&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;cache&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;or not to cache&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHthcGlQcmVmaXh9JHtnaXZlbkVycm9yQ29kZX0=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:FalseAssertion/&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Fail with error message</l7:Name>
                    <l7:Id>d1bde3d2021a469e82ebf8cac288bd97</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.407Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="d1bde3d2021a469e82ebf8cac288bd97" version="0">
                            <l7:Name>OTK Fail with error message</l7:Name>
                            <l7:Guid>56bd8147-3ab4-4d09-9460-8b2de02b7a9e</l7:Guid>
                            <l7:PolicyReference id="d1bde3d2021a469e82ebf8cac288bbd1" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>givenErrorCode</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Error code</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>apiPrefix</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>API prefix for error code</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.msg</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>status</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>This assertion returns an error message, http status and content-type value associated with the given 'Error code'.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Error_Handling</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_in_apiPrefix">
                                    <l7:StringValue>A value combined with the given error code. If, for example, an API would be identifiedby the values '1234' and the given error code is '111' the exported variable 'error.code' would contain '1234111'</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_in_givenErrorCode">
                                    <l7:StringValue>A value associated with a certain error. If that value is unkown it will be replaced with '000' within the output variable 'error.code'</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>Stop16.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>9e864ce5-1275-477f-a642-b5e867f367a3</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>#OTK Storage Configuration</l7:Name>
                    <l7:Id>24e6fd7c5b6fb3a96690246c8ac49304</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.409Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="cfa7239a-60e4-483a-9d45-c364f2fb673d" id="24e6fd7c5b6fb3a96690246c8ac49304" version="0">
                            <l7:PolicyDetail folderId="161861da3a78c5dcdc62696d16914781" guid="cfa7239a-60e4-483a-9d45-c364f2fb673d" id="24e6fd7c5b6fb3a96690246c8ac49304" version="0">
                                <l7:Name>#OTK Storage Configuration</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Target Configuration Policy: &amp;quot;OTK Storage Configuration&amp;quot;&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;=== Set custom values for Context Variables below ===&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;=== Add any new Context Variables or extensions below ===&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Storage Configuration</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fc9d0</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.411Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="71039e77-2081-40df-a892-50097f1c18de" id="e001cfd0c1c1ffaa18e187b5e72fc9d0" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fc858" guid="71039e77-2081-40df-a892-50097f1c18de" id="e001cfd0c1c1ffaa18e187b5e72fc9d0" version="0">
                                <l7:Name>OTK Storage Configuration</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Required changes can be implemented in policies in the 'Customizations' folder &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === The policies within that folder will have the same name as this policy but &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === either prefixed with '#' or suffixed with 'Extensions'&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Prefixed policies can be used to overwrite variables of this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Suffixed policies can be used to extend functionality&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you find you cannot add your customizations using the policies in the 'Customizations' folder&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy can be found and should be used as 'Encapsulated Assertion'!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;These endpoints should point to the appropriate servers.&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;If the URL points to 'localhost' or '127.0.0.1' a routing assertion is not involved.&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Token DB&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;This will usually be at localhost. Configure a hostname if /oauth/tokenstore is used on a remote gateway&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0Mw==&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;host_oauth_tokenstore_server&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Client DB&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;This will usually be at localhost. Configure a hostname if /oauth/clientstore is used on a remote gateway&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0Mw==&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;host_oauth_clientstore_server&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Session DB&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;This will usually be at localhost. Configure a hostname if /oauth/session is used on a remote gateway&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0Mw==&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;host_oauth_session_server&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;NOTE:  If the dbsystem is Cassandra separate_schemas should be set to true&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Databasesystem&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;'mysql', 'cassandra', or 'oracle'&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;bXlzcWw=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;dbsystem&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Set to true if you are using mysql/oracle and separate schemas for otk and mag&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;ZmFsc2U=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;separate_schemas&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Max number of allowed Tokens per resource_owner and client (app)&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Only positive integers accepted&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;MQ==&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;max_oauth_token_count&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Behaviour when max Token count has been reached&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Options for max_oauth_token_behaviour are: 'error' or 'cycle'&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;Y3ljbGU=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;max_oauth_token_behaviour&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:Include&gt;
            &lt;L7p:PolicyGuid stringValue=&quot;cfa7239a-60e4-483a-9d45-c364f2fb673d&quot;/&gt;
        &lt;/L7p:Include&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Storage Configuration</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fcac5</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.411Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="e001cfd0c1c1ffaa18e187b5e72fcac5" version="0">
                            <l7:Name>OTK Storage Configuration</l7:Name>
                            <l7:Guid>db047e91-52db-4176-a3eb-a43aa0c2c67c</l7:Guid>
                            <l7:PolicyReference id="e001cfd0c1c1ffaa18e187b5e72fc9d0" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>custom</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Custom input values</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>dbsystem</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>host_oauth_clientstore_server</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>host_oauth_session_server</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>host_oauth_tokenstore_server</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>max_oauth_token_behaviour</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>max_oauth_token_count</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>separate_schemas</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Exports variables that contain OTK configurations that are related to the persistence layer</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Configuration</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_require_customization">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_usage">
                                    <l7:StringValue>Internal</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>ServerRegistry.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="passMetricsToParent">
                                    <l7:StringValue>false</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>71039e77-2081-40df-a892-50097f1c18de</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>MAG_OAuth</l7:Name>
                    <l7:Id>cbeedf1e2650e80f4d660a7fdb8fea13</l7:Id>
                    <l7:Type>JDBC_CONNECTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.424Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:JDBCConnection id="cbeedf1e2650e80f4d660a7fdb8fea13" version="1">
                            <l7:Name>MAG_OAuth</l7:Name>
                            <l7:Enabled>true</l7:Enabled>
                            <l7:Properties>
                                <l7:Property key="maximumPoolSize">
                                    <l7:IntegerValue>15</l7:IntegerValue>
                                </l7:Property>
                                <l7:Property key="minimumPoolSize">
                                    <l7:IntegerValue>3</l7:IntegerValue>
                                </l7:Property>
                            </l7:Properties>
                            <l7:Extension>
                                <l7:DriverClass>com.mysql.jdbc.Driver</l7:DriverClass>
                                <l7:JdbcUrl>jdbc:mysql://mysqldb:3306/otk_db</l7:JdbcUrl>
                                <l7:ConnectionProperties>
                                    <l7:Property key="EnableCancelTimeout">
                                        <l7:StringValue>true</l7:StringValue>
                                    </l7:Property>
                                    <l7:Property key="user">
                                        <l7:StringValue>db_admin</l7:StringValue>
                                    </l7:Property>
                                </l7:ConnectionProperties>
                            </l7:Extension>
                        </l7:JDBCConnection>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>MSSO Device DB Lookup</l7:Name>
                    <l7:Id>cbeedf1e2650e80f4d660a7fdb8fefff</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.443Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="94589a7a-1726-4bae-8227-eeaa841e57c0" id="cbeedf1e2650e80f4d660a7fdb8fefff" version="0">
                            <l7:PolicyDetail folderId="cbeedf1e2650e80f4d660a7fdb8fef1f" guid="94589a7a-1726-4bae-8227-eeaa841e57c0" id="cbeedf1e2650e80f4d660a7fdb8fefff" version="0">
                                <l7:Name>MSSO Device DB Lookup</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy can be found and should be used as 'Encapsulated                     Assertion'!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxMN2o6amRiY1F1ZXJ5UmVzdWx0IHhtbG5zOkw3aj0iaHR0cDovL25zLmw3dGVjaC5jb20vMjAxMi8wOC9qZGJjLXF1ZXJ5LXJlc3VsdCIvPg==&quot;/&gt;
            &lt;L7p:ContentType stringValue=&quot;text/xml; charset=utf-8&quot;/&gt;
            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${magidentifier}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:JdbcQuery&gt;
                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;MAG_OAuth&quot;/&gt;
                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:QueryTimeout stringValue=&quot;1&quot;/&gt;
                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT magidentifier, certdn,
                    username, devicestatus, devicename, deviceid, created, updated, multiuser, csr_base64, signed_cert_base64, grace_expiration
                    FROM mag_msso_device
                    WHERE magidentifier = ${magidentifier}]]&gt;&lt;/L7p:SqlQuery&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                &lt;/L7p:JdbcQuery&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;magidentifier&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${deviceid}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${username}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${devicename}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:JdbcQuery&gt;
                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;MAG_OAuth&quot;/&gt;
                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:QueryTimeout stringValue=&quot;1&quot;/&gt;
                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT magidentifier, certdn,
                    username, devicestatus, devicename, deviceid, created, updated, multiuser, csr_base64, signed_cert_base64, grace_expiration
                    FROM mag_msso_device
                    WHERE username = ${username}
                    AND deviceid = ${deviceid}]]&gt;&lt;/L7p:SqlQuery&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                &lt;/L7p:JdbcQuery&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;deviceid, username&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${username}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${devicename}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${deviceid}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:JdbcQuery&gt;
                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;MAG_OAuth&quot;/&gt;
                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:QueryTimeout stringValue=&quot;1&quot;/&gt;
                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT magidentifier, certdn,
                    username, devicestatus, devicename, deviceid, created, updated, multiuser, csr_base64, signed_cert_base64, grace_expiration
                    FROM mag_msso_device
                    WHERE username = ${username}]]&gt;&lt;/L7p:SqlQuery&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                &lt;/L7p:JdbcQuery&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;username&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${devicestatus}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:JdbcQuery&gt;
                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;MAG_OAuth&quot;/&gt;
                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:QueryTimeout stringValue=&quot;1&quot;/&gt;
                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT magidentifier, certdn,
                    username, devicestatus, devicename, deviceid, created, updated, multiuser, csr_base64, signed_cert_base64, grace_expiration
                    FROM mag_msso_device
                    WHERE devicestatus = ${devicestatus}]]&gt;&lt;/L7p:SqlQuery&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                &lt;/L7p:JdbcQuery&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;devicestatus&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${certdn}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:JdbcQuery&gt;
                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;MAG_OAuth&quot;/&gt;
                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:QueryTimeout stringValue=&quot;1&quot;/&gt;
                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT magidentifier, certdn,
                    username, devicestatus, devicename, deviceid, created, updated, multiuser, csr_base64, signed_cert_base64, grace_expiration
                    FROM mag_msso_device
                    WHERE certdn = ${certdn}]]&gt;&lt;/L7p:SqlQuery&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                &lt;/L7p:JdbcQuery&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;certDN&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${deviceid}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${username}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${devicename}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:JdbcQuery&gt;
                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;MAG_OAuth&quot;/&gt;
                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:QueryTimeout stringValue=&quot;1&quot;/&gt;
                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT magidentifier, certdn,
                    username, devicestatus, devicename, deviceid, created, updated, multiuser, csr_base64, signed_cert_base64, grace_expiration
                    FROM mag_msso_device
                    WHERE username = ${username}
                    AND deviceid = ${deviceid}
                    AND devicename = ${devicename}]]&gt;&lt;/L7p:SqlQuery&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                &lt;/L7p:JdbcQuery&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;deviceid, username, devicename&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue=&quot;No query could be successfully executed to lookup a device&quot;/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAz&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;query&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS54bWxSZXN1bHR9&quot;/&gt;
                    &lt;L7p:ContentType stringValue=&quot;text/xml; charset=utf-8&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:XslTransformation&gt;
                    &lt;L7p:Direction intValue=&quot;-1&quot;/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;resp&quot;/&gt;
                    &lt;L7p:ResourceInfo staticResourceInfo=&quot;included&quot;&gt;
                        &lt;L7p:Document stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:L7j=&quot;http://ns.l7tech.com/2012/08/jdbc-query-result&quot; xmlns:L7j-cassandra=&quot;http://ns.l7tech.com/2012/08/cassandra-query-result&quot; xmlns:ns=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt;

                    &lt;xsl:output cdata-section-elements=&quot;ns:magidentifier ns:username ns:deviceid ns:devicename ns:devicestatus ns:certdn ns:created ns:updated ns:multiuser ns:csr_base64 ns:signed_cert_base64 ns:grace_expiration&quot; encoding=&quot;UTF-8&quot; indent=&quot;yes&quot; method=&quot;xml&quot;/&gt;

                    &lt;xsl:template match=&quot;L7j:jdbcQueryResult&quot;&gt;
                    &lt;xsl:element name=&quot;ns:values&quot;&gt;
                    &lt;xsl:for-each select=&quot;L7j:row&quot;&gt;
                    &lt;xsl:element name=&quot;ns:value&quot;&gt;
                    &lt;xsl:attribute name=&quot;index&quot;&gt;
                    &lt;xsl:value-of select=&quot;position()&quot;/&gt;
                    &lt;/xsl:attribute&gt;
                    &lt;xsl:for-each select=&quot;L7j:col&quot;&gt;
                    &lt;xsl:element name=&quot;ns:{@name}&quot;&gt;
                    &lt;xsl:value-of select=&quot;text()&quot;/&gt;
                    &lt;/xsl:element&gt;
                    &lt;/xsl:for-each&gt;
                    &lt;/xsl:element&gt;
                    &lt;/xsl:for-each&gt;
                    &lt;/xsl:element&gt;
                    &lt;/xsl:template&gt;

                    &lt;/xsl:stylesheet&gt;]]&gt;&lt;/L7p:Document&gt;
                    &lt;/L7p:ResourceInfo&gt;
                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                    &lt;L7p:TransformName stringValue=&quot;&quot;/&gt;
                    &lt;L7p:XsltVersion stringValue=&quot;1.0&quot;/&gt;
                &lt;/L7p:XslTransformation&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;dGV4dC94bWw7Y2hhcnNldD1VVEYtOA==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;success&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;prepare response&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>MSSO Device DB Lookup</l7:Name>
                    <l7:Id>cbeedf1e2650e80f4d660a7fdb8ff423</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.443Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="cbeedf1e2650e80f4d660a7fdb8ff423" version="0">
                            <l7:Name>MSSO Device DB Lookup</l7:Name>
                            <l7:Guid>9be106e5-3498-4c67-a028-eed252c02f7e</l7:Guid>
                            <l7:PolicyReference id="cbeedf1e2650e80f4d660a7fdb8fefff" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>certdn</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>username</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>magidentifier</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>deviceid</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>5</l7:Ordinal>
                                    <l7:ArgumentName>devicename</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>6</l7:Ordinal>
                                    <l7:ArgumentName>devicestatus</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>resp</l7:ResultName>
                                    <l7:ResultType>message</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Retrieves a list of registered devices based on different parameters.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Storage_Access</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_usage">
                                    <l7:StringValue>Internal</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>Save16.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>94589a7a-1726-4bae-8227-eeaa841e57c0</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>MSSO Device NoSQL Lookup</l7:Name>
                    <l7:Id>cbeedf1e2650e80f4d660a7fdb8ff320</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.467Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="e573cbb7-a5c9-4173-b1df-2de81137a333" id="cbeedf1e2650e80f4d660a7fdb8ff320" version="0">
                            <l7:PolicyDetail folderId="cbeedf1e2650e80f4d660a7fdb8fef1f" guid="e573cbb7-a5c9-4173-b1df-2de81137a333" id="cbeedf1e2650e80f4d660a7fdb8ff320" version="0">
                                <l7:Name>MSSO Device NoSQL Lookup</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy is looking up a device by different parameters&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;dGV4dC94bWw=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxMN2o6Y2Fzc2FuZHJhUXVlcnlSZXN1bHQgeG1sbnM6TDdqPSJodHRwOi8vbnMubDd0ZWNoLmNvbS8yMDEyLzA4L2Nhc3NhbmRyYS1xdWVyeS1yZXN1bHQiLz4=&quot;/&gt;
            &lt;L7p:ContentType stringValue=&quot;text/xml; charset=utf-8&quot;/&gt;
            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${magidentifier}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:CassandraQuery&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;MAG_OAuth_Cassandra&quot;/&gt;
                    &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                    &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT magidentifier, certdn,
                username, devicestatus, devicename, deviceid, created, updated, multiuser, csr_base64, signed_cert_base64, grace_expiration
                FROM mag_msso_device
                WHERE magidentifier = ${magidentifier}]]&gt;&lt;/L7p:QueryDocument&gt;
                    &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                &lt;/L7p:CassandraQuery&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;magidentifier&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${deviceid}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${username}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${devicename}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:CassandraQuery&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;MAG_OAuth_Cassandra&quot;/&gt;
                    &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                    &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT magidentifier, certdn,
                username, devicestatus, devicename, deviceid, created, updated, multiuser, csr_base64, signed_cert_base64, grace_expiration 
                FROM mag_msso_device_username_view
                WHERE username = ${username}
                AND deviceid = ${deviceid}]]&gt;&lt;/L7p:QueryDocument&gt;
                    &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                &lt;/L7p:CassandraQuery&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;deviceid, username&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${username}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${devicename}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${deviceid}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:CassandraQuery&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;MAG_OAuth_Cassandra&quot;/&gt;
                    &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                    &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT magidentifier, certdn, username, devicestatus, devicename, deviceid, created, updated, multiuser, csr_base64, signed_cert_base64, grace_expiration
                FROM mag_msso_device_username_view
                WHERE username = ${username}]]&gt;&lt;/L7p:QueryDocument&gt;
                    &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                &lt;/L7p:CassandraQuery&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;username&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${devicestatus}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:CassandraQuery&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;MAG_OAuth_Cassandra&quot;/&gt;
                    &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                    &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT magidentifier, certdn,
                username, devicestatus, devicename, deviceid, created, updated, multiuser, csr_base64, signed_cert_base64, grace_expiration
                FROM mag_msso_device
                WHERE devicestatus = ${devicestatus}]]&gt;&lt;/L7p:QueryDocument&gt;
                    &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                &lt;/L7p:CassandraQuery&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;devicestatus&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${certdn}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:CassandraQuery&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Magidentifier&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;MAG_OAuth_Cassandra&quot;/&gt;
                    &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:NamingMap mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;magidentifier&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;magidentifier&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:NamingMap&gt;
                    &lt;L7p:Prefix stringValue=&quot;queryIdentifier&quot;/&gt;
                    &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT magidentifier
                FROM mag_msso_device_certdn
                WHERE certdn = ${certdn}]]&gt;&lt;/L7p:QueryDocument&gt;
                    &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                &lt;/L7p:CassandraQuery&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeUlkZW50aWZpZXIubWFnaWRlbnRpZmllcn0=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;query_magidentifier&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${query_magidentifier}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;MA==&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;int&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;query.queryresult.count&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48TDdqOmNhc3NhbmRyYVF1ZXJ5UmVzdWx0IHhtbG5zOkw3aj0iaHR0cDovL25zLmw3dGVjaC5jb20vMjAxMi8wOC9jYXNzYW5kcmEtcXVlcnktcmVzdWx0Ij48L0w3ajpjYXNzYW5kcmFRdWVyeVJlc3VsdD4=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;query.xmlResult&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:CassandraQuery&gt;
                        &lt;L7p:ConnectionName stringValue=&quot;MAG_OAuth_Cassandra&quot;/&gt;
                        &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                        &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                        &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                        &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT magidentifier, certdn,username, devicestatus, devicename, deviceid, created, updated, multiuser, csr_base64, signed_cert_base64, grace_expiration
                FROM mag_msso_device
                WHERE magidentifier = ${query_magidentifier}]]&gt;&lt;/L7p:QueryDocument&gt;
                        &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                    &lt;/L7p:CassandraQuery&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// if no magidentifier found, return empty set instead of failing&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;certDN&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${deviceid}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${devicename}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${username}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:CassandraQuery&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;MAG_OAuth_Cassandra&quot;/&gt;
                    &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                    &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT magidentifier, certdn,
                username, devicestatus, devicename, deviceid, created, updated, multiuser, csr_base64, signed_cert_base64, grace_expiration
                FROM mag_msso_device_username_view
                WHERE username = ${username}
                AND deviceid = ${deviceid}
                AND devicename = ${devicename}]]&gt;&lt;/L7p:QueryDocument&gt;
                    &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                &lt;/L7p:CassandraQuery&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;deviceid, username, devicename&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue=&quot;No query could be successfully executed to lookup a device&quot;/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAz&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;query&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS54bWxSZXN1bHR9&quot;/&gt;
                    &lt;L7p:ContentType stringValue=&quot;text/xml; charset=utf-8&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:XslTransformation&gt;
                    &lt;L7p:Direction intValue=&quot;-1&quot;/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;resp&quot;/&gt;
                    &lt;L7p:ResourceInfo staticResourceInfo=&quot;included&quot;&gt;
                        &lt;L7p:Document stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:L7j-cassandra=&quot;http://ns.l7tech.com/2012/08/cassandra-query-result&quot; xmlns:ns=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt;
                &lt;xsl:output cdata-section-elements=&quot;ns:magidentifier ns:username ns:deviceid ns:devicename ns:devicestatus ns:certdn ns:created ns:updated ns:multiuser ns:csr_base64 ns:signed_cert_base64 ns:grace_expiration&quot; encoding=&quot;UTF-8&quot; indent=&quot;yes&quot; method=&quot;xml&quot;/&gt;
                &lt;xsl:template match=&quot;L7j-cassandra:cassandraQueryResult&quot;&gt;
                &lt;xsl:element name=&quot;ns:values&quot;&gt;
                &lt;xsl:for-each select=&quot;L7j-cassandra:row&quot;&gt;
                &lt;xsl:element name=&quot;ns:value&quot;&gt;
                &lt;xsl:attribute name=&quot;index&quot;&gt;
                &lt;xsl:value-of select=&quot;position()&quot;/&gt;
                &lt;/xsl:attribute&gt;
                &lt;xsl:for-each select=&quot;L7j-cassandra:col&quot;&gt;
                &lt;xsl:element name=&quot;ns:{@name}&quot;&gt;
                &lt;xsl:value-of select=&quot;text()&quot;/&gt;
                &lt;/xsl:element&gt;
                &lt;/xsl:for-each&gt;
                &lt;/xsl:element&gt;
                &lt;/xsl:for-each&gt;
                &lt;/xsl:element&gt;
                &lt;/xsl:template&gt;
                &lt;/xsl:stylesheet&gt;]]&gt;&lt;/L7p:Document&gt;
                    &lt;/L7p:ResourceInfo&gt;
                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                    &lt;L7p:TransformName stringValue=&quot;&quot;/&gt;
                    &lt;L7p:XsltVersion stringValue=&quot;1.0&quot;/&gt;
                &lt;/L7p:XslTransformation&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;dGV4dC94bWw7Y2hhcnNldD1VVEYtOA==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Success&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;prepare response&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>MSSO Device NoSQL Lookup</l7:Name>
                    <l7:Id>cbeedf1e2650e80f4d660a7fdb8ff609</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.468Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="cbeedf1e2650e80f4d660a7fdb8ff609" version="0">
                            <l7:Name>MSSO Device NoSQL Lookup</l7:Name>
                            <l7:Guid>37d29fe1-6e1c-4a8f-91af-ce2d7563a87e</l7:Guid>
                            <l7:PolicyReference id="cbeedf1e2650e80f4d660a7fdb8ff320" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>certdn</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>username</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>magidentifier</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>deviceid</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>5</l7:Ordinal>
                                    <l7:ArgumentName>devicename</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>6</l7:Ordinal>
                                    <l7:ArgumentName>devicestatus</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>7</l7:Ordinal>
                                    <l7:ArgumentName>dbsystem</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>resp</l7:ResultName>
                                    <l7:ResultType>message</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Retrieves a list of registered devices based on different parameters.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Storage_Access</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_usage">
                                    <l7:StringValue>Internal</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>Save16.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>e573cbb7-a5c9-4173-b1df-2de81137a333</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>MSSO Device Lookup</l7:Name>
                    <l7:Id>cbeedf1e2650e80f4d660a7fdb8fefd7</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.484Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="ccf34545-e485-4a91-b4a6-24f6f960f094" id="cbeedf1e2650e80f4d660a7fdb8fefd7" version="0">
                            <l7:PolicyDetail folderId="cbeedf1e2650e80f4d660a7fdb8fed5f" guid="ccf34545-e485-4a91-b4a6-24f6f960f094" id="cbeedf1e2650e80f4d660a7fdb8fefd7" version="0">
                                <l7:Name>MSSO Device Lookup</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy can be found and should be used as 'Encapsulated                     Assertion'!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:Encapsulated&gt;
            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;db047e91-52db-4176-a3eb-a43aa0c2c67c&quot;/&gt;
            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Storage Configuration&quot;/&gt;
            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;custom&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                &lt;/L7p:entry&gt;
            &lt;/L7p:Parameters&gt;
        &lt;/L7p:Encapsulated&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;error code&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;overwritten in case of an error&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;DB location&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Set the location to access the database&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;ZmFsc2U=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;isLocal&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${host_oauth_tokenstore_server}&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item regex=&quot;included&quot;&gt;
                            &lt;L7p:Pattern stringValue=&quot;http[s]?://(localhost|127[.]0[.]0[.]1).+&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;DB location&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Set the location to access the database&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;dHJ1ZQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;isLocal&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;cassandra&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;cassandra&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;9be106e5-3498-4c67-a028-eed252c02f7e&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;MSSO Device DB Lookup&quot;/&gt;
                        &lt;/L7p:Encapsulated&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;cassandra&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;cassandra&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;37d29fe1-6e1c-4a8f-91af-ce2d7563a87e&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;MSSO Device NoSQL Lookup&quot;/&gt;
                        &lt;/L7p:Encapsulated&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;local&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${isLocal}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;false&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;false&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;certdn&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;certdn&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;username&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;username&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;magidentifier&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;magidentifier&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;deviceid&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;deviceid&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;devicename&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;devicename&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;devicestatus&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;devicestatus&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                    &lt;L7p:ContentType stringValue=&quot;text/plain;charset=UTF-8&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;emptyMessage&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;no-fail&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;always success&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:CurrentSecurityHeaderHandling intValue=&quot;3&quot;/&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:HttpMethod httpMethod=&quot;GET&quot;/&gt;
                    &lt;L7p:PassThroughSoapFaults booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue=&quot;${host_oauth_tokenstore_server}/mag/storage/list?username=${username}&amp;amp;magidentifier=${magidentifier}&amp;amp;deviceid=${deviceid}&amp;amp;devicename=${devicename}&amp;amp;devicestatus=${devicestatus}&amp;amp;certdn=${certdn}&quot;/&gt;
                    &lt;L7p:ProxyPassword stringValueNull=&quot;null&quot;/&gt;
                    &lt;L7p:ProxyUsername stringValueNull=&quot;null&quot;/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                        &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;/&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue=&quot;emptyMessage&quot;/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                        &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                        &lt;L7p:ForwardAll booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;&gt;
                            &lt;L7p:item httpPassthroughRule=&quot;included&quot;&gt;
                                &lt;L7p:Name stringValue=&quot;Set-Cookie&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:ResponseMsgDest stringValue=&quot;resp&quot;/&gt;
                    &lt;L7p:SamlAssertionVersion intValue=&quot;2&quot;/&gt;
                &lt;/L7p:HttpRoutingAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${httpRouting.reasonCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;500&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;LT&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;LT&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;500&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:AuditDetailAssertion&gt;
                            &lt;L7p:Detail stringValue=&quot;routing failed!&quot;/&gt;
                        &lt;/L7p:AuditDetailAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error code&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;set error code to 000&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:FalseAssertion/&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;routing errors&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:Regex&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;capture&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;capture the last 3 digits&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;error.code&quot;/&gt;
                            &lt;L7p:Regex stringValue=&quot;(\d{0,16})(\d{3})$&quot;/&gt;
                            &lt;L7p:Replace booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Replacement stringValue=&quot;$2&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                        &lt;/L7p:Regex&gt;
                        &lt;L7p:FalseAssertion/&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;error code&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLmh0dHAuaGVhZGVyLmNvbnRlbnQtdHlwZX0=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;remote&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;database&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>MSSO Device Lookup</l7:Name>
                    <l7:Id>cbeedf1e2650e80f4d660a7fdb8ff3d5</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.484Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="cbeedf1e2650e80f4d660a7fdb8ff3d5" version="0">
                            <l7:Name>MSSO Device Lookup</l7:Name>
                            <l7:Guid>89f776fb-81bd-48d5-a519-54b57d02f43c</l7:Guid>
                            <l7:PolicyReference id="cbeedf1e2650e80f4d660a7fdb8fefd7" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>certdn</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Certificate Subject (DN)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>username</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Username</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>magidentifier</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Mag identifier</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>deviceid</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Device ID</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>5</l7:Ordinal>
                                    <l7:ArgumentName>devicename</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Device Name</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>6</l7:Ordinal>
                                    <l7:ArgumentName>devicestatus</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Device Status</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>resp</l7:ResultName>
                                    <l7:ResultType>message</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Retrieves a list of registered devices based on different parameters. Only the following combination are valid: (MAG Identifier), (Device ID, Device Name), (Device ID, Device Name, Username), (Username), (Device Status), (Certificate Subject (DN))</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Storage_Delegate</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_in_magidentifier">
                                    <l7:StringValue>This value needs to be base64 encoded</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_out_resp">
                                    <l7:StringValue>A XML message containing the data about the selected device registrations</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_usage">
                                    <l7:StringValue>Public</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>up-button.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>ccf34545-e485-4a91-b4a6-24f6f960f094</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>MSSO Require Registered Device - Mutual SSL</l7:Name>
                    <l7:Id>cbeedf1e2650e80f4d660a7fdb8ff104</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.507Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="06719a25-db05-4457-9370-71b43bdf0049" id="cbeedf1e2650e80f4d660a7fdb8ff104" version="0">
                            <l7:PolicyDetail folderId="cbeedf1e2650e80f4d660a7fdb8fee5f" guid="06719a25-db05-4457-9370-71b43bdf0049" id="cbeedf1e2650e80f4d660a7fdb8ff104" version="0">
                                <l7:Name>MSSO Require Registered Device - Mutual SSL</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy requires the client to present its public cert&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;The cert must be registered at the ssg&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:SslAssertion&gt;
                &lt;L7p:CheckCertValidity booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:RequireClientAuthentication booleanValue=&quot;true&quot;/&gt;
            &lt;/L7p:SslAssertion&gt;
            &lt;L7p:Encapsulated&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;204&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;// SSL with client authentication is required&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;204&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Parameters&gt;
            &lt;/L7p:Encapsulated&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;SSL&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;// require client certificate; validation is handled later in this policy&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:Authentication&gt;
            &lt;L7p:Enabled booleanValue=&quot;false&quot;/&gt;
            &lt;L7p:IdentityProviderOid goidValue=&quot;44a7a65d79dc7272d4675d318261cfc0&quot;/&gt;
        &lt;/L7p:Authentication&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Input value&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:Expression1 stringValue=&quot;${magidentifier}&quot;/&gt;
                &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;CONTAINS&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;,&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXF1ZXN0Lmh0dHAuaGVhZGVyLm1hZy1pZGVudGlmaWVyfQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;magidentifier&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${magidentifier}&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;CONTAINS&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;,&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Header value&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;// if magidentifier not passed in as input, check http header&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:Encapsulated&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;103&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;// magidentifier empty&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;103&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Parameters&gt;
            &lt;/L7p:Encapsulated&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Check magidentifier&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${lookupDevice}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;89f776fb-81bd-48d5-a519-54b57d02f43c&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;MSSO Device Lookup&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;certdn&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;deviceid&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;devicename&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;devicestatus&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;magidentifier&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${magidentifier}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;username&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CommentAssertion&gt;
                            &lt;L7p:Comment stringValue=&quot;Without the xpath check the policy would not fail even if no registered device would be found&quot;/&gt;
                        &lt;/L7p:CommentAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;xpathMagIdentifier&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:magidentifier[text()=$magidentifier]&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;xPathGraceExpiration&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:grace_expiration&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;xPathCsrBase64&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:csr_base64&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;xPathSignedCertBase64&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:signed_cert_base64&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHt4UGF0aEdyYWNlRXhwaXJhdGlvbi5yZXN1bHR9&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;int&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;grace_expiration&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:CommentAssertion&gt;
                            &lt;L7p:Comment stringValue=&quot;CSR is in PEM format; can't decode to X509 without conversion&quot;/&gt;
                        &lt;/L7p:CommentAssertion&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:CharacterEncoding stringValueNull=&quot;null&quot;/&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;xPathCsrBase64.result&quot;/&gt;
                            &lt;L7p:TargetContentType stringValue=&quot;application/octet-stream&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;message&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;csr&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;BASE64_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:CharacterEncoding stringValueNull=&quot;null&quot;/&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;xPathSignedCertBase64.result&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;cert&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;signed_cert&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;BASE64_DECODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Success&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:Encapsulated&gt;
                        &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;107&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;// invalid magidentifier&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                        &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                        &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;107&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Parameters&gt;
                    &lt;/L7p:Encapsulated&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Lookup device&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${request.ssl.clientCertificate.thumbprintSHA1}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;${signed_cert.thumbprintSHA1}&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;${signed_cert.thumbprintSHA1}&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Encapsulated&gt;
                        &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;205&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;// invalid cert&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                        &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                        &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;205&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Parameters&gt;
                    &lt;/L7p:Encapsulated&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// compare given certificate vs. db&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${request.ssl.clientCertificate.notAfter}&quot;/&gt;
                        &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item dataType=&quot;included&quot;&gt;
                                &lt;L7p:Type variableDataType=&quot;dateTime&quot;/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;${gateway.time}&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${allowGrace}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${grace_expiration}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;${gateway.time.seconds}&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;// checking validity within grace period&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:Encapsulated&gt;
                        &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;206&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;// expired cert&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                        &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                        &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;206&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Parameters&gt;
                    &lt;/L7p:Encapsulated&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;// validate cert expiry and/or grace periods&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Success&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:Expression1 stringValue=&quot;${lookupDevice}&quot;/&gt;
                &lt;L7p:Expression2 stringValue=&quot;false&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;false&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Lookup MSSO Device&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>MSSO Require Registered Device - Mutual SSL</l7:Name>
                    <l7:Id>a94971d96bb22d04d7aa77886bae39d8</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.507Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="a94971d96bb22d04d7aa77886bae39d8" version="0">
                            <l7:Name>MSSO Require Registered Device - Mutual SSL</l7:Name>
                            <l7:Guid>ce9faafc-7d76-4818-9c56-0bb9a4b68e9c</l7:Guid>
                            <l7:PolicyReference id="cbeedf1e2650e80f4d660a7fdb8ff104" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>lookupDevice</l7:ArgumentName>
                                    <l7:ArgumentType>boolean</l7:ArgumentType>
                                    <l7:GuiLabel>Lookup the device?</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>allowGrace</l7:ArgumentName>
                                    <l7:ArgumentType>boolean</l7:ArgumentType>
                                    <l7:GuiLabel>Allow expired cert up to grace period?</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>magidentifier</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>MAG Identifier</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>csr</l7:ResultName>
                                    <l7:ResultType>message</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>message</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.msg</l7:ResultName>
                                    <l7:ResultType>message</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>grace_expiration</l7:ResultName>
                                    <l7:ResultType>int</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>magidentifier</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>resp</l7:ResultName>
                                    <l7:ResultType>message</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>signed_cert</l7:ResultName>
                                    <l7:ResultType>cert</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>status</l7:ResultName>
                                    <l7:ResultType>message</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="artifactVersion">
                                    <l7:StringValue>3239d1a93dea9b6173f0c3a56ac1509ca0e0aec9</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Requires mutual SSL and optionally a registered device. Optionally it can be customized to validate the cetificate against a FIP even if the device registration does not exist.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Access_Control</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_require_customization">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_usage">
                                    <l7:StringValue>Public</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>cert16.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>06719a25-db05-4457-9370-71b43bdf0049</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>#OTK OVP Configuration</l7:Name>
                    <l7:Id>24e6fd7c5b6fb3a96690246c8ac492ec</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.507Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="a4448be1-9b0e-417f-b498-8a268cadf8a5" id="24e6fd7c5b6fb3a96690246c8ac492ec" version="0">
                            <l7:PolicyDetail folderId="161861da3a78c5dcdc62696d16914781" guid="a4448be1-9b0e-417f-b498-8a268cadf8a5" id="24e6fd7c5b6fb3a96690246c8ac492ec" version="0">
                                <l7:Name>#OTK OVP Configuration</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Target Configuration Policy: &amp;quot;OTK OVP Configuration&amp;quot;&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;=== Set custom values for Context Variables below ===&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;=== Add any new Context Variables or extensions below ===&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK OVP Configuration</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd82d</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.510Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="c6bf9e90-5ea0-4650-91f9-7c2a8291902f" id="e001cfd0c1c1ffaa18e187b5e72fd82d" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fc858" guid="c6bf9e90-5ea0-4650-91f9-7c2a8291902f" id="e001cfd0c1c1ffaa18e187b5e72fd82d" version="0">
                                <l7:Name>OTK OVP Configuration</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Required changes can be implemented in policies in the 'Customizations' folder &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === The policies within that folder will have the same name as this policy but &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === either prefixed with '#' or suffixed with 'Extensions'&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Prefixed policies can be used to overwrite variables of this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Suffixed policies can be used to extend functionality&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you find you cannot add your customizations using the policies in the 'Customizations' folder&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy can be found and should be used as 'Encapsulated Assertion'!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This endpoint should point to the server that holds all OAuth validation endpoints.&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Usually those endpoints are found within the folder 'SecureZone - OVP'.&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0Mw==&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;host_oauth_ovp_server&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:Include&gt;
            &lt;L7p:PolicyGuid stringValue=&quot;a4448be1-9b0e-417f-b498-8a268cadf8a5&quot;/&gt;
        &lt;/L7p:Include&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK OVP Configuration</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fda9a</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.510Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="e001cfd0c1c1ffaa18e187b5e72fda9a" version="0">
                            <l7:Name>OTK OVP Configuration</l7:Name>
                            <l7:Guid>7e2b4f64-e226-4a03-980a-c4603163acc0</l7:Guid>
                            <l7:PolicyReference id="e001cfd0c1c1ffaa18e187b5e72fd82d" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments/>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>host_oauth_ovp_server</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Exports the server location that implements the OVP (OAuth Validation Point) endpoints.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Storage_Access</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_usage">
                                    <l7:StringValue>Internal</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>ServerRegistry.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>c6bf9e90-5ea0-4650-91f9-7c2a8291902f</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Access Token Retrieval</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd86a</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.529Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="14f8a882-e66c-4a70-88d8-0128e2922744" id="e001cfd0c1c1ffaa18e187b5e72fd86a" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fcfce" guid="14f8a882-e66c-4a70-88d8-0128e2922744" id="e001cfd0c1c1ffaa18e187b5e72fd86a" version="0">
                                <l7:Name>OTK Access Token Retrieval</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy can be found and should be used as 'Encapsulated Assertion'!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;=== Allow the auth-header OR parameters but NOT both if both are used&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;auth_scheme&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;access_token&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${allow_header}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${auth_param_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${given_access_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:CaptureVar stringValue=&quot;schema_token&quot;/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;auth_header&quot;/&gt;
                    &lt;L7p:Regex stringValue=&quot;^\b([Bb][Ee][Aa][Rr][Ee][Rr]|MAC)\b\s(.{1,256})$&quot;/&gt;
                    &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                &lt;/L7p:Regex&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtzY2hlbWFfdG9rZW5bMV19&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;auth_scheme&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtzY2hlbWFfdG9rZW5bMl19&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;access_token&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${auth_scheme}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;MAC&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;MAC&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:Regex&gt;
                            &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:CaptureVar stringValue=&quot;id&quot;/&gt;
                            &lt;L7p:FindAll booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;access_token&quot;/&gt;
                            &lt;L7p:Regex stringValue=&quot;id\s*=&amp;quot;\s*([^&amp;quot;]*)&amp;quot;&quot;/&gt;
                            &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                        &lt;/L7p:Regex&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${id[1]}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtpZFsxXX0=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;access_token&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Get MAC access_token if MAC profile is used&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;LOCATE IN HEADER&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${allow_query}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${auth_header}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${auth_param_token}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${given_access_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;QmVhcmVy&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;auth_scheme&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHthdXRoX3BhcmFtX3Rva2VufQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;access_token&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;LOCATE AS PARAMETER&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${given_access_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${auth_header}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${auth_param_token}&quot;/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;QmVhcmVy&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;auth_scheme&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtnaXZlbl9hY2Nlc3NfdG9rZW59&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;access_token&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;USE GIVEN PARAMETER&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:TrueAssertion/&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;find&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${access_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${access_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot; &quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;CONTAINS&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;CONTAINS&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot; &quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;valid&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;OTky&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;validation&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;check that access_token is not empty and has no space ( ' ') character&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Access Token Retrieval</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fdaa0</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.529Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="e001cfd0c1c1ffaa18e187b5e72fdaa0" version="0">
                            <l7:Name>OTK Access Token Retrieval</l7:Name>
                            <l7:Guid>dc16f9da-c833-4b0a-8525-8a41ce420795</l7:Guid>
                            <l7:PolicyReference id="e001cfd0c1c1ffaa18e187b5e72fd86a" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>allow_header</l7:ArgumentName>
                                    <l7:ArgumentType>boolean</l7:ArgumentType>
                                    <l7:GuiLabel>Allow Authorization Header</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>allow_query</l7:ArgumentName>
                                    <l7:ArgumentType>boolean</l7:ArgumentType>
                                    <l7:GuiLabel>Allow Parameter</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>auth_header</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Authentication Header</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>auth_param_token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Parameter</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>5</l7:Ordinal>
                                    <l7:ArgumentName>given_access_token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Access Token (Bearer only)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>access_token</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>auth_header</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>auth_scheme</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Finds the OAuth 2.0 access_token within the http request header, as http request parameter or uses the given one. If will fail if a token is found at multiple locations.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>OAuth_Validation</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_usage">
                                    <l7:StringValue>Internal</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>oauth.png</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>14f8a882-e66c-4a70-88d8-0128e2922744</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OAuth</l7:Name>
                    <l7:Id>4432207d16a1b505e8a6ed59993eaa24</l7:Id>
                    <l7:Type>JDBC_CONNECTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.529Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:JDBCConnection id="4432207d16a1b505e8a6ed59993eaa24" version="1">
                            <l7:Name>OAuth</l7:Name>
                            <l7:Enabled>true</l7:Enabled>
                            <l7:Properties>
                                <l7:Property key="maximumPoolSize">
                                    <l7:IntegerValue>15</l7:IntegerValue>
                                </l7:Property>
                                <l7:Property key="minimumPoolSize">
                                    <l7:IntegerValue>3</l7:IntegerValue>
                                </l7:Property>
                            </l7:Properties>
                            <l7:Extension>
                                <l7:DriverClass>com.mysql.jdbc.Driver</l7:DriverClass>
                                <l7:JdbcUrl>jdbc:mysql://mysqldb:3306/otk_db</l7:JdbcUrl>
                                <l7:ConnectionProperties>
                                    <l7:Property key="EnableCancelTimeout">
                                        <l7:StringValue>true</l7:StringValue>
                                    </l7:Property>
                                    <l7:Property key="user">
                                        <l7:StringValue>db_admin</l7:StringValue>
                                    </l7:Property>
                                </l7:ConnectionProperties>
                            </l7:Extension>
                        </l7:JDBCConnection>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Token DB GET</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fcc49</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.591Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="85fc86ff-4cac-4086-afa1-3673d74fe895" id="e001cfd0c1c1ffaa18e187b5e72fcc49" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fcbcd" guid="85fc86ff-4cac-4086-afa1-3673d74fe895" id="e001cfd0c1c1ffaa18e187b5e72fcc49" version="0">
                                <l7:Name>OTK Token DB GET</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy can be found and should be used as 'Encapsulated Assertion'!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;PHZhbHVlcz4NCjwvdmFsdWVzPg==&quot;/&gt;
            &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;returnOffset&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${tokentype}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;token&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;token&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${queryOffset}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;0&quot;/&gt;
                            &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;MA==&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;int&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;offset&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${queryOffset}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;0&quot;/&gt;
                            &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;LT&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;LT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;MA==&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;int&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;offset&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeU9mZnNldH0=&quot;/&gt;
                        &lt;L7p:DataType variableDataType=&quot;int&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;offset&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;MA==&quot;/&gt;
                        &lt;L7p:DataType variableDataType=&quot;int&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;offset&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Offset&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Set the offset for the database query&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:CommentAssertion&gt;
                        &lt;L7p:Comment stringValue=&quot;=== Below: SQL-Queries that will always return a single row&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${token}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:JdbcQuery&gt;
                            &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                            &lt;L7p:ConvertVariablesToStrings booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT token,secret,expiration,rtoken,rexpiration,scope,resource_owner,client_name,client_ident,client_key,status,created,custom
                FROM oauth_token
                WHERE token = ${token}]]&gt;&lt;/L7p:SqlQuery&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                        &lt;/L7p:JdbcQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all access_token values of given token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${rtoken}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:JdbcQuery&gt;
                            &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                            &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT token, secret, expiration, rtoken, rexpiration, scope, resource_owner, client_name, client_ident, client_key, status, created,custom
                FROM oauth_token
                WHERE rtoken = ${rtoken}]]&gt;&lt;/L7p:SqlQuery&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                        &lt;/L7p:JdbcQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all access_token values of given rtoken&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:CommentAssertion&gt;
                        &lt;L7p:Comment stringValue=&quot;=== Below: SQL-Queries that will return up to a few rows&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${client_key}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resource_owner}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:JdbcQuery&gt;
                            &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                            &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT token, secret, expiration, rtoken, rexpiration, scope, resource_owner, client_name, client_ident, client_key, status, created,custom
                FROM oauth_token
                WHERE client_key = ${client_key}
                AND resource_owner = ${resource_owner}]]&gt;&lt;/L7p:SqlQuery&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                        &lt;/L7p:JdbcQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all access_token values of given client - resource_owner&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:CommentAssertion&gt;
                        &lt;L7p:Comment stringValue=&quot;=== As of here pagination is required ===&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                        &lt;L7p:Comment stringValue=&quot;=== Below: SQL-Queries that may return a few thousand rows&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resource_owner}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${token_status}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;mysql&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:JdbcQuery&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;MySQL&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                                    &lt;L7p:ConvertVariablesToStrings booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT  token, secret, expiration, rtoken, rexpiration, scope, resource_owner, client_name, client_ident, client_key, status, created,custom
                FROM oauth_token
                WHERE resource_owner like ${resource_owner}
                AND status = ${token_status}
                ORDER BY resource_owner, client_name, created ASC LIMIT 100 OFFSET ${offset}]]&gt;&lt;/L7p:SqlQuery&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                                &lt;/L7p:JdbcQuery&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;MySQL&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;oracle&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:JdbcQuery&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Oracle&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                                    &lt;L7p:ConvertVariablesToStrings booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT token, secret, expiration, rtoken, rexpiration, scope, resource_owner, client_name, client_ident, client_key, status, created,custom
                FROM (
                SELECT /*+ FIRST_ROWS(100) */ oauth_token.*, ROWNUM rnum
                FROM (  SELECT * FROM oauth_token
                WHERE resource_owner like ${resource_owner}
                AND status = ${token_status}
                ORDER BY resource_owner, client_name, created ASC ) oauth_token
                WHERE ROWNUM &lt;= (100+${offset}) )
                WHERE rnum  &gt; ${offset}]]&gt;&lt;/L7p:SqlQuery&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                                &lt;/L7p:JdbcQuery&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Oracle&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Check for database system&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all access_token values of given resource_owner and status&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resource_owner}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${client_key}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${token_status}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;mysql&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:JdbcQuery&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;MySQL&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                                    &lt;L7p:ConvertVariablesToStrings booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT  token, secret, expiration, rtoken, rexpiration, scope, resource_owner, client_name, client_ident, client_key, status, created,custom
                FROM oauth_token
                WHERE resource_owner like ${resource_owner}
                ORDER BY resource_owner, client_name, created ASC LIMIT 100 OFFSET ${offset}]]&gt;&lt;/L7p:SqlQuery&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                                &lt;/L7p:JdbcQuery&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;MySQL&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;oracle&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:JdbcQuery&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Oracle&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                                    &lt;L7p:ConvertVariablesToStrings booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT token, secret, expiration, rtoken, rexpiration, scope, resource_owner, client_name, client_ident, client_key, status, created,custom
                FROM (
                SELECT /*+ FIRST_ROWS(100) */ oauth_token.*, ROWNUM rnum
                FROM (  SELECT * FROM oauth_token
                WHERE resource_owner like ${resource_owner}
                ORDER BY resource_owner, client_name, created ASC ) oauth_token
                WHERE ROWNUM &lt;= (100+${offset}) )
                WHERE rnum  &gt; ${offset}]]&gt;&lt;/L7p:SqlQuery&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                                &lt;/L7p:JdbcQuery&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Oracle&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Check for database system&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all access_token of a given resource_owner&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${client_key}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resource_owner}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;mysql&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:JdbcQuery&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;MySQL&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                                    &lt;L7p:ConvertVariablesToStrings booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT  token, secret, expiration,rtoken, rexpiration, scope, resource_owner, client_name, client_ident, client_key, status, created,custom
                FROM oauth_token
                WHERE client_key = ${client_key}
                ORDER BY client_name, resource_owner, created ASC LIMIT 100 OFFSET ${offset}]]&gt;&lt;/L7p:SqlQuery&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                                &lt;/L7p:JdbcQuery&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;MySQL&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;oracle&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:JdbcQuery&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Oracle&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                                    &lt;L7p:ConvertVariablesToStrings booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT token, secret, expiration,rtoken, rexpiration, scope, resource_owner, client_name, client_ident, client_key, status, created,custom
                FROM (
                SELECT /*+ FIRST_ROWS(100) */ oauth_token.*, ROWNUM rnum
                FROM (  SELECT * FROM oauth_token
                WHERE client_key = ${client_key}
                ORDER BY client_name, resource_owner, created ASC ) oauth_token
                WHERE ROWNUM &lt;= (100+${offset}) )
                WHERE rnum  &gt; ${offset}]]&gt;&lt;/L7p:SqlQuery&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                                &lt;/L7p:JdbcQuery&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Oracle&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Check for database system&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all access_token values of given client&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${token_status}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resource_owner}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;mysql&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:JdbcQuery&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;MySQL&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                                    &lt;L7p:ConvertVariablesToStrings booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT  token, secret, expiration, rtoken, rexpiration, scope, resource_owner, client_name, client_ident, client_key, status, created,custom
                FROM oauth_token
                WHERE status = ${token_status}
                ORDER BY client_name, resource_owner, created ASC LIMIT 100 OFFSET ${offset}]]&gt;&lt;/L7p:SqlQuery&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                                &lt;/L7p:JdbcQuery&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;MySQL&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;oracle&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:JdbcQuery&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Oracle&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                                    &lt;L7p:ConvertVariablesToStrings booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT token, secret, expiration, rtoken, rexpiration, scope, resource_owner, client_name, client_ident, client_key, status, created,custom
                FROM (
                SELECT /*+ FIRST_ROWS(100) */ oauth_token.*, ROWNUM rnum
                FROM ( SELECT * FROM oauth_token
                WHERE status = ${token_status}
                ORDER BY client_name, resource_owner, created ASC ) oauth_token
                WHERE ROWNUM &lt;= (100+${offset}) )
                WHERE rnum  &gt; ${offset}]]&gt;&lt;/L7p:SqlQuery&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                                &lt;/L7p:JdbcQuery&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Oracle&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Check for database system&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:CommentAssertion&gt;
                        &lt;L7p:Comment stringValue=&quot;=== Below: SQL-Query that will return all rows&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${token}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${rtoken}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resource_owner}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${token_status}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${client_key}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;mysql&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:JdbcQuery&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;MySQL&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                                    &lt;L7p:ConvertVariablesToStrings booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:MaxRecords intValue=&quot;10000&quot;/&gt;
                                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT  token, secret, expiration, rtoken, rexpiration, scope, resource_owner, client_name, client_ident, client_key, status, created,custom
                FROM oauth_token
                ORDER BY client_name, resource_owner, created ASC LIMIT 100 OFFSET ${offset}]]&gt;&lt;/L7p:SqlQuery&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                                &lt;/L7p:JdbcQuery&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;MySQL&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;oracle&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:JdbcQuery&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Oracle&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                                    &lt;L7p:ConvertVariablesToStrings booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:MaxRecords intValue=&quot;10000&quot;/&gt;
                                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT token, secret, expiration, rtoken, rexpiration, scope, resource_owner, client_name, client_ident, client_key, status, created,custom
                FROM (
                SELECT /*+ FIRST_ROWS(100) */ oauth_token.*, ROWNUM rnum
                FROM (  SELECT * FROM oauth_token
                ORDER BY client_name, resource_owner, created ASC ) oauth_token
                WHERE ROWNUM &lt;= (100+${offset}) )
                WHERE rnum  &gt; ${offset}]]&gt;&lt;/L7p:SqlQuery&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                                &lt;/L7p:JdbcQuery&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Oracle&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Check for database system&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all access_token values &quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:FalseAssertion/&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;create the jdbc query&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS54bWxSZXN1bHR9&quot;/&gt;
                    &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;input&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;xpathRowCount&quot;/&gt;
                    &lt;L7p:XmlMsgSrc stringValue=&quot;input&quot;/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                        &lt;L7p:Expression stringValue=&quot;string(count(//L7j:row) +string($offset))&quot;/&gt;
                        &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;L7j&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/08/jdbc-query-result&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Namespaces&gt;
                        &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                    &lt;/L7p:XpathExpression&gt;
                &lt;/L7p:ResponseXpathAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHt4cGF0aFJvd0NvdW50LnJlc3VsdH0=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;returnOffset&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${query.queryresult.count}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;0&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;PHZhbHVlcz4NCiAgICA8dG9rZW5zPjx0b2tlbj48IVtDREFUQVske3F1ZXJ5LnRva2VufF1dPjwvdG9rZW4+PHRva2VuPjwhW0NEQVRBW31dXT48L3Rva2VuPjwvdG9rZW5zPg0KICAgIDxzZWNyZXRzPjxzZWNyZXQ+PCFbQ0RBVEFbJHtxdWVyeS5zZWNyZXR8XV0+PC9zZWNyZXQ+PHNlY3JldD48IVtDREFUQVt9XV0+PC9zZWNyZXQ+PC9zZWNyZXRzPg0KICAgIDxleHBpcmF0aW9ucz48ZXhwaXJhdGlvbj48IVtDREFUQVske3F1ZXJ5LmV4cGlyYXRpb258XV0+PC9leHBpcmF0aW9uPjxleHBpcmF0aW9uPjwhW0NEQVRBW31dXT48L2V4cGlyYXRpb24+PC9leHBpcmF0aW9ucz4NCiAgICA8cnRva2Vucz48cnRva2VuPjwhW0NEQVRBWyR7cXVlcnkucnRva2VufF1dPjwvcnRva2VuPjxydG9rZW4+PCFbQ0RBVEFbfV1dPjwvcnRva2VuPjwvcnRva2Vucz4NCiAgICA8cmV4cGlyYXRpb25zPjxyZXhwaXJhdGlvbj48IVtDREFUQVske3F1ZXJ5LnJleHBpcmF0aW9ufF1dPjwvcmV4cGlyYXRpb24+PHJleHBpcmF0aW9uPjwhW0NEQVRBW31dXT48L3JleHBpcmF0aW9uPjwvcmV4cGlyYXRpb25zPg0KICAgIDxzY29wZXM+PHNjb3BlPjwhW0NEQVRBWyR7cXVlcnkuc2NvcGV8XV0+PC9zY29wZT48c2NvcGU+PCFbQ0RBVEFbfV1dPjwvc2NvcGU+PC9zY29wZXM+DQogICAgPHJlc291cmNlX293bmVycz48cmVzb3VyY2Vfb3duZXI+PCFbQ0RBVEFbJHtxdWVyeS5yZXNvdXJjZV9vd25lcnxdXT48L3Jlc291cmNlX293bmVyPjxyZXNvdXJjZV9vd25lcj48IVtDREFUQVt9XV0+PC9yZXNvdXJjZV9vd25lcj48L3Jlc291cmNlX293bmVycz4NCiAgICA8Y2xpZW50cz48Y2xpZW50X2tleT48IVtDREFUQVske3F1ZXJ5LmNsaWVudF9rZXl8XV0+PC9jbGllbnRfa2V5PjxjbGllbnRfa2V5PjwhW0NEQVRBW31dXT48L2NsaWVudF9rZXk+PC9jbGllbnRzPg0KICAgIDxjbGllbnROYW1lcz48Y2xpZW50X25hbWU+PCFbQ0RBVEFbJHtxdWVyeS5jbGllbnRfbmFtZXxdXT48L2NsaWVudF9uYW1lPjxjbGllbnRfbmFtZT48IVtDREFUQVt9XV0+PC9jbGllbnRfbmFtZT48L2NsaWVudE5hbWVzPg0KICAgIDxzdGF0dXVzPjxzdGF0dXM+PCFbQ0RBVEFbJHtxdWVyeS5zdGF0dXN8XV0+PC9zdGF0dXM+PHN0YXR1cz48IVtDREFUQVt9XV0+PC9zdGF0dXM+PC9zdGF0dXVzPg0KICAgIDxjcmVhdGVkcz48Y3JlYXRlZD48IVtDREFUQVske3F1ZXJ5LmNyZWF0ZWR8XV0+PC9jcmVhdGVkPjxjcmVhdGVkPjwhW0NEQVRBW31dXT48L2NyZWF0ZWQ+PC9jcmVhdGVkcz4NCiAgICA8Y3VzdG9tcz48Y3VzdG9tPjwhW0NEQVRBWyR7cXVlcnkuY3VzdG9tfF1dPjwvY3VzdG9tPjxjdXN0b20+PCFbQ0RBVEFbfV1dPjwvY3VzdG9tPjwvY3VzdG9tcz4NCjwvdmFsdWVzPg==&quot;/&gt;
                            &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;transform jdbc result to xml&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Handle 'get'&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${tokentype}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;temporary&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;temporary&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${token}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${verifier}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:JdbcQuery&gt;
                            &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT token, secret, expiration, scope, resource_owner, client_name, client_key, created, verifier, callback,custom
                FROM oauth_initiate
                WHERE token = ${token}]]&gt;&lt;/L7p:SqlQuery&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                        &lt;/L7p:JdbcQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all temporary token values of given token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${token}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${verifier}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:JdbcQuery&gt;
                            &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT token, secret, expiration,scope, resource_owner, client_name, client_key, created, verifier, callback,custom
                FROM oauth_initiate
                WHERE token = ${token}
                AND verifier = ${verifier}]]&gt;&lt;/L7p:SqlQuery&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                        &lt;/L7p:JdbcQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all temporary token values of given token and verifier&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${client_key}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resource_owner}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:JdbcQuery&gt;
                            &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;10000&quot;/&gt;
                            &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT token, secret, expiration,scope, resource_owner, client_name, client_key, created, verifier, callback,custom
                FROM oauth_initiate
                WHERE client_key = ${client_key}
                AND resource_owner = ${resource_owner}]]&gt;&lt;/L7p:SqlQuery&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                        &lt;/L7p:JdbcQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all temporary token values of given client, resource_owner&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resource_owner}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${client_key}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:JdbcQuery&gt;
                            &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;10000&quot;/&gt;
                            &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT token, secret, expiration, scope, resource_owner, client_name, client_key, created, verifier, callback,custom
                FROM oauth_initiate
                WHERE resource_owner = ${resource_owner}]]&gt;&lt;/L7p:SqlQuery&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                        &lt;/L7p:JdbcQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all temporary token values of given resource_owner&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${client_key}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resource_owner}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:JdbcQuery&gt;
                            &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;10000&quot;/&gt;
                            &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT token, secret, expiration,scope, resource_owner, client_name, client_key, created, verifier, callback,custom
                FROM oauth_initiate
                WHERE client_key = ${client_key}]]&gt;&lt;/L7p:SqlQuery&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                        &lt;/L7p:JdbcQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all temporary token values of given client&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:FalseAssertion/&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;create the jdbc query&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${query.queryresult.count}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;0&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;PHZhbHVlcz4NCiAgICA8dG9rZW5zPjx0b2tlbj48IVtDREFUQVske3F1ZXJ5LnRva2VufF1dPjwvdG9rZW4+PHRva2VuPjwhW0NEQVRBW31dXT48L3Rva2VuPjwvdG9rZW5zPg0KICAgIDxzZWNyZXRzPjxzZWNyZXQ+PCFbQ0RBVEFbJHtxdWVyeS5zZWNyZXR8XV0+PC9zZWNyZXQ+PHNlY3JldD48IVtDREFUQVt9XV0+PC9zZWNyZXQ+PC9zZWNyZXRzPg0KICAgIDxleHBpcmF0aW9ucz48ZXhwaXJhdGlvbj48IVtDREFUQVske3F1ZXJ5LmV4cGlyYXRpb258XV0+PC9leHBpcmF0aW9uPjxleHBpcmF0aW9uPjwhW0NEQVRBW31dXT48L2V4cGlyYXRpb24+PC9leHBpcmF0aW9ucz4NCiAgICA8c2NvcGVzPjxzY29wZT48IVtDREFUQVske3F1ZXJ5LnNjb3BlfF1dPjwvc2NvcGU+PHNjb3BlPjwhW0NEQVRBW31dXT48L3Njb3BlPjwvc2NvcGVzPg0KICAgIDxyZXNvdXJjZV9vd25lcnM+PHJlc291cmNlX293bmVyPjwhW0NEQVRBWyR7cXVlcnkucmVzb3VyY2Vfb3duZXJ8XV0+PC9yZXNvdXJjZV9vd25lcj48cmVzb3VyY2Vfb3duZXI+PCFbQ0RBVEFbfV1dPjwvcmVzb3VyY2Vfb3duZXI+PC9yZXNvdXJjZV9vd25lcnM+DQogICAgPGNsaWVudHM+PGNsaWVudF9rZXk+PCFbQ0RBVEFbJHtxdWVyeS5jbGllbnRfa2V5fF1dPjwvY2xpZW50X2tleT48Y2xpZW50X2tleT48IVtDREFUQVt9XV0+PC9jbGllbnRfa2V5PjwvY2xpZW50cz4NCiAgICA8Y2xpZW50TmFtZXM+PGNsaWVudF9uYW1lPjwhW0NEQVRBWyR7cXVlcnkuY2xpZW50X25hbWV8XV0+PC9jbGllbnRfbmFtZT48Y2xpZW50X25hbWU+PCFbQ0RBVEFbfV1dPjwvY2xpZW50X25hbWU+PC9jbGllbnROYW1lcz4NCiAgICA8Y3JlYXRlZHM+PGNyZWF0ZWQ+PCFbQ0RBVEFbJHtxdWVyeS5jcmVhdGVkfF1dPjwvY3JlYXRlZD48Y3JlYXRlZD48IVtDREFUQVt9XV0+PC9jcmVhdGVkPjwvY3JlYXRlZHM+DQogICAgPGNhbGxiYWNrcz48Y2FsbGJhY2s+PCFbQ0RBVEFbJHtxdWVyeS5jYWxsYmFja3xdXT48L2NhbGxiYWNrPjxjYWxsYmFjaz48IVtDREFUQVt9XV0+PC9jYWxsYmFjaz48L2NhbGxiYWNrcz4NCiAgICA8dmVyaWZpZXJzPjx2ZXJpZmllcj48IVtDREFUQVske3F1ZXJ5LnZlcmlmaWVyfF1dPjwvdmVyaWZpZXI+PHZlcmlmaWVyPjwhW0NEQVRBW31dXT48L3ZlcmlmaWVyPjwvdmVyaWZpZXJzPg0KICAgIDxjdXN0b21zPjxjdXN0b20+PCFbQ0RBVEFbJHtxdWVyeS5jdXN0b218XV0+PC9jdXN0b20+PGN1c3RvbT48IVtDREFUQVt9XV0+PC9jdXN0b20+PC9jdXN0b21zPg0KPC92YWx1ZXM+&quot;/&gt;
                            &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;transform jdbc result to xml&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Handle 'getTemp'&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:XslTransformation&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Generate xml with one root and one field for each token&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Direction intValue=&quot;-1&quot;/&gt;
            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;resp&quot;/&gt;
            &lt;L7p:ResourceInfo staticResourceInfo=&quot;included&quot;&gt;
                &lt;L7p:Document stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[&lt;xsl:stylesheet version=&quot;1.0&quot;
                xmlns:xls=&quot;http://www.w3.org/1999/XSL/Transform&quot;
                xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt;
                &lt;xsl:output encoding=&quot;UTF-8&quot; indent=&quot;yes&quot; method=&quot;xml&quot;/&gt;
                &lt;xsl:param name=&quot;returnOffset&quot;/&gt;
                &lt;xsl:template match=&quot;/values&quot;&gt;
                &lt;xsl:element name=&quot;{name()}&quot;
                xmlns=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;&gt;
                &lt;xsl:attribute name=&quot;offset&quot;&gt;&lt;xsl:value-of select=&quot;$returnOffset&quot;/&gt;&lt;/xsl:attribute&gt;
                &lt;xsl:for-each select=&quot;descendant::node()[node()][1]/child::node()[node()]&quot;&gt;
                &lt;xsl:variable name=&quot;index&quot;&gt;
                &lt;xsl:value-of select=&quot;position()&quot;/&gt;
                &lt;/xsl:variable&gt;
                &lt;value index=&quot;{$index}&quot;
                xmlns=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;&gt;
                &lt;xsl:element name=&quot;{name()}&quot;
                xmlns=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;&gt;
                &lt;xsl:value-of select=&quot;text()&quot;/&gt;
                &lt;/xsl:element&gt;
                &lt;xsl:for-each select=&quot;parent::node()/following-sibling::node()[node()]&quot;&gt;
                &lt;xsl:for-each select=&quot;*[position()=$index]&quot;&gt;
                &lt;xsl:copy-of select=&quot;self::node()&quot;/&gt;
                &lt;/xsl:for-each&gt;
                &lt;/xsl:for-each&gt;
                &lt;/value&gt;
                &lt;/xsl:for-each&gt;
                &lt;/xsl:element&gt;
                &lt;/xsl:template&gt;
                &lt;/xsl:stylesheet&gt;]]&gt;&lt;/L7p:Document&gt;
            &lt;/L7p:ResourceInfo&gt;
            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
            &lt;L7p:TransformName stringValue=&quot;&quot;/&gt;
            &lt;L7p:XsltVersion stringValue=&quot;1.0&quot;/&gt;
        &lt;/L7p:XslTransformation&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${format}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;json&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;json&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:JsonTransformation&gt;
                    &lt;L7p:DestinationMessageTarget MessageTarget=&quot;included&quot;&gt;
                        &lt;L7p:OtherTargetMessageVariable stringValue=&quot;resp&quot;/&gt;
                        &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                        &lt;L7p:TargetModifiedByGateway booleanValue=&quot;true&quot;/&gt;
                    &lt;/L7p:DestinationMessageTarget&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;resp&quot;/&gt;
                    &lt;L7p:PrettyPrint booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:RootTagString stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                &lt;/L7p:JsonTransformation&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLm1haW5wYXJ0fQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;resp.mainpart&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;resp.mainpart&quot;/&gt;
                    &lt;L7p:Regex stringValue=&quot;&amp;quot;xmlns&amp;quot;:[\s]?&amp;quot;http://ns.l7tech.com/2012/11/otk-tokenstore&amp;quot;,\n&quot;/&gt;
                    &lt;L7p:RegexName stringValue=&quot;Remove Namespace&quot;/&gt;
                    &lt;L7p:Replace booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                &lt;/L7p:Regex&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLm1haW5wYXJ0fQ==&quot;/&gt;
                    &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;dGV4dC94bWw7Y2hhcnNldD1VVEYtOA==&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;transform to json if applicable&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Token DB GET</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fce1e</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.591Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="e001cfd0c1c1ffaa18e187b5e72fce1e" version="0">
                            <l7:Name>OTK Token DB GET</l7:Name>
                            <l7:Guid>af628087-2a37-45d7-b7c6-681c3d9e1526</l7:Guid>
                            <l7:PolicyReference id="e001cfd0c1c1ffaa18e187b5e72fcc49" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>rtoken</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>resource_owner</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>client_key</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>5</l7:Ordinal>
                                    <l7:ArgumentName>token_status</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>6</l7:Ordinal>
                                    <l7:ArgumentName>verifier</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>7</l7:Ordinal>
                                    <l7:ArgumentName>tokentype</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>8</l7:Ordinal>
                                    <l7:ArgumentName>format</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>9</l7:Ordinal>
                                    <l7:ArgumentName>queryOffset</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>10</l7:Ordinal>
                                    <l7:ArgumentName>dbsystem</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>resp</l7:ResultName>
                                    <l7:ResultType>message</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Returns values from the token database. 'tokentype' can either be 'token' or 'temporary'.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Storage_Access</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_usage">
                                    <l7:StringValue>Internal</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>Save16.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>85fc86ff-4cac-4086-afa1-3673d74fe895</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Token NoSQL GET</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fcd11</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.642Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="44f2b8a4-71b6-41ae-ace9-f0e612de6c31" id="e001cfd0c1c1ffaa18e187b5e72fcd11" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fcbcd" guid="44f2b8a4-71b6-41ae-ace9-f0e612de6c31" id="e001cfd0c1c1ffaa18e187b5e72fcd11" version="0">
                                <l7:Name>OTK Token NoSQL GET</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy can be found and should be used as 'Encapsulated Assertion'!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;PHZhbHVlcz4NCjwvdmFsdWVzPg==&quot;/&gt;
            &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;returnOffset&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${tokentype}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;token&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;token&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${queryOffset}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;FAIL&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;offset&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeU9mZnNldH0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;offset&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Offset&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Set the offset for the database query&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:CommentAssertion&gt;
                        &lt;L7p:Comment stringValue=&quot;=== Below: SQL-Queries that will always return a single row&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${token}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:NamingMap mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;oexpiration&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rexpiration&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otoken&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rtoken&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:NamingMap&gt;
                            &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT otk_token, secret,expiration,otoken,oexpiration,scope,resource_owner,client_name,client_ident,client_key,status,created,custom
                FROM oauth_access_token
                WHERE otk_token = ${token}]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all access_token values of given token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${rtoken}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:NamingMap mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;oexpiration&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rexpiration&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rtoken&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otoken&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:NamingMap&gt;
                            &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT otk_token, secret,expiration,otoken,oexpiration,scope,resource_owner,client_name,client_key,status,created,custom
                FROM oauth_refresh_token
                WHERE otk_token = ${rtoken}]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all access_token values of given rtoken&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:CommentAssertion&gt;
                        &lt;L7p:Comment stringValue=&quot;=== Below: SQL-Queries that will return up to a few rows&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${client_key}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resource_owner}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:NamingMap mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;oexpiration&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rexpiration&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otoken&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rtoken&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:NamingMap&gt;
                            &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                            &lt;L7p:QueryDocument stringValue=&quot;SELECT otk_token, secret,expiration,otoken,oexpiration,scope,resource_owner,client_name,client_key,status,created,custom FROM oauth_access_token_pagination where client_key = ${client_key} AND resource_owner = ${resource_owner} allow filtering&quot;/&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all access_token values of given client - resource_owner&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:CommentAssertion&gt;
                        &lt;L7p:Comment stringValue=&quot;=== As of here pagination is required ===&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                        &lt;L7p:Comment stringValue=&quot;=== Below: SQL-Queries that may return a few thousand rows&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resource_owner}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${token_status}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:NamingMap mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;oexpiration&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rexpiration&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otoken&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rtoken&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:NamingMap&gt;
                            &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                            &lt;L7p:QueryDocument stringValue=&quot;SELECT otk_token, client_name_otk_token, secret,expiration,otoken,oexpiration,scope,resource_owner,client_name,client_key,status,created,custom FROM oauth_access_token_pagination where resource_owner = ${resource_owner} AND status = ${token_status}  and token(client_name_otk_token) &gt; token(${offset}) LIMIT 100&quot;/&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${query.queryresult.count}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS54bWxSZXN1bHR9&quot;/&gt;
                                    &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;input&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:ResponseXpathAssertion&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;xpathClientName&quot;/&gt;
                                    &lt;L7p:XmlMsgSrc stringValue=&quot;input&quot;/&gt;
                                    &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                    &lt;L7p:Expression stringValue=&quot;/L7j:cassandraQueryResult/L7j:row[last()]/L7j:col[@name='client_name_otk_token']&quot;/&gt;
                                    &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;L7j&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/08/cassandra-query-result&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Namespaces&gt;
                                    &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                                    &lt;/L7p:XpathExpression&gt;
                                &lt;/L7p:ResponseXpathAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHt4cGF0aENsaWVudE5hbWUucmVzdWx0fQ==&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;returnOffset&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue=&quot;JHtvZmZzZXR9&quot;/&gt;
                                &lt;L7p:VariableToSet stringValue=&quot;returnOffset&quot;/&gt;
                            &lt;/L7p:SetVariable&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;returnOffset&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all access_token values of given resource_owner and status&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resource_owner}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:NamingMap mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;oexpiration&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rexpiration&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otoken&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rtoken&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:NamingMap&gt;
                            &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                            &lt;L7p:QueryDocument stringValue=&quot;SELECT otk_token, client_name_otk_token, secret,expiration,otoken,oexpiration,scope,resource_owner,client_name,client_key,status,created,custom FROM oauth_access_token_pagination WHERE resource_owner = ${resource_owner}  and token(client_name_otk_token) &gt; token(${offset}) Limit 100 allow filtering&quot;/&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${query.queryresult.count}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS54bWxSZXN1bHR9&quot;/&gt;
                                    &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;input&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:ResponseXpathAssertion&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;xpathClientName&quot;/&gt;
                                    &lt;L7p:XmlMsgSrc stringValue=&quot;input&quot;/&gt;
                                    &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                    &lt;L7p:Expression stringValue=&quot;/L7j:cassandraQueryResult/L7j:row[last()]/L7j:col[@name='client_name_otk_token']&quot;/&gt;
                                    &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;L7j&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/08/cassandra-query-result&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Namespaces&gt;
                                    &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                                    &lt;/L7p:XpathExpression&gt;
                                &lt;/L7p:ResponseXpathAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHt4cGF0aENsaWVudE5hbWUucmVzdWx0fQ==&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;returnOffset&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue=&quot;JHtvZmZzZXR9&quot;/&gt;
                                &lt;L7p:VariableToSet stringValue=&quot;returnOffset&quot;/&gt;
                            &lt;/L7p:SetVariable&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;returnOffset&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all access_token values of given resource_owner&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${client_key}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:NamingMap mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;oexpiration&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rexpiration&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otoken&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rtoken&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:NamingMap&gt;
                            &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                            &lt;L7p:QueryDocument stringValue=&quot;SELECT otk_token, client_name_otk_token, secret,expiration,otoken,oexpiration,scope,resource_owner,client_name,client_key,status,created,custom FROM oauth_access_token_pagination where client_key = ${client_key} and token(client_name_otk_token) &gt; token(${offset})&quot;/&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${query.queryresult.count}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS54bWxSZXN1bHR9&quot;/&gt;
                                    &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;input&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:ResponseXpathAssertion&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;xpathClientNameOTKToken&quot;/&gt;
                                    &lt;L7p:XmlMsgSrc stringValue=&quot;input&quot;/&gt;
                                    &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                    &lt;L7p:Expression stringValue=&quot;/L7j:cassandraQueryResult/L7j:row[last()]/L7j:col[@name='client_name_otk_token']&quot;/&gt;
                                    &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;L7j&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/08/cassandra-query-result&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Namespaces&gt;
                                    &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                                    &lt;/L7p:XpathExpression&gt;
                                &lt;/L7p:ResponseXpathAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHt4cGF0aENsaWVudE5hbWVPVEtUb2tlbi5yZXN1bHR9&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;returnOffset&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue=&quot;JHtvZmZzZXR9&quot;/&gt;
                                &lt;L7p:VariableToSet stringValue=&quot;returnOffset&quot;/&gt;
                            &lt;/L7p:SetVariable&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;returnOffset&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all access_token values of given client&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${token_status}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:NamingMap mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;oexpiration&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rexpiration&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otoken&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rtoken&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:NamingMap&gt;
                            &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                            &lt;L7p:QueryDocument stringValue=&quot;SELECT  otk_token, client_name_otk_token, secret, expiration, otoken, oexpiration, scope, resource_owner, client_name, client_ident, client_key, status, created,custom FROM oauth_access_token_pagination where status = ${token_status} and token(client_name_otk_token) &gt; token(${offset}) LIMIT 100&quot;/&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${query.queryresult.count}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS54bWxSZXN1bHR9&quot;/&gt;
                                    &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;input&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:ResponseXpathAssertion&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;xpathClientNameOTKToken&quot;/&gt;
                                    &lt;L7p:XmlMsgSrc stringValue=&quot;input&quot;/&gt;
                                    &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                    &lt;L7p:Expression stringValue=&quot;/L7j:cassandraQueryResult/L7j:row[last()]/L7j:col[@name='client_name_otk_token']&quot;/&gt;
                                    &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;L7j&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/08/cassandra-query-result&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Namespaces&gt;
                                    &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                                    &lt;/L7p:XpathExpression&gt;
                                &lt;/L7p:ResponseXpathAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHt4cGF0aENsaWVudE5hbWVPVEtUb2tlbi5yZXN1bHR9&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;returnOffset&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue=&quot;JHtvZmZzZXR9&quot;/&gt;
                                &lt;L7p:VariableToSet stringValue=&quot;returnOffset&quot;/&gt;
                            &lt;/L7p:SetVariable&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;returnOffset&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Many&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all access_token values of given status&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:CommentAssertion&gt;
                        &lt;L7p:Comment stringValue=&quot;=== Below: SQL-Query that will return all rows&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:GenerateXmlResult booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:NamingMap mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;oexpiration&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rexpiration&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otoken&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;rtoken&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:NamingMap&gt;
                            &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                            &lt;L7p:QueryDocument stringValue=&quot;SELECT  otk_token, client_name_otk_token, secret, expiration, otoken, oexpiration, scope, resource_owner, client_name, client_key, status, created,custom FROM oauth_access_token_pagination WHERE token(client_name_otk_token) &gt; token(${offset}) LIMIT 100&quot;/&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${query.queryresult.count}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS54bWxSZXN1bHR9&quot;/&gt;
                                    &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;input&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:ResponseXpathAssertion&gt;
                                    &lt;L7p:VariablePrefix stringValue=&quot;xpathClientNameOTKToken&quot;/&gt;
                                    &lt;L7p:XmlMsgSrc stringValue=&quot;input&quot;/&gt;
                                    &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                    &lt;L7p:Expression stringValue=&quot;/L7j:cassandraQueryResult/L7j:row[last()]/L7j:col[@name='client_name_otk_token']&quot;/&gt;
                                    &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;L7j&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/08/cassandra-query-result&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Namespaces&gt;
                                    &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                                    &lt;/L7p:XpathExpression&gt;
                                &lt;/L7p:ResponseXpathAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHt4cGF0aENsaWVudE5hbWVPVEtUb2tlbi5yZXN1bHR9&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;returnOffset&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue=&quot;JHtvZmZzZXR9&quot;/&gt;
                                &lt;L7p:VariableToSet stringValue=&quot;returnOffset&quot;/&gt;
                            &lt;/L7p:SetVariable&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;returnOffset&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all access_token values &quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:FalseAssertion/&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;create the jdbc query&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${query.queryresult.count}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;0&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;PHZhbHVlcz4NCiAgICA8dG9rZW5zPjx0b2tlbj48IVtDREFUQVske3F1ZXJ5LnRva2VufF1dPjwvdG9rZW4+PHRva2VuPjwhW0NEQVRBW31dXT48L3Rva2VuPjwvdG9rZW5zPg0KICAgIDxzZWNyZXRzPjxzZWNyZXQ+PCFbQ0RBVEFbJHtxdWVyeS5zZWNyZXR8XV0+PC9zZWNyZXQ+PHNlY3JldD48IVtDREFUQVt9XV0+PC9zZWNyZXQ+PC9zZWNyZXRzPg0KICAgIDxleHBpcmF0aW9ucz48ZXhwaXJhdGlvbj48IVtDREFUQVske3F1ZXJ5LmV4cGlyYXRpb258XV0+PC9leHBpcmF0aW9uPjxleHBpcmF0aW9uPjwhW0NEQVRBW31dXT48L2V4cGlyYXRpb24+PC9leHBpcmF0aW9ucz4NCiAgICA8cnRva2Vucz48cnRva2VuPjwhW0NEQVRBWyR7cXVlcnkucnRva2VufF1dPjwvcnRva2VuPjxydG9rZW4+PCFbQ0RBVEFbfV1dPjwvcnRva2VuPjwvcnRva2Vucz4NCiAgICA8cmV4cGlyYXRpb25zPjxyZXhwaXJhdGlvbj48IVtDREFUQVske3F1ZXJ5LnJleHBpcmF0aW9ufF1dPjwvcmV4cGlyYXRpb24+PHJleHBpcmF0aW9uPjwhW0NEQVRBW31dXT48L3JleHBpcmF0aW9uPjwvcmV4cGlyYXRpb25zPg0KICAgIDxzY29wZXM+PHNjb3BlPjwhW0NEQVRBWyR7cXVlcnkuc2NvcGV8XV0+PC9zY29wZT48c2NvcGU+PCFbQ0RBVEFbfV1dPjwvc2NvcGU+PC9zY29wZXM+DQogICAgPHJlc291cmNlX293bmVycz48cmVzb3VyY2Vfb3duZXI+PCFbQ0RBVEFbJHtxdWVyeS5yZXNvdXJjZV9vd25lcnxdXT48L3Jlc291cmNlX293bmVyPjxyZXNvdXJjZV9vd25lcj48IVtDREFUQVt9XV0+PC9yZXNvdXJjZV9vd25lcj48L3Jlc291cmNlX293bmVycz4NCiAgICA8Y2xpZW50cz48Y2xpZW50X2tleT48IVtDREFUQVske3F1ZXJ5LmNsaWVudF9rZXl8XV0+PC9jbGllbnRfa2V5PjxjbGllbnRfa2V5PjwhW0NEQVRBW31dXT48L2NsaWVudF9rZXk+PC9jbGllbnRzPg0KICAgIDxjbGllbnROYW1lcz48Y2xpZW50X25hbWU+PCFbQ0RBVEFbJHtxdWVyeS5jbGllbnRfbmFtZXxdXT48L2NsaWVudF9uYW1lPjxjbGllbnRfbmFtZT48IVtDREFUQVt9XV0+PC9jbGllbnRfbmFtZT48L2NsaWVudE5hbWVzPg0KICAgIDxzdGF0dXVzPjxzdGF0dXM+PCFbQ0RBVEFbJHtxdWVyeS5zdGF0dXN8XV0+PC9zdGF0dXM+PHN0YXR1cz48IVtDREFUQVt9XV0+PC9zdGF0dXM+PC9zdGF0dXVzPg0KICAgIDxjcmVhdGVkcz48Y3JlYXRlZD48IVtDREFUQVske3F1ZXJ5LmNyZWF0ZWR8XV0+PC9jcmVhdGVkPjxjcmVhdGVkPjwhW0NEQVRBW31dXT48L2NyZWF0ZWQ+PC9jcmVhdGVkcz4NCiAgICA8Y3VzdG9tcz48Y3VzdG9tPjwhW0NEQVRBWyR7cXVlcnkuY3VzdG9tfF1dPjwvY3VzdG9tPjxjdXN0b20+PCFbQ0RBVEFbfV1dPjwvY3VzdG9tPjwvY3VzdG9tcz4NCjwvdmFsdWVzPg==&quot;/&gt;
                            &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;transform jdbc result to xml&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Handle 'get'&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${tokentype}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;temporary&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;temporary&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${token}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${verifier}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:Prefix stringValue=&quot;temp&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT otk_token
                FROM oauth_initiate_view_verifier
                WHERE verifier=${verifier} and otk_token=${token}]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${temp.queryresult.count}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:NamingMap mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:NamingMap&gt;
                            &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT otk_token, secret, expiration,scope, resource_owner, client_name, client_key, created, verifier, callback,custom
                FROM oauth_initiate
                WHERE otk_token = ${temp.otk_token}]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all temporary token values of given token and verifier&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${token}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:NamingMap mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:NamingMap&gt;
                            &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT otk_token, secret, expiration, scope, resource_owner, client_name, client_key, created, verifier, callback,custom
                FROM oauth_initiate
                WHERE otk_token = ${token}]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all temporary token values of given token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${client_key}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resource_owner}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:Prefix stringValue=&quot;temp&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT otk_token, resource_owner, client_key
                FROM oauth_initiate_view_client_key
                WHERE client_key = ${client_key} and resource_owner=${resource_owner}]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${temp.queryresult.count}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:NamingMap mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:NamingMap&gt;
                            &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT otk_token, secret, expiration,scope, resource_owner, client_name, client_key, created, verifier, callback,custom
                FROM oauth_initiate
                WHERE otk_token = ${temp.otk_token}]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all temporary token values of given client, resource_owner&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${resource_owner}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:Prefix stringValue=&quot;temp&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT otk_token
                FROM oauth_initiate_view_resource_owner
                WHERE resource_owner = ${resource_owner}]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${temp.queryresult.count}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:NamingMap mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:NamingMap&gt;
                            &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT otk_token, secret, expiration,scope, resource_owner, client_name, client_key, created, verifier, callback,custom
                FROM oauth_initiate
                WHERE otk_token = ${temp.otk_token}]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all temporary token values of given resource_owner&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${client_key}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;getTemp&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;getTemp&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:Prefix stringValue=&quot;temp&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT otk_token
                FROM oauth_initiate_view_client_key
                WHERE client_key= ${client_key}]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${temp.queryresult.count}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:NamingMap mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;otk_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;token&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:NamingMap&gt;
                            &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT otk_token, secret, expiration,scope, resource_owner, client_name, client_key, created, verifier, callback,custom
                FROM oauth_initiate
                WHERE otk_token in (${temp.otk_token})]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all temporary token values of given client&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:FalseAssertion/&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;create the jdbc query&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${query.queryresult.count}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;0&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;PHZhbHVlcz4NCiAgICA8dG9rZW5zPjx0b2tlbj48IVtDREFUQVske3F1ZXJ5LnRva2VufF1dPjwvdG9rZW4+PHRva2VuPjwhW0NEQVRBW31dXT48L3Rva2VuPjwvdG9rZW5zPg0KICAgIDxzZWNyZXRzPjxzZWNyZXQ+PCFbQ0RBVEFbJHtxdWVyeS5zZWNyZXR8XV0+PC9zZWNyZXQ+PHNlY3JldD48IVtDREFUQVt9XV0+PC9zZWNyZXQ+PC9zZWNyZXRzPg0KICAgIDxleHBpcmF0aW9ucz48ZXhwaXJhdGlvbj48IVtDREFUQVske3F1ZXJ5LmV4cGlyYXRpb258XV0+PC9leHBpcmF0aW9uPjxleHBpcmF0aW9uPjwhW0NEQVRBW31dXT48L2V4cGlyYXRpb24+PC9leHBpcmF0aW9ucz4NCiAgICA8c2NvcGVzPjxzY29wZT48IVtDREFUQVske3F1ZXJ5LnNjb3BlfF1dPjwvc2NvcGU+PHNjb3BlPjwhW0NEQVRBW31dXT48L3Njb3BlPjwvc2NvcGVzPg0KICAgIDxyZXNvdXJjZV9vd25lcnM+PHJlc291cmNlX293bmVyPjwhW0NEQVRBWyR7cXVlcnkucmVzb3VyY2Vfb3duZXJ8XV0+PC9yZXNvdXJjZV9vd25lcj48cmVzb3VyY2Vfb3duZXI+PCFbQ0RBVEFbfV1dPjwvcmVzb3VyY2Vfb3duZXI+PC9yZXNvdXJjZV9vd25lcnM+DQogICAgPGNsaWVudHM+PGNsaWVudF9rZXk+PCFbQ0RBVEFbJHtxdWVyeS5jbGllbnRfa2V5fF1dPjwvY2xpZW50X2tleT48Y2xpZW50X2tleT48IVtDREFUQVt9XV0+PC9jbGllbnRfa2V5PjwvY2xpZW50cz4NCiAgICA8Y2xpZW50TmFtZXM+PGNsaWVudF9uYW1lPjwhW0NEQVRBWyR7cXVlcnkuY2xpZW50X25hbWV8XV0+PC9jbGllbnRfbmFtZT48Y2xpZW50X25hbWU+PCFbQ0RBVEFbfV1dPjwvY2xpZW50X25hbWU+PC9jbGllbnROYW1lcz4NCiAgICA8Y3JlYXRlZHM+PGNyZWF0ZWQ+PCFbQ0RBVEFbJHtxdWVyeS5jcmVhdGVkfF1dPjwvY3JlYXRlZD48Y3JlYXRlZD48IVtDREFUQVt9XV0+PC9jcmVhdGVkPjwvY3JlYXRlZHM+DQogICAgPGNhbGxiYWNrcz48Y2FsbGJhY2s+PCFbQ0RBVEFbJHtxdWVyeS5jYWxsYmFja3xdXT48L2NhbGxiYWNrPjxjYWxsYmFjaz48IVtDREFUQVt9XV0+PC9jYWxsYmFjaz48L2NhbGxiYWNrcz4NCiAgICA8dmVyaWZpZXJzPjx2ZXJpZmllcj48IVtDREFUQVske3F1ZXJ5LnZlcmlmaWVyfF1dPjwvdmVyaWZpZXI+PHZlcmlmaWVyPjwhW0NEQVRBW31dXT48L3ZlcmlmaWVyPjwvdmVyaWZpZXJzPg0KICAgIDxjdXN0b21zPjxjdXN0b20+PCFbQ0RBVEFbJHtxdWVyeS5jdXN0b218XV0+PC9jdXN0b20+PGN1c3RvbT48IVtDREFUQVt9XV0+PC9jdXN0b20+PC9jdXN0b21zPg0KPC92YWx1ZXM+&quot;/&gt;
                            &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;transform jdbc result to xml&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Handle 'getTemp'&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:XslTransformation&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Generate xml with one root and one field for each token&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Direction intValue=&quot;-1&quot;/&gt;
            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;resp&quot;/&gt;
            &lt;L7p:ResourceInfo staticResourceInfo=&quot;included&quot;&gt;
                &lt;L7p:Document stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[&lt;xsl:stylesheet version=&quot;1.0&quot;
                        xmlns:xls=&quot;http://www.w3.org/1999/XSL/Transform&quot;
                        xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt;

                &lt;xsl:output encoding=&quot;UTF-8&quot; indent=&quot;yes&quot; method=&quot;xml&quot;/&gt;
                &lt;xsl:param name=&quot;returnOffset&quot;/&gt;
                &lt;xsl:template match=&quot;/values&quot;&gt;
                &lt;xsl:element name=&quot;{name()}&quot;
                        xmlns=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;&gt;
                &lt;xsl:attribute name=&quot;offset&quot;&gt;&lt;xsl:value-of select=&quot;$returnOffset&quot;/&gt;&lt;/xsl:attribute&gt;
                &lt;xsl:for-each select=&quot;descendant::node()[node()][1]/child::node()[node()]&quot;&gt;
                &lt;xsl:variable name=&quot;index&quot;&gt;
                &lt;xsl:value-of select=&quot;position()&quot;/&gt;
                &lt;/xsl:variable&gt;
                &lt;value index=&quot;{$index}&quot;
                        xmlns=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;&gt;
                &lt;xsl:element name=&quot;{name()}&quot;
                        xmlns=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;&gt;
                &lt;xsl:value-of select=&quot;text()&quot;/&gt;
                &lt;/xsl:element&gt;
                &lt;xsl:for-each select=&quot;parent::node()/following-sibling::node()[node()]&quot;&gt;
                &lt;xsl:for-each select=&quot;*[position()=$index]&quot;&gt;
                &lt;xsl:copy-of select=&quot;self::node()&quot;/&gt;
                &lt;/xsl:for-each&gt;
                &lt;/xsl:for-each&gt;
                &lt;/value&gt;
                &lt;/xsl:for-each&gt;
                &lt;/xsl:element&gt;
                &lt;/xsl:template&gt;

                &lt;/xsl:stylesheet&gt;]]&gt;&lt;/L7p:Document&gt;
            &lt;/L7p:ResourceInfo&gt;
            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
            &lt;L7p:TransformName stringValue=&quot;&quot;/&gt;
            &lt;L7p:XsltVersion stringValue=&quot;1.0&quot;/&gt;
        &lt;/L7p:XslTransformation&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${format}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;json&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;json&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:JsonTransformation&gt;
                    &lt;L7p:DestinationMessageTarget MessageTarget=&quot;included&quot;&gt;
                        &lt;L7p:OtherTargetMessageVariable stringValue=&quot;resp&quot;/&gt;
                        &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                        &lt;L7p:TargetModifiedByGateway booleanValue=&quot;true&quot;/&gt;
                    &lt;/L7p:DestinationMessageTarget&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;resp&quot;/&gt;
                    &lt;L7p:PrettyPrint booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:RootTagString stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                &lt;/L7p:JsonTransformation&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLm1haW5wYXJ0fQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;resp.mainpart&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Enabled booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;resp.mainpart&quot;/&gt;
                    &lt;L7p:Regex stringValue=&quot;&amp;quot;xmlns&amp;quot;:[\s]?&amp;quot;http://ns.l7tech.com/2012/11/otk-tokenstore&amp;quot;,\n&quot;/&gt;
                    &lt;L7p:RegexName stringValue=&quot;Remove Namespace&quot;/&gt;
                    &lt;L7p:Replace booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                &lt;/L7p:Regex&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLm1haW5wYXJ0fQ==&quot;/&gt;
                    &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;dGV4dC94bWw7Y2hhcnNldD1VVEYtOA==&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;transform to json if applicable&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Token NoSQL GET</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fce6a</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.642Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="e001cfd0c1c1ffaa18e187b5e72fce6a" version="0">
                            <l7:Name>OTK Token NoSQL GET</l7:Name>
                            <l7:Guid>be3096c8-b46f-40f0-a7c7-903009d3e78a</l7:Guid>
                            <l7:PolicyReference id="e001cfd0c1c1ffaa18e187b5e72fcd11" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>rtoken</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>resource_owner</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>client_key</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>5</l7:Ordinal>
                                    <l7:ArgumentName>token_status</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>6</l7:Ordinal>
                                    <l7:ArgumentName>verifier</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>7</l7:Ordinal>
                                    <l7:ArgumentName>tokentype</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>8</l7:Ordinal>
                                    <l7:ArgumentName>format</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>9</l7:Ordinal>
                                    <l7:ArgumentName>queryOffset</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>10</l7:Ordinal>
                                    <l7:ArgumentName>dbsystem</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>resp</l7:ResultName>
                                    <l7:ResultType>message</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Returns values from the token database. 'tokentype' can either be 'token' or 'temporary'.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Storage_Access</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_usage">
                                    <l7:StringValue>Internal</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>Save16.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>44f2b8a4-71b6-41ae-ace9-f0e612de6c31</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Token Get (token)</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd1ab</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.663Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="bae27987-97aa-4029-bc62-778be9fa31b3" id="e001cfd0c1c1ffaa18e187b5e72fd1ab" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fcfce" guid="bae27987-97aa-4029-bc62-778be9fa31b3" id="e001cfd0c1c1ffaa18e187b5e72fd1ab" version="0">
                                <l7:Name>OTK Token Get (token)</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy can be found and should be used as 'Encapsulated Assertion'!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:Encapsulated&gt;
            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;db047e91-52db-4176-a3eb-a43aa0c2c67c&quot;/&gt;
            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Storage Configuration&quot;/&gt;
            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;custom&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                &lt;/L7p:entry&gt;
            &lt;/L7p:Parameters&gt;
        &lt;/L7p:Encapsulated&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;error code&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;overwritten in case of an error&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;DB location&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Set the location to access the database&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;ZmFsc2U=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;isLocal&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;eG1s&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;format&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;dG9rZW4=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;tokentype&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:Expression1 stringValue=&quot;${return_json}&quot;/&gt;
                &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;anNvbg==&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;format&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Setting return format&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${host_oauth_tokenstore_server}&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item regex=&quot;included&quot;&gt;
                            &lt;L7p:Pattern stringValue=&quot;http[s]?://(localhost|127[.]0[.]0[.]1).+&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;DB location&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Set the location to access the database&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;dHJ1ZQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;isLocal&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;cassandra&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;cassandra&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;af628087-2a37-45d7-b7c6-681c3d9e1526&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Token DB GET&quot;/&gt;
                        &lt;/L7p:Encapsulated&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;cassandra&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;cassandra&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;be3096c8-b46f-40f0-a7c7-903009d3e78a&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Token NoSQL GET&quot;/&gt;
                        &lt;/L7p:Encapsulated&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;dbsystem&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;check the dbsystem for SQL or NoSQL&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;local&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${isLocal}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;false&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;false&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;token&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;token&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;rtoken&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;rtoken&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;client_key&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;client_key&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;resource_owner&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;resource_owner&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;token_status&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;token_status&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;queryOffset&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;queryOffset&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                    &lt;L7p:ContentType stringValue=&quot;text/plain; charset=UTF-8&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;emptyMessage&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;no-fail&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;always succeed&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:CurrentSecurityHeaderHandling intValue=&quot;3&quot;/&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:HttpMethod httpMethod=&quot;GET&quot;/&gt;
                    &lt;L7p:PassThroughSoapFaults booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue=&quot;${host_oauth_tokenstore_server}/oauth/tokenstore/get?token=${token}&amp;amp;rtoken=${rtoken}&amp;amp;client_key=${client_key}&amp;amp;resource_owner=${resource_owner}&amp;amp;status=${token_status}&amp;amp;format=${format}&amp;amp;offset=${queryOffset}&quot;/&gt;
                    &lt;L7p:ProxyPassword stringValueNull=&quot;null&quot;/&gt;
                    &lt;L7p:ProxyUsername stringValueNull=&quot;null&quot;/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                        &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;/&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue=&quot;emptyMessage&quot;/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                        &lt;L7p:ForwardAll booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                        &lt;L7p:ForwardAll booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;&gt;
                            &lt;L7p:item httpPassthroughRule=&quot;included&quot;&gt;
                                &lt;L7p:Name stringValue=&quot;Set-Cookie&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:ResponseMsgDest stringValue=&quot;resp&quot;/&gt;
                    &lt;L7p:SamlAssertionVersion intValue=&quot;2&quot;/&gt;
                &lt;/L7p:HttpRoutingAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLmh0dHAuaGVhZGVyLngtY2EtZXJyfQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${httpRouting.reasonCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;500&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;LT&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;LT&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;500&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:AuditDetailAssertion&gt;
                            &lt;L7p:Detail stringValue=&quot;routing failed!&quot;/&gt;
                        &lt;/L7p:AuditDetailAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error code&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;set error code to 000&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:FalseAssertion/&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;routing errors&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:Regex&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;capture&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;capture the last 3 digits&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;error.code&quot;/&gt;
                            &lt;L7p:Regex stringValue=&quot;(\d{0,16})(\d{3})$&quot;/&gt;
                            &lt;L7p:Replace booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Replacement stringValue=&quot;$2&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                        &lt;/L7p:Regex&gt;
                        &lt;L7p:FalseAssertion/&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;error.code&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLmh0dHAuaGVhZGVyLmNvbnRlbnQtdHlwZX0=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;remote&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;database&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Token Get (token)</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd20f</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.664Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="e001cfd0c1c1ffaa18e187b5e72fd20f" version="0">
                            <l7:Name>OTK Token Get (token)</l7:Name>
                            <l7:Guid>19902efe-b202-49da-a5d9-619c57ee842a</l7:Guid>
                            <l7:PolicyReference id="e001cfd0c1c1ffaa18e187b5e72fd1ab" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Access Token</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>rtoken</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Refresh Token</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>client_key</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Client ID</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>resource_owner</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Resource Owner</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>5</l7:Ordinal>
                                    <l7:ArgumentName>token_status</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Token Status</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>6</l7:Ordinal>
                                    <l7:ArgumentName>return_json</l7:ArgumentName>
                                    <l7:ArgumentType>boolean</l7:ArgumentType>
                                    <l7:GuiLabel>Return as JSON?</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>7</l7:Ordinal>
                                    <l7:ArgumentName>queryOffset</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Offset in DB query</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>dbsystem</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>resp</l7:ResultName>
                                    <l7:ResultType>message</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Retrieves long living tokens from the token database.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Storage_Delegate</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>up-button.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="passMetricsToParent">
                                    <l7:StringValue>false</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>bae27987-97aa-4029-bc62-778be9fa31b3</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>cluster.hostname</l7:Name>
                    <l7:Id>0000000000000000fffffffffff5519f</l7:Id>
                    <l7:Type>CLUSTER_PROPERTY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.664Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:ClusterProperty id="0000000000000000fffffffffff5519f" version="4">
                            <l7:Name>cluster.hostname</l7:Name>
                            <l7:Value>mas.docker.local</l7:Value>
                        </l7:ClusterProperty>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>#OTK Variable Configuration</l7:Name>
                    <l7:Id>24e6fd7c5b6fb3a96690246c8ac49335</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.665Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="174ef22a-955b-465c-bd2a-9bc4caa888d8" id="24e6fd7c5b6fb3a96690246c8ac49335" version="4">
                            <l7:PolicyDetail folderId="161861da3a78c5dcdc62696d16914781" guid="174ef22a-955b-465c-bd2a-9bc4caa888d8" id="24e6fd7c5b6fb3a96690246c8ac49335" version="4">
                                <l7:Name>#OTK Variable Configuration</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>5</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Match the hostname that will be used by oauth clients&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;bWFzLmRvY2tlci5sb2NhbA==&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;oauth2_server_hostname&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Match the name of the cert that is used when SSL connections are made with oauth clients. The name has to match the value in 'Tasks - Manage Certificates'&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;bWFzLmRvY2tlci5sb2NhbA==&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;oauth2_server_certificate&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Variable Configuration</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd183</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.670Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="e64823db-25f0-462a-a226-44908c239fe6" id="e001cfd0c1c1ffaa18e187b5e72fd183" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fc858" guid="e64823db-25f0-462a-a226-44908c239fe6" id="e001cfd0c1c1ffaa18e187b5e72fd183" version="0">
                                <l7:Name>OTK Variable Configuration</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Required changes can be implemented in policies in the 'Customizations' folder &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === The policies within that folder will have the same name as this policy but &quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === either prefixed with '#' or suffixed with 'Extensions'&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Prefixed policies can be used to overwrite variables of this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === Suffixed policies can be used to extend functionality&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you find you cannot add your customizations using the policies in the 'Customizations' folder&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy can be found and should be used as 'Encapsulated Assertion'!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;TUFD&quot;/&gt;
                &lt;L7p:Enabled booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;oauth2_token_type&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;QkVBUkVS&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;oauth2_token_type&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Server type&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Configure the type of token that should be issued. MAG supports 'BEARER' only&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:All&gt;
        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0Mw==&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;host_oauth2_auth_server&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;L2F1dGgvb2F1dGgvdjIvYXV0aG9yaXpl&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;oauth2_auth_path&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;L2F1dGgvb2F1dGgvdjIvdG9rZW4=&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;oauth2_token_path&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;L2F1dGgvb2F1dGgvdjIvdG9rZW4vcmV2b2tl&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;oauth2_token_revocation_path&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Server Auth Server&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Configure values related to the authorization server&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:All&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Please review the values below and configure them to your needs&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Match the hostname that will be used by oauth clients&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:Base64Expression stringValue=&quot;JHtnYXRld2F5LmNsdXN0ZXIuaG9zdG5hbWV9&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;oauth2_server_hostname&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Match the name of the cert that is used when SSL connections are made with oauth clients. The name has to match the value in 'Tasks - Manage Certificates'&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:Base64Expression stringValue=&quot;JHtnYXRld2F5LmNsdXN0ZXIuaG9zdG5hbWV9&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;oauth2_server_certificate&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Match the port through which oauth clients connect&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:Base64Expression stringValue=&quot;ODQ0Mw==&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;oauth2_server_port&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;Set the url prefix if a prefix has been used when these policies were installed&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;oauth2_server_url_prefix&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;ZmFsc2U=&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;expose_client_secret&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;ZmFsc2U=&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;enable_anonymous_client_export&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;Modify the value below ONLY if the path has been modified&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;L2Nvbm5lY3Qvc2Vzc2lvbi9sb2dvdXQ=&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;usersession_logout_path&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;L29wZW5pZC9jb25uZWN0L3YxL3VzZXJpbmZv&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;userinfo_path&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;L2Nvbm5lY3Qvc2Vzc2lvbi9zdGF0dXM=&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;usersession_status_path&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:CommentAssertion&gt;
                &lt;L7p:Comment stringValue=&quot;The content below will be added to the configuration export JSON message as is&quot;/&gt;
            &lt;/L7p:CommentAssertion&gt;
            &lt;L7p:SetVariable&gt;
                &lt;L7p:Base64Expression stringValue=&quot;Im9hdXRoX2RlbW9fcHJvdGVjdGVkX2FwaV9lbmRwb2ludF9wYXRoIjoiL29hdXRoL3YyL3Byb3RlY3RlZGFwaS9mb28iLA0KIm1hZ19kZW1vX3Byb2R1Y3RzX2VuZHBvaW50X3BhdGgiOiIvcHJvdGVjdGVkL3Jlc291cmNlL3Byb2R1Y3RzIg==&quot;/&gt;
                &lt;L7p:VariableToSet stringValue=&quot;export_custom&quot;/&gt;
            &lt;/L7p:SetVariable&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Export&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Configure values related to the OAuth Manager client_id export feature&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:All&gt;
        &lt;L7p:Include&gt;
            &lt;L7p:PolicyGuid stringValue=&quot;174ef22a-955b-465c-bd2a-9bc4caa888d8&quot;/&gt;
        &lt;/L7p:Include&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Variable Configuration</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd2da</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.671Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="e001cfd0c1c1ffaa18e187b5e72fd2da" version="0">
                            <l7:Name>OTK Variable Configuration</l7:Name>
                            <l7:Guid>2e6e2ef3-a36f-4548-a2c4-7b369b7ae184</l7:Guid>
                            <l7:PolicyReference id="e001cfd0c1c1ffaa18e187b5e72fd183" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments/>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>enable_anonymous_client_export</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>export_custom</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>expose_client_secret</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>host_oauth2_auth_server</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>host_oauth2_auth_template_server</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>location_website_template</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>location_website_template_resources</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>oauth2_auth_path</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>oauth2_auth_template_path</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>oauth2_server_certificate</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>oauth2_server_hostname</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>oauth2_server_port</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>oauth2_server_url_prefix</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>oauth2_token_path</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>oauth2_token_revocation_path</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>oauth2_token_type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>oauth2_version</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>userinfo_path</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>usersession_logout_path</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>usersession_status_path</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Exports variables that are required to process OAuth requests.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Configuration</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_require_customization">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>ServerRegistry.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="passMetricsToParent">
                                    <l7:StringValue>false</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>e64823db-25f0-462a-a226-44908c239fe6</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK SCOPE Verification</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd147</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.687Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="2792f49f-c879-4eb1-a1e1-326bad2dcb74" id="e001cfd0c1c1ffaa18e187b5e72fd147" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fd08e" guid="2792f49f-c879-4eb1-a1e1-326bad2dcb74" id="e001cfd0c1c1ffaa18e187b5e72fd147" version="0">
                                <l7:Name>OTK SCOPE Verification</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy can be found and should be used as 'Encapsulated Assertion'!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy validates SCOPE&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;resetting any context variable to handle cases where it is not defined&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHthbnl9&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;any&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;initialize&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;will be overwritten in the case of an error&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:Split&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;valid SCOPE&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:InputVariable stringValue=&quot;scope.granted&quot;/&gt;
            &lt;L7p:OutputVariable stringValue=&quot;scopeGranted&quot;/&gt;
            &lt;L7p:SplitPattern stringValue=&quot;[ ]&quot;/&gt;
        &lt;/L7p:Split&gt;
        &lt;L7p:Split&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;required SCOPE&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:InputVariable stringValue=&quot;scope.required&quot;/&gt;
            &lt;L7p:OutputVariable stringValue=&quot;scopeRequired&quot;/&gt;
            &lt;L7p:SplitPattern stringValue=&quot;[ ]&quot;/&gt;
        &lt;/L7p:Split&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:Expression1 stringValue=&quot;${scope.required}&quot;/&gt;
                &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ForEachLoop L7p:Usage=&quot;Required&quot;
                    iterationLimit=&quot;100&quot; loopVariable=&quot;scopeRequired&quot; variablePrefix=&quot;verifyScope&quot;&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;ZmFsc2U=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;found&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:Expression1 stringValue=&quot;${scopeGranted}&quot;/&gt;
                                &lt;L7p:Expression2 stringValue=&quot;${verifyScope.current}&quot;/&gt;
                                &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;ANY&quot;/&gt;
                                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;${verifyScope.current}&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                    &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${any}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                    &lt;/L7p:ComparisonAssertion&gt;
                                    &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;dHJ1ZQ==&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;verifyScope.break&quot;/&gt;
                                    &lt;/L7p:SetVariable&gt;
                                    &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;any&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;pass and break from iteration if any scopes are found&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:assertionComment&gt;
                                &lt;/wsp:All&gt;
                                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                    &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${any}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;NE&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;NE&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                    &lt;/L7p:ComparisonAssertion&gt;
                                    &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;if we want to ensure all scopes match, we need to keep iterating&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:assertionComment&gt;
                                &lt;/wsp:All&gt;
                            &lt;/wsp:OneOrMore&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue=&quot;dHJ1ZQ==&quot;/&gt;
                                &lt;L7p:VariableToSet stringValue=&quot;found&quot;/&gt;
                            &lt;/L7p:SetVariable&gt;
                        &lt;/wsp:All&gt;
                        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:Expression1 stringValue=&quot;${scopeGranted}&quot;/&gt;
                                &lt;L7p:Expression2 stringValue=&quot;${verifyScope.current}&quot;/&gt;
                                &lt;L7p:MultivaluedComparison multivaluedComparison=&quot;ANY&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;NE&quot;/&gt;
                                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;NE&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;${verifyScope.current}&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                    &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${any}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;NE&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;NE&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                    &lt;/L7p:ComparisonAssertion&gt;
                                    &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;ZmFsc2U=&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;found&quot;/&gt;
                                    &lt;/L7p:SetVariable&gt;
                                    &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;dHJ1ZQ==&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;verifyScope.break&quot;/&gt;
                                    &lt;/L7p:SetVariable&gt;
                                    &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;all&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;if we require all scopes to be found, and we find a scope that doesn't match, break&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:assertionComment&gt;
                                &lt;/wsp:All&gt;
                                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                    &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${any}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                    &lt;/L7p:ComparisonAssertion&gt;
                                    &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;any&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;continue iterating if 'any' flag is true&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:assertionComment&gt;
                                &lt;/wsp:All&gt;
                            &lt;/wsp:OneOrMore&gt;
                        &lt;/wsp:All&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;validate&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;iterate&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;over each SCOPE&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/L7p:ForEachLoop&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${found}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${fail}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;NE&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;NE&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;pass if scopes were found and 'fail' flag is not set&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${found}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;NE&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;NE&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${fail}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;pass if 'fail' flag is set and the scope is not found&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTE1&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;verification&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK SCOPE Verification</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd28f</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.687Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="e001cfd0c1c1ffaa18e187b5e72fd28f" version="0">
                            <l7:Name>OTK SCOPE Verification</l7:Name>
                            <l7:Guid>f78f0f85-00e2-49b1-95e4-e520df255c9c</l7:Guid>
                            <l7:PolicyReference id="e001cfd0c1c1ffaa18e187b5e72fd147" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>scope.granted</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Granted SCOPE</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>scope.required</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Required SCOPE</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>fail</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Fail if the SCOPE is found (true|false)?</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>any</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Pass if any of the required SCOPEs are found (true|false)?</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Veryfies SCOPE and fails if the requested SCOPE does not match the granted one.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Access_Control</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_in_scope.granted">
                                    <l7:StringValue>A space separated list of granted/ valid SCOPE values</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_in_scope.required">
                                    <l7:StringValue>A space separated list of required SCOPE values</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>oauth.png</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="passMetricsToParent">
                                    <l7:StringValue>false</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>2792f49f-c879-4eb1-a1e1-326bad2dcb74</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Token DB Delete</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fccc1</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.701Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="fe455d03-c935-44d1-9b44-5ecad7832462" id="e001cfd0c1c1ffaa18e187b5e72fccc1" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fcbcd" guid="fe455d03-c935-44d1-9b44-5ecad7832462" id="e001cfd0c1c1ffaa18e187b5e72fccc1" version="0">
                                <l7:Name>OTK Token DB Delete</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy can be found and should be used as 'Encapsulated Assertion'!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy removes token from the database&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;initialize&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;will be overwritten in the case of an error&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;fCR7dGVtcF90b2tlbn18JHthY2Nlc3NfdG9rZW59fCR7cmVmcmVzaF90b2tlbn18JHtjbGllbnRfa2V5fQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;all&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${all}&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item regex=&quot;included&quot;&gt;
                            &lt;L7p:Pattern stringValue=&quot;([|].+[|][|][|])|([|][|].+[|][|])|([|][|][|].+[|])|([|][|][|][|].+)&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;success&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue=&quot;No valid parameters have been provided&quot;/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAz&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;parameters&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;check that at only one parameter was given&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${temp_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;empty&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;empty&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${access_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;empty&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;empty&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${refresh_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;empty&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;empty&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:JdbcQuery&gt;
                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[DELETE FROM oauth_initiate
                                WHERE token=${temp_token}]]&gt;&lt;/L7p:SqlQuery&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                &lt;/L7p:JdbcQuery&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;temporary&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${access_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;empty&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;empty&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${temp_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;empty&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;empty&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${refresh_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;empty&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;empty&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:JdbcQuery&gt;
                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[DELETE FROM oauth_token
                                WHERE token=${access_token}]]&gt;&lt;/L7p:SqlQuery&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                &lt;/L7p:JdbcQuery&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;access_token&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${refresh_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;empty&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;empty&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${access_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;empty&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;empty&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${temp_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;empty&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;empty&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:JdbcQuery&gt;
                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[DELETE FROM oauth_token
                                WHERE rtoken=${refresh_token}]]&gt;&lt;/L7p:SqlQuery&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                &lt;/L7p:JdbcQuery&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;refresh_token&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${client_key}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;empty&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;empty&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:JdbcQuery&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Delete from temporary token table&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[DELETE FROM oauth_initiate
                                WHERE client_key=${client_key}]]&gt;&lt;/L7p:SqlQuery&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                &lt;/L7p:JdbcQuery&gt;
                &lt;L7p:JdbcQuery&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Delete from long living token table&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:AssertionFailureEnabled booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;OAuth&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:SqlQuery stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[DELETE FROM oauth_token
                                WHERE client_key=${client_key}]]&gt;&lt;/L7p:SqlQuery&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;query&quot;/&gt;
                &lt;/L7p:JdbcQuery&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;many&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;delete all tokens that were issued to the given client_key (client_id)&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue=&quot;An error occured and the token most likely could not be deleted&quot;/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;delete&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS5xdWVyeXJlc3VsdC5jb3VudH0gdG9rZW4ocykgZGVsZXRlZA==&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;result&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;dGV4dC9wbGFpbjtjaGFyc2V0PVVURi04&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Token DB Delete</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fcdfa</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.701Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="e001cfd0c1c1ffaa18e187b5e72fcdfa" version="0">
                            <l7:Name>OTK Token DB Delete</l7:Name>
                            <l7:Guid>2e218ef8-2fd1-4e8b-8063-917162312dcc</l7:Guid>
                            <l7:PolicyReference id="e001cfd0c1c1ffaa18e187b5e72fccc1" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>access_token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>client_key</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>refresh_token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>temp_token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>result</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Deletes token from the persistence layer.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Storage_Access</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_usage">
                                    <l7:StringValue>Internal</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>Save16.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>fe455d03-c935-44d1-9b44-5ecad7832462</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Token NoSQL Delete</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fcce9</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.729Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="6442ac74-9624-4e01-a8aa-82d9bdc90756" id="e001cfd0c1c1ffaa18e187b5e72fcce9" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fcbcd" guid="6442ac74-9624-4e01-a8aa-82d9bdc90756" id="e001cfd0c1c1ffaa18e187b5e72fcce9" version="0">
                                <l7:Name>OTK Token NoSQL Delete</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy can be found and should be used as 'Encapsulated Assertion'!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy removes token from the database&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;VG9rZW4gY291bGQgbm90IGJlIGRlbGV0ZWQ=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;result&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;dGV4dC9wbGFpbjtjaGFyc2V0PVVURi04&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;fCR7dGVtcF90b2tlbn18JHthY2Nlc3NfdG9rZW59fCR7cmVmcmVzaF90b2tlbn18JHtjbGllbnRfa2V5fQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;all&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${all}&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item regex=&quot;included&quot;&gt;
                            &lt;L7p:Pattern stringValue=&quot;([|].+[|][|][|])|([|][|].+[|][|])|([|][|][|].+[|])|([|][|][|][|].+)&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;success&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue=&quot;No valid parameters have been provided&quot;/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MTAz&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;NDAw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;TWlzc2luZyBvciB1bmtub3duIHBhcmFtZXRlcnM=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;result&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;parameters&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;check that at only one parameter was given&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${temp_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;empty&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;empty&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:CassandraQuery&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                    &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                    &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT client_key, resource_owner FROM oauth_initiate
                WHERE otk_token=${temp_token}]]&gt;&lt;/L7p:QueryDocument&gt;
                    &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                &lt;/L7p:CassandraQuery&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${query.queryresult.count}&quot;/&gt;
                        &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item dataType=&quot;included&quot;&gt;
                                &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:CassandraQuery&gt;
                        &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                        &lt;L7p:FailIfNoResults booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                        &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                        &lt;L7p:Prefix stringValue=&quot;deleteQuery&quot;/&gt;
                        &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[BEGIN BATCH

                DELETE FROM oauth_initiate WHERE otk_token=${temp_token};
                DELETE FROM oauth_initiate_view_client_key WHERE client_key=${query.client_key}
                DELETE FROM oauth_initiate_view_verifier WHERE otk_token=${temp_token};
                DELETE FROM oauth_initiate_view_resource_owner WHERE resource_owner = ${query.resource_owner} AND client_key = ${query.client_key} AND otk_token = ${temp_token}

                APPLY BATCH;]]&gt;&lt;/L7p:QueryDocument&gt;
                        &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                    &lt;/L7p:CassandraQuery&gt;
                    &lt;L7p:CassandraQuery&gt;
                        &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                        &lt;L7p:FailIfNoResults booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                        &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                        &lt;L7p:Prefix stringValue=&quot;deleteQuery&quot;/&gt;
                        &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[BEGIN BATCH

                DELETE FROM oauth_initiate WHERE otk_token=${temp_token};
                DELETE FROM oauth_initiate_view_client_key WHERE client_key=${query.client_key}
                DELETE FROM oauth_initiate_view_resource_owner WHERE resource_owner = ${query.resource_owner} AND client_key = ${query.client_key} AND otk_token = ${temp_token}

                APPLY BATCH;]]&gt;&lt;/L7p:QueryDocument&gt;
                        &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                    &lt;/L7p:CassandraQuery&gt;
                    &lt;L7p:CassandraQuery&gt;
                        &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                        &lt;L7p:FailIfNoResults booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                        &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                        &lt;L7p:Prefix stringValue=&quot;deleteQuery&quot;/&gt;
                        &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[BEGIN BATCH

                DELETE FROM oauth_initiate WHERE otk_token=${temp_token};
                DELETE FROM oauth_initiate_view_client_key WHERE client_key=${query.client_key}

                APPLY BATCH;]]&gt;&lt;/L7p:QueryDocument&gt;
                        &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                    &lt;/L7p:CassandraQuery&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;temporary token&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${access_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;empty&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;empty&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:CassandraQuery&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                    &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                    &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT otoken, client_key, client_ident, created, resource_owner, client_name FROM oauth_access_token
WHERE otk_token = ${access_token}]]&gt;&lt;/L7p:QueryDocument&gt;
                    &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                &lt;/L7p:CassandraQuery&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS5vdG9rZW59&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;tempRefreshToken&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${query.queryresult.count}&quot;/&gt;
                        &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item dataType=&quot;included&quot;&gt;
                                &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${tempRefreshToken}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS5jbGllbnRfbmFtZX1fJHthY2Nlc3NfdG9rZW59&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;paginationKey&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FailIfNoResults booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:Prefix stringValue=&quot;deleteQuery&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[BEGIN BATCH
                DELETE FROM oauth_refresh_token WHERE otk_token = ${query.otoken};
                DELETE FROM oauth_refresh_token_view_client_key WHERE client_key = ${query.client_key} AND resource_owner = ${query.resource_owner} AND otk_token = ${query.otoken};
                DELETE FROM oauth_refresh_token_view_resource_owner WHERE resource_owner = ${query.resource_owner} AND client_key = ${query.client_key} AND otk_token = ${query.otoken};
                DELETE FROM oauth_access_token WHERE otk_token=${access_token};
                DELETE FROM oauth_access_token_view_client_key WHERE client_key = ${query.client_key} AND resource_owner = ${query.resource_owner} AND otk_token = ${access_token};
                DELETE FROM oauth_access_token_view_resource_owner WHERE resource_owner = ${query.resource_owner} AND client_key = ${query.client_key} AND otk_token = ${access_token};
                DELETE FROM oauth_access_token_pagination WHERE client_name_otk_token = ${paginationKey}
                DELETE FROM oauth_access_token_view_client_ident WHERE client_ident=${query.client_ident} AND resource_owner=${query.resource_owner} AND created=${query.created} AND otk_token=${access_token}
                APPLY BATCH;]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${tempRefreshToken}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS5jbGllbnRfbmFtZX1fJHthY2Nlc3NfdG9rZW59&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;paginationKey&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FailIfNoResults booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:Prefix stringValue=&quot;deleteQuery&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[BEGIN BATCH

                DELETE FROM oauth_access_token WHERE otk_token=${access_token};
                DELETE FROM oauth_access_token_view_client_key WHERE client_key = ${query.client_key} AND resource_owner = ${query.resource_owner} AND otk_token = ${access_token};
                DELETE FROM oauth_access_token_view_resource_owner WHERE resource_owner = ${query.resource_owner} AND client_key = ${query.client_key} AND otk_token = ${access_token};
                DELETE FROM oauth_access_token_pagination WHERE client_name_otk_token = ${paginationKey}
                DELETE FROM oauth_access_token_view_client_ident WHERE client_ident=${query.client_ident} AND resource_owner=${query.resource_owner} AND created=${query.created} AND otk_token=${access_token}
                APPLY BATCH;]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;access_token&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${refresh_token}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;empty&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;empty&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:CassandraQuery&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                    &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                    &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT otoken, client_key, resource_owner, client_name FROM oauth_refresh_token
                WHERE otk_token = ${refresh_token}]]&gt;&lt;/L7p:QueryDocument&gt;
                    &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                &lt;/L7p:CassandraQuery&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS5vdG9rZW59&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;tempAccessToken&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${query.queryresult.count}&quot;/&gt;
                        &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item dataType=&quot;included&quot;&gt;
                                &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${tempAccessToken}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS5jbGllbnRfbmFtZX1fJHt0ZW1wQWNjZXNzdG9rZW59&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;paginationKey&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:Prefix stringValue=&quot;accessTokenQuery&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT client_ident, created FROM oauth_access_token
WHERE otk_token=${query.otoken}]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FailIfNoResults booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:Prefix stringValue=&quot;deleteQuery&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[BEGIN BATCH

                DELETE FROM oauth_access_token WHERE otk_token = ${query.otoken};
                DELETE FROM oauth_access_token_view_client_key WHERE client_key = ${query.client_key} AND resource_owner = ${query.resource_owner} AND otk_token = ${query.otoken};
                DELETE FROM oauth_access_token_view_resource_owner WHERE resource_owner = ${query.resource_owner} AND client_key = ${query.client_key} AND otk_token = ${query.otoken};
                DELETE FROM oauth_access_token_pagination WHERE client_name_otk_token = ${paginationKey}
                DELETE FROM oauth_access_token_view_client_ident WHERE client_ident=${accessTokenQuery.client_ident} AND resource_owner=${query.resource_owner} AND created=${accessTokenQuery.created} AND otk_token=${query.otoken}

                DELETE FROM oauth_refresh_token WHERE otk_token=${refresh_token};
                DELETE FROM oauth_refresh_token_view_client_key WHERE client_key = ${query.client_key} AND resource_owner = ${query.resource_owner} AND otk_token = ${refresh_token};
                DELETE FROM oauth_refresh_token_view_resource_owner WHERE resource_owner = ${query.resource_owner} AND client_key = ${query.client_key} AND otk_token = ${refresh_token};

                APPLY BATCH;]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${tempAccessToken}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FailIfNoResults booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:Prefix stringValue=&quot;deleteQuery&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[BEGIN BATCH

                DELETE FROM oauth_refresh_token WHERE otk_token=${refresh_token};
                DELETE FROM oauth_refresh_token_view_client_key WHERE client_key = ${query.client_key} AND resource_owner = ${query.resource_owner} AND otk_token = ${refresh_token};
                DELETE FROM oauth_refresh_token_view_resource_owner WHERE resource_owner = ${query.resource_owner} AND client_key = ${query.client_key} AND otk_token = ${refresh_token};

                APPLY BATCH;]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;refresh_token&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${client_key}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;empty&quot;/&gt;
                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;empty&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:CassandraQuery&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                    &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:Prefix stringValue=&quot;query&quot;/&gt;
                    &lt;L7p:QueryDocument stringValue=&quot;SELECT otk_token, resource_owner, client_name FROM oauth_access_token_view_client_key WHERE client_key = ${client_key}&quot;/&gt;
                    &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                &lt;/L7p:CassandraQuery&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${query.queryresult.count}&quot;/&gt;
                        &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item dataType=&quot;included&quot;&gt;
                                &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS5jbGllbnRfbmFtZX1fJHtxdWVyeS5vdGtfdG9rZW59&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;paginationKey&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:ForEachLoop L7p:Usage=&quot;Required&quot;
                            loopVariable=&quot;query.otk_token&quot; variablePrefix=&quot;i&quot;&gt;
                            &lt;L7p:ItemLookupByIndex&gt;
                                &lt;L7p:IndexValue stringValue=&quot;${i.iterations}&quot;/&gt;
                                &lt;L7p:MultivaluedVariableName stringValue=&quot;query.otk_token&quot;/&gt;
                                &lt;L7p:OutputVariableName stringValue=&quot;otk_token&quot;/&gt;
                            &lt;/L7p:ItemLookupByIndex&gt;
                            &lt;L7p:ItemLookupByIndex&gt;
                                &lt;L7p:IndexValue stringValue=&quot;${i.iterations}&quot;/&gt;
                                &lt;L7p:MultivaluedVariableName stringValue=&quot;query.client_name&quot;/&gt;
                                &lt;L7p:OutputVariableName stringValue=&quot;client_name&quot;/&gt;
                            &lt;/L7p:ItemLookupByIndex&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue=&quot;JHtjbGllbnRfbmFtZX1fJHtvdGtfdG9rZW59&quot;/&gt;
                                &lt;L7p:VariableToSet stringValue=&quot;paginationKey&quot;/&gt;
                            &lt;/L7p:SetVariable&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:CassandraQuery&gt;
                                    &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                                    &lt;L7p:FailIfNoResults booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                                    &lt;L7p:Prefix stringValue=&quot;clientIdentQuery&quot;/&gt;
                                    &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT otk_token, client_ident, created, resource_owner FROM oauth_access_token 
WHERE otk_token=${otk_token}]]&gt;&lt;/L7p:QueryDocument&gt;
                                    &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                                &lt;/L7p:CassandraQuery&gt;
                                &lt;L7p:CassandraQuery&gt;
                                    &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                                    &lt;L7p:FailIfNoResults booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                                    &lt;L7p:Prefix stringValue=&quot;deleteClientIdentQuery&quot;/&gt;
                                    &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[DELETE FROM oauth_access_token_view_client_ident
WHERE client_ident=${clientIdentQuery.client_ident} 
AND resource_owner=${clientIdentQuery.resource_owner}
AND created=${clientIdentQuery.created}
AND otk_token=${clientIdentQuery.otk_token}]]&gt;&lt;/L7p:QueryDocument&gt;
                                    &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                                &lt;/L7p:CassandraQuery&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;client_ident view&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:CassandraQuery&gt;
                                &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                                &lt;L7p:FailIfNoResults booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                                &lt;L7p:MaxRecords intValue=&quot;10&quot;/&gt;
                                &lt;L7p:Prefix stringValue=&quot;deleteQuery&quot;/&gt;
                                &lt;L7p:QueryDocument stringValue=&quot;DELETE FROM oauth_access_token_pagination WHERE client_name_otk_token = ${paginationKey}&quot;/&gt;
                                &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                            &lt;/L7p:CassandraQuery&gt;
                        &lt;/L7p:ForEachLoop&gt;
                        &lt;L7p:CassandraQuery&gt;
                            &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                            &lt;L7p:FailIfNoResults booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                            &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                            &lt;L7p:Prefix stringValue=&quot;deleteQuery&quot;/&gt;
                            &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[BEGIN BATCH
                DELETE FROM oauth_access_token WHERE otk_token IN (${query.otk_token});
                DELETE FROM oauth_access_token_view_client_key WHERE client_key = ${client_key};
                DELETE FROM oauth_access_token_view_resource_owner WHERE resource_owner IN (${query.resource_owner}) AND client_key = ${client_key};
                APPLY BATCH;]]&gt;&lt;/L7p:QueryDocument&gt;
                            &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                        &lt;/L7p:CassandraQuery&gt;
                    &lt;/wsp:All&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:CassandraQuery&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                    &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:Prefix stringValue=&quot;refreshTokenQuery&quot;/&gt;
                    &lt;L7p:QueryDocument stringValue=&quot;SELECT otk_token, resource_owner FROM oauth_refresh_token_view_client_key WHERE client_key = ${client_key}&quot;/&gt;
                    &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                &lt;/L7p:CassandraQuery&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${refreshTokenQuery.queryresult.count}&quot;/&gt;
                        &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item dataType=&quot;included&quot;&gt;
                                &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:CassandraQuery&gt;
                        &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                        &lt;L7p:FailIfNoResults booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                        &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                        &lt;L7p:Prefix stringValue=&quot;deleteQuery&quot;/&gt;
                        &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[BEGIN BATCH
                DELETE FROM oauth_refresh_token WHERE otk_token IN (${refreshTokenQuery.otk_token});
                DELETE FROM oauth_refresh_token_view_client_key WHERE client_key = ${client_key};
                DELETE FROM oauth_refresh_token_view_resource_owner WHERE resource_owner IN (${refreshTokenQuery.resource_owner}) AND client_key = ${client_key};
                APPLY BATCH;]]&gt;&lt;/L7p:QueryDocument&gt;
                        &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                    &lt;/L7p:CassandraQuery&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:CassandraQuery&gt;
                    &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                    &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                    &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                    &lt;L7p:Prefix stringValue=&quot;tempTokenQuery&quot;/&gt;
                    &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[SELECT otk_token, resource_owner FROM oauth_initiate_view_client_key WHERE
                client_key = ${client_key}]]&gt;&lt;/L7p:QueryDocument&gt;
                    &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                &lt;/L7p:CassandraQuery&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${tempTokenQuery.queryresult.count}&quot;/&gt;
                        &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item dataType=&quot;included&quot;&gt;
                                &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:CassandraQuery&gt;
                        &lt;L7p:ConnectionName stringValue=&quot;OAuth_Cassandra&quot;/&gt;
                        &lt;L7p:FailIfNoResults booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:FetchSize intValue=&quot;5000&quot;/&gt;
                        &lt;L7p:MaxRecords intValue=&quot;1000&quot;/&gt;
                        &lt;L7p:Prefix stringValue=&quot;deleteQuery&quot;/&gt;
                        &lt;L7p:QueryDocument stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[BEGIN BATCH

                DELETE FROM oauth_initiate where otk_token IN (${tempTokenQuery.otk_token});
                DELETE FROM oauth_initiate_view_client_key WHERE client_key = ${client_key};
                DELETE FROM oauth_initiate_view_verifier where otk_token IN (${tempTokenQuery.otk_token});
                DELETE FROM oauth_initiate_view_resource_owner WHERE resource_owner IN (${tempTokenQuery.resource_owner}) AND client_key = ${client_key};

                APPLY BATCH;]]&gt;&lt;/L7p:QueryDocument&gt;
                        &lt;L7p:QueryTimeout stringValueNull=&quot;null&quot;/&gt;
                    &lt;/L7p:CassandraQuery&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;client_key&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;either client_id or oauth_consumer_key&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue=&quot;An error occured and the token most likely could not be deleted&quot;/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHtxdWVyeS5xdWVyeXJlc3VsdC5jb3VudH0gdG9rZW4ocykgZGVsZXRlZA==&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;result&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Token NoSQL Delete</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fce5a</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.730Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="e001cfd0c1c1ffaa18e187b5e72fce5a" version="0">
                            <l7:Name>OTK Token NoSQL Delete</l7:Name>
                            <l7:Guid>927166a6-c831-4964-a66f-4f420bfdffcc</l7:Guid>
                            <l7:PolicyReference id="e001cfd0c1c1ffaa18e187b5e72fcce9" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>access_token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>client_key</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>refresh_token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>temp_token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>result</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Deletes token from the persistence layer.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Storage_Access</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_usage">
                                    <l7:StringValue>Internal</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>Save16.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>6442ac74-9624-4e01-a8aa-82d9bdc90756</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Token Delete</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd16f</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.745Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="32285486-39c2-43da-aa40-7587c3300212" id="e001cfd0c1c1ffaa18e187b5e72fd16f" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fcfce" guid="32285486-39c2-43da-aa40-7587c3300212" id="e001cfd0c1c1ffaa18e187b5e72fd16f" version="0">
                                <l7:Name>OTK Token Delete</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy can be found and should be used as 'Encapsulated Assertion'!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:Encapsulated&gt;
            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;db047e91-52db-4176-a3eb-a43aa0c2c67c&quot;/&gt;
            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Storage Configuration&quot;/&gt;
            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;custom&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                &lt;/L7p:entry&gt;
            &lt;/L7p:Parameters&gt;
        &lt;/L7p:Encapsulated&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;error code&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;overwritten in case of an error&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;DB location&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Set the location to access the database&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;ZmFsc2U=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;isLocal&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${host_oauth_tokenstore_server}&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item regex=&quot;included&quot;&gt;
                            &lt;L7p:Pattern stringValue=&quot;http[s]?://(localhost|127[.]0[.]0[.]1).+&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;DB location&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Set the location to access the database&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;dHJ1ZQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;isLocal&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;cassandra&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;cassandra&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;2e218ef8-2fd1-4e8b-8063-917162312dcc&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Token DB Delete&quot;/&gt;
                        &lt;/L7p:Encapsulated&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${dbsystem}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;cassandra&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;cassandra&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;927166a6-c831-4964-a66f-4f420bfdffcc&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Token NoSQL Delete&quot;/&gt;
                        &lt;/L7p:Encapsulated&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;dbsystem&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;check the dbsystem for SQL or NoSQL&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;local&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${isLocal}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;false&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;false&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;access_token&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;access_token&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;refresh_token&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;refresh_token&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;client_key&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;client_key&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue=&quot;temp_token&quot;/&gt;
                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                    &lt;L7p:TargetVariableName stringValue=&quot;temp_token&quot;/&gt;
                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                &lt;/L7p:EncodeDecode&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                    &lt;L7p:ContentType stringValue=&quot;text/plain; charset=UTF-8&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;emptyMessage&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;no-fail&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;always success&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:CurrentSecurityHeaderHandling intValue=&quot;3&quot;/&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:HttpMethod httpMethod=&quot;DELETE&quot;/&gt;
                    &lt;L7p:PassThroughSoapFaults booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue=&quot;${host_oauth_tokenstore_server}/oauth/tokenstore/delete?temp_token=${temp_token}&amp;amp;token=${access_token}&amp;amp;rtoken=${refresh_token}&amp;amp;client_key=${client_key}&quot;/&gt;
                    &lt;L7p:ProxyPassword stringValueNull=&quot;null&quot;/&gt;
                    &lt;L7p:ProxyUsername stringValueNull=&quot;null&quot;/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                        &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;/&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue=&quot;emptyMessage&quot;/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                        &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                        &lt;L7p:ForwardAll booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;&gt;
                            &lt;L7p:item httpPassthroughRule=&quot;included&quot;&gt;
                                &lt;L7p:Name stringValue=&quot;Set-Cookie&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:ResponseMsgDest stringValue=&quot;resp&quot;/&gt;
                    &lt;L7p:SamlAssertionVersion intValue=&quot;2&quot;/&gt;
                &lt;/L7p:HttpRoutingAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLmh0dHAuaGVhZGVyLngtY2EtZXJyfQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${httpRouting.reasonCode}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;500&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;LT&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;LT&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;500&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:AuditDetailAssertion&gt;
                            &lt;L7p:Detail stringValue=&quot;routing failed!&quot;/&gt;
                        &lt;/L7p:AuditDetailAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error code&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;set error code to 000&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:FalseAssertion/&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;routing errors&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:Regex&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;capture&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;capture the last 3 digits&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;error.code&quot;/&gt;
                            &lt;L7p:Regex stringValue=&quot;(\d{0,16})(\d{3})$&quot;/&gt;
                            &lt;L7p:Replace booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Replacement stringValue=&quot;$2&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                        &lt;/L7p:Regex&gt;
                        &lt;L7p:FalseAssertion/&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;error.code&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLmh0dHAuaGVhZGVyLmNvbnRlbnQtdHlwZX0=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLm1haW5wYXJ0fQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;result&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;remote&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;database&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Token Delete</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd25d</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.745Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="e001cfd0c1c1ffaa18e187b5e72fd25d" version="0">
                            <l7:Name>OTK Token Delete</l7:Name>
                            <l7:Guid>ada963ed-0428-4ead-8576-9ef79193752c</l7:Guid>
                            <l7:PolicyReference id="e001cfd0c1c1ffaa18e187b5e72fd16f" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>access_token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Access Token</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>refresh_token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Refresh Token</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>temp_token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Temporary Token (code|request_token)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>client_key</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Client ID</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>result</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Deletes a token from the persistence layer.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Storage_Delegate</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>down-button.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>32285486-39c2-43da-aa40-7587c3300212</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK OAuth 2.0 Token Validation - BEARER</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd1d3</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.754Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="f07df530-d404-47ad-88a6-dadb4421ead3" id="e001cfd0c1c1ffaa18e187b5e72fd1d3" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fd08e" guid="f07df530-d404-47ad-88a6-dadb4421ead3" id="e001cfd0c1c1ffaa18e187b5e72fd1d3" version="0">
                                <l7:Name>OTK OAuth 2.0 Token Validation - BEARER</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Validates OAuth 2.0 Bearer tokens only&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:Encapsulated&gt;
            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;2e6e2ef3-a36f-4548-a2c4-7b369b7ae184&quot;/&gt;
            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Variable Configuration&quot;/&gt;
        &lt;/L7p:Encapsulated&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHt0b2tlblZhbHVlcy5tYWlucGFydH0=&quot;/&gt;
            &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;tokenValues&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;initialize&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;overwritten in the case of an error&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${oauth2_token_type}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;BEARER&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;BEARER&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;xpathExpiration&quot;/&gt;
                    &lt;L7p:XmlMsgSrc stringValue=&quot;tokenValues&quot;/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                        &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:expiration/text()&quot;/&gt;
                        &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Namespaces&gt;
                        &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                    &lt;/L7p:XpathExpression&gt;
                &lt;/L7p:ResponseXpathAssertion&gt;
                &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;xpathScope&quot;/&gt;
                    &lt;L7p:XmlMsgSrc stringValue=&quot;tokenValues&quot;/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                        &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:scope/text()&quot;/&gt;
                        &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Namespaces&gt;
                        &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                    &lt;/L7p:XpathExpression&gt;
                &lt;/L7p:ResponseXpathAssertion&gt;
                &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;xpathStatus&quot;/&gt;
                    &lt;L7p:XmlMsgSrc stringValue=&quot;tokenValues&quot;/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                        &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:status/text()&quot;/&gt;
                        &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Namespaces&gt;
                        &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                    &lt;/L7p:XpathExpression&gt;
                &lt;/L7p:ResponseXpathAssertion&gt;
                &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;xpathClientKey&quot;/&gt;
                    &lt;L7p:XmlMsgSrc stringValue=&quot;tokenValues&quot;/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                        &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:client_key/text()&quot;/&gt;
                        &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Namespaces&gt;
                        &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                    &lt;/L7p:XpathExpression&gt;
                &lt;/L7p:ResponseXpathAssertion&gt;
                &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;xpathOwner&quot;/&gt;
                    &lt;L7p:XmlMsgSrc stringValue=&quot;tokenValues&quot;/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                        &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:resource_owner/text()&quot;/&gt;
                        &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Namespaces&gt;
                        &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                    &lt;/L7p:XpathExpression&gt;
                &lt;/L7p:ResponseXpathAssertion&gt;
                &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue=&quot;xpathCustom&quot;/&gt;
                    &lt;L7p:XmlMsgSrc stringValue=&quot;tokenValues&quot;/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                        &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:custom&quot;/&gt;
                        &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Namespaces&gt;
                        &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                    &lt;/L7p:XpathExpression&gt;
                &lt;/L7p:ResponseXpathAssertion&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;success&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue=&quot;error: invalid_request, error_description: Access token does not exist (expired, revoked, replaced, unknown, ...). access_token='${access_token}'&quot;/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;OTkw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;extract values&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;dateTime&quot;/&gt;
                    &lt;L7p:DateOffsetExpression stringValue=&quot;&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;now&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${now.seconds}&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;LE&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;${xpathExpiration.result}&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;success&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue=&quot;error: invalid_request, error_description: Access token has expired: expiration: ${xpathExpiration.result}, time_now: ${gateway.time.seconds}&quot;/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;OTkw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;expiration&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:Encapsulated&gt;
                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;f78f0f85-00e2-49b1-95e4-e520df255c9c&quot;/&gt;
                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK SCOPE Verification&quot;/&gt;
                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;any&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;false&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;fail&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;${scope_fail}&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;scope.granted&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;${xpathScope.result}&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;scope.required&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;${scope_required}&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Parameters&gt;
            &lt;/L7p:Encapsulated&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue=&quot;error: invalid_request, error_description: Access token was not granted for required scope, required: ${scope_required}, granted: ${xpathScope.result}&quot;/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;OTkx&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;scope&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:Expression1 stringValue=&quot;${xpathStatus.result}&quot;/&gt;
                &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item dataType=&quot;included&quot;&gt;
                        &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;ENABLED&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue=&quot;error: invalid_request, error_description: Access token is disabled&quot;/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;OTkz&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:FalseAssertion/&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:Expression1 stringValue=&quot;${onetime}&quot;/&gt;
                &lt;L7p:Expression2 stringValue=&quot;false&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;false&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
            &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:Encapsulated&gt;
                        &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;ada963ed-0428-4ead-8576-9ef79193752c&quot;/&gt;
                        &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Token Delete&quot;/&gt;
                        &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;access_token&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;${access_token}&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;client_key&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;refresh_token&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;temp_token&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Parameters&gt;
                    &lt;/L7p:Encapsulated&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${result}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;1 token(s) deleted&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;1 token(s) deleted&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                &lt;/wsp:All&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:Detail stringValue=&quot;WARNING: Access token may still be usable although it was marked as one-time access_token! access_token='${access_token}'&quot;/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;delete token&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:OneOrMore&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;onetime&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;PHZhbGlkYXRpb24geG1sbnM9Imh0dHA6Ly9ucy5sN3RlY2guY29tLzIwMTIvMTEvb3RrLW92cCI+DQogICA8cmVzdWx0PnZhbGlkPC9yZXN1bHQ+DQogICA8Y2xpZW50X2tleT48IVtDREFUQVske3hwYXRoQ2xpZW50S2V5LnJlc3VsdH1dXT48L2NsaWVudF9rZXk+DQogICA8cmVzb3VyY2Vfb3duZXI+PCFbQ0RBVEFbJHt4cGF0aE93bmVyLnJlc3VsdH1dXT48L3Jlc291cmNlX293bmVyPg0KICAgPHNjb3BlPjwhW0NEQVRBWyR7eHBhdGhTY29wZS5yZXN1bHR9XV0+PC9zY29wZT4NCiAgIDxleHBpcmF0aW9uPjwhW0NEQVRBWyR7eHBhdGhFeHBpcmF0aW9uLnJlc3VsdH1dXT48L2V4cGlyYXRpb24+DQogICA8Y3VzdG9tPjwhW0NEQVRBWyR7eHBhdGhDdXN0b20ucmVzdWx0fV1dPjwvY3VzdG9tPg0KPC92YWxpZGF0aW9uPg==&quot;/&gt;
            &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;dGV4dC94bWw7Y2hhcnNldD1VVEYtOA==&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK OAuth 2.0 Token Validation - BEARER</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd322</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.754Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="e001cfd0c1c1ffaa18e187b5e72fd322" version="0">
                            <l7:Name>OTK OAuth 2.0 Token Validation - BEARER</l7:Name>
                            <l7:Guid>2c8a8e1d-fbcd-4d9a-b866-981d923aeb83</l7:Guid>
                            <l7:PolicyReference id="e001cfd0c1c1ffaa18e187b5e72fd1d3" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>tokenValues</l7:ArgumentName>
                                    <l7:ArgumentType>message</l7:ArgumentType>
                                    <l7:GuiLabel>Token values</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>scope_fail</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>scope_required</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>access_token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>5</l7:Ordinal>
                                    <l7:ArgumentName>onetime</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>resp</l7:ResultName>
                                    <l7:ResultType>message</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="artifactVersion">
                                    <l7:StringValue>8cf8496aad6380a24f33889a72ad7bed6d4dfbba</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Validates a given Bearer token profile access_token.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>OAuth_Validation</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_usage">
                                    <l7:StringValue>Internal</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>validate.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>f07df530-d404-47ad-88a6-dadb4421ead3</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>v2GenerateRequestMac</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd0f6</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.826Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="31b00c3c-a333-4e44-8e00-6bfd51b974a8" id="e001cfd0c1c1ffaa18e187b5e72fd0f6" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fc898" guid="31b00c3c-a333-4e44-8e00-6bfd51b974a8" id="e001cfd0c1c1ffaa18e187b5e72fd0f6" version="0">
                                <l7:Name>v2GenerateRequestMac</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Generates request MAC using HMAC-SHA1 algorithm&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Inputs: timestamp_sec, nonce, http_method, url, ext, mac_key, mac_algorithm&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Outputs: mac&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;========== Validate inputs ==========&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:ComparisonAssertion&gt;
            &lt;L7p:Expression1 stringValue=&quot;${timestamp_sec}&quot;/&gt;
            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                &lt;L7p:item binary=&quot;included&quot;&gt;
                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                &lt;/L7p:item&gt;
            &lt;/L7p:Predicates&gt;
        &lt;/L7p:ComparisonAssertion&gt;
        &lt;L7p:Regex&gt;
            &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;timestamp_sec&quot;/&gt;
            &lt;L7p:ProceedIfPatternMatches booleanValue=&quot;false&quot;/&gt;
            &lt;L7p:Regex stringValue=&quot;^0+&quot;/&gt;
            &lt;L7p:RegexName stringValue=&quot;Timestamp must not have leading zeros&quot;/&gt;
            &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
        &lt;/L7p:Regex&gt;
        &lt;L7p:Regex&gt;
            &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;timestamp_sec&quot;/&gt;
            &lt;L7p:ProceedIfPatternMatches booleanValue=&quot;false&quot;/&gt;
            &lt;L7p:Regex stringValue=&quot;^-&quot;/&gt;
            &lt;L7p:RegexName stringValue=&quot;Timestamp must be a positive number&quot;/&gt;
            &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
        &lt;/L7p:Regex&gt;
        &lt;L7p:ComparisonAssertion&gt;
            &lt;L7p:Expression1 stringValue=&quot;${nonce}&quot;/&gt;
            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                &lt;L7p:item binary=&quot;included&quot;&gt;
                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                &lt;/L7p:item&gt;
            &lt;/L7p:Predicates&gt;
        &lt;/L7p:ComparisonAssertion&gt;
        &lt;L7p:ComparisonAssertion&gt;
            &lt;L7p:Expression1 stringValue=&quot;${http_method}&quot;/&gt;
            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                &lt;L7p:item binary=&quot;included&quot;&gt;
                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                &lt;/L7p:item&gt;
            &lt;/L7p:Predicates&gt;
        &lt;/L7p:ComparisonAssertion&gt;
        &lt;L7p:Regex&gt;
            &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;http_method&quot;/&gt;
            &lt;L7p:ProceedIfPatternMatches booleanValue=&quot;false&quot;/&gt;
            &lt;L7p:Regex stringValue=&quot;[a-z]&quot;/&gt;
            &lt;L7p:RegexName stringValue=&quot;HTTP method must be in upper case&quot;/&gt;
            &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
        &lt;/L7p:Regex&gt;
        &lt;L7p:ComparisonAssertion&gt;
            &lt;L7p:Expression1 stringValue=&quot;${url}&quot;/&gt;
            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                &lt;L7p:item binary=&quot;included&quot;&gt;
                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                &lt;/L7p:item&gt;
            &lt;/L7p:Predicates&gt;
        &lt;/L7p:ComparisonAssertion&gt;
        &lt;L7p:ComparisonAssertion&gt;
            &lt;L7p:Expression1 stringValue=&quot;${mac_key}&quot;/&gt;
            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                &lt;L7p:item binary=&quot;included&quot;&gt;
                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                &lt;/L7p:item&gt;
            &lt;/L7p:Predicates&gt;
        &lt;/L7p:ComparisonAssertion&gt;
        &lt;L7p:ComparisonAssertion&gt;
            &lt;L7p:Expression1 stringValue=&quot;${mac_algorithm}&quot;/&gt;
            &lt;L7p:Expression2 stringValue=&quot;hmac-sha-1&quot;/&gt;
            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                &lt;L7p:item binary=&quot;included&quot;&gt;
                    &lt;L7p:RightValue stringValue=&quot;hmac-sha-1&quot;/&gt;
                &lt;/L7p:item&gt;
            &lt;/L7p:Predicates&gt;
        &lt;/L7p:ComparisonAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;========== Break URL into parts (protocol, hostname+port, path) ==========&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:Regex&gt;
            &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
            &lt;L7p:CaptureVar stringValue=&quot;url_sub_string&quot;/&gt;
            &lt;L7p:FindAll booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;url&quot;/&gt;
            &lt;L7p:Regex stringValue=&quot;([a-z]*)://([^/]*)(.*)&quot;/&gt;
            &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
        &lt;/L7p:Regex&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHt1cmxfc3ViX3N0cmluZ1szXX0=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;request_uri&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHt1cmxfc3ViX3N0cmluZ1syXX0=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;url_hostname_port&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;host&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;port&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:CaptureVar stringValue=&quot;url_hostname_port_sub_string&quot;/&gt;
                    &lt;L7p:FindAll booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;url_hostname_port&quot;/&gt;
                    &lt;L7p:Regex stringValue=&quot;([^:]*):([0-9]*)&quot;/&gt;
                    &lt;L7p:RegexName stringValue=&quot;get hostname and port number&quot;/&gt;
                    &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                &lt;/L7p:Regex&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHt1cmxfaG9zdG5hbWVfcG9ydF9zdWJfc3RyaW5nWzFdfQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;host&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHt1cmxfaG9zdG5hbWVfcG9ydF9zdWJfc3RyaW5nWzJdfQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;port&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;port is specified&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHt1cmxfaG9zdG5hbWVfcG9ydH0=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;host&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${url_sub_string[1]}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;http&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;http&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;ODA=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;port&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${url_sub_string[1]}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;https&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;https&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;NDQz&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;port&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Use default port&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;port is not specified&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Get hostname and port number&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:Regex&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Check if there are any uppercases in hostname&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:FindAll booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;host&quot;/&gt;
                    &lt;L7p:Regex stringValue=&quot;[A-Z]&quot;/&gt;
                    &lt;L7p:RegexName stringValue=&quot;Check for uppercase&quot;/&gt;
                    &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                &lt;/L7p:Regex&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;PGhvc3RuYW1lPiR7aG9zdH08L2hvc3RuYW1lPg==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;xml&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHt4bWx9&quot;/&gt;
                    &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;forXSL&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:XslTransformation&gt;
                    &lt;L7p:Direction intValue=&quot;-1&quot;/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;forXSL&quot;/&gt;
                    &lt;L7p:ResourceInfo staticResourceInfo=&quot;included&quot;&gt;
                        &lt;L7p:Document stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[&lt;xsl:stylesheet version=&quot;1.0&quot;
                xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt;
                &lt;xsl:output method=&quot;text&quot; omit-xml-declaration=&quot;yes&quot;/&gt;

                &lt;xsl:variable name=&quot;lowercase&quot; select=&quot;'abcdefghijklmnopqrstuvwxyz'&quot;/&gt;
                &lt;xsl:variable name=&quot;uppercase&quot; select=&quot;'ABCDEFGHIJKLMNOPQRSTUVWXYZ'&quot;/&gt;

                &lt;xsl:template match=&quot;/hostname&quot;&gt;
                &lt;xsl:value-of select=&quot;translate(., $uppercase, $lowercase)&quot;/&gt;
                &lt;/xsl:template&gt;

                &lt;/xsl:stylesheet&gt;]]&gt;&lt;/L7p:Document&gt;
                    &lt;/L7p:ResourceInfo&gt;
                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                    &lt;L7p:TransformName stringValue=&quot;&quot;/&gt;
                &lt;/L7p:XslTransformation&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtmb3JYU0wubWFpbnBhcnR9&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;host&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:TrueAssertion/&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Change hostname to lowercase&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:ComparisonAssertion&gt;
            &lt;L7p:Expression1 stringValue=&quot;${request_uri}&quot;/&gt;
            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                &lt;L7p:item binary=&quot;included&quot;&gt;
                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                &lt;/L7p:item&gt;
            &lt;/L7p:Predicates&gt;
        &lt;/L7p:ComparisonAssertion&gt;
        &lt;L7p:ComparisonAssertion&gt;
            &lt;L7p:Expression1 stringValue=&quot;${host}&quot;/&gt;
            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                &lt;L7p:item binary=&quot;included&quot;&gt;
                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                &lt;/L7p:item&gt;
            &lt;/L7p:Predicates&gt;
        &lt;/L7p:ComparisonAssertion&gt;
        &lt;L7p:ComparisonAssertion&gt;
            &lt;L7p:Expression1 stringValue=&quot;${port}&quot;/&gt;
            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                &lt;L7p:item binary=&quot;included&quot;&gt;
                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                &lt;/L7p:item&gt;
            &lt;/L7p:Predicates&gt;
        &lt;/L7p:ComparisonAssertion&gt;
        &lt;L7p:EncodeDecode&gt;
            &lt;L7p:SourceVariableName stringValue=&quot;request_uri&quot;/&gt;
            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
            &lt;L7p:TargetVariableName stringValue=&quot;request_uri&quot;/&gt;
            &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
        &lt;/L7p:EncodeDecode&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:LineBreak lineBreak=&quot;LF&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;empty_line&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHt0aW1lc3RhbXBfc2VjfQ0KJHtub25jZX0NCiR7aHR0cF9tZXRob2R9DQoke3JlcXVlc3RfdXJpfQ0KJHtob3N0fQ0KJHtwb3J0fQ0KJHtleHR9DQoke2VtcHR5X2xpbmV9&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;normalized_request&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:GenerateSecurityHash&gt;
            &lt;L7p:Base64Data stringValue=&quot;JHtub3JtYWxpemVkX3JlcXVlc3R9&quot;/&gt;
            &lt;L7p:KeyText stringValue=&quot;${mac_key}&quot;/&gt;
            &lt;L7p:LineBreak lineBreak=&quot;CR-LF&quot;/&gt;
            &lt;L7p:TargetOutputVariable stringValue=&quot;mac&quot;/&gt;
        &lt;/L7p:GenerateSecurityHash&gt;
        &lt;L7p:ExportVariables&gt;
            &lt;L7p:ExportedVars stringArrayValue=&quot;included&quot;&gt;
                &lt;L7p:item stringValue=&quot;mac&quot;/&gt;
            &lt;/L7p:ExportedVars&gt;
        &lt;/L7p:ExportVariables&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK OAuth 2.0 Token Validation - MAC</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd1e7</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.844Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="55caa40c-7b56-40ff-a5b1-2933934b787f" id="e001cfd0c1c1ffaa18e187b5e72fd1e7" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fd08e" guid="55caa40c-7b56-40ff-a5b1-2933934b787f" id="e001cfd0c1c1ffaa18e187b5e72fd1e7" version="0">
                                <l7:Name>OTK OAuth 2.0 Token Validation - MAC</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Validates OAuth 2.0 MAC Token profile Access Tokens&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;For MAC tokens only&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:Encapsulated&gt;
            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;2e6e2ef3-a36f-4548-a2c4-7b369b7ae184&quot;/&gt;
            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Variable Configuration&quot;/&gt;
        &lt;/L7p:Encapsulated&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHt0b2tlblZhbHVlcy5tYWlucGFydH0=&quot;/&gt;
            &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;tokenValues&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${oauth2_token_type}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;MAC&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;MAC&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;xpathExpiration&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;tokenValues&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:expiration/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;xpathScope&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;tokenValues&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:scope/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;xpathStatus&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;tokenValues&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:status/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;success&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:AuditDetailAssertion&gt;
                            &lt;L7p:Detail stringValue=&quot;error: invalid_request, error_description: Access token does not exist (expired, revoked, replaced, unknown, ...). access_token='${access_token}'&quot;/&gt;
                        &lt;/L7p:AuditDetailAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;OTkw&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:FalseAssertion/&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Token&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Check for token type, token existence, token values&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${xpathStatus.result}&quot;/&gt;
                        &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item dataType=&quot;included&quot;&gt;
                                &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                            &lt;/L7p:item&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;ENABLED&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:AuditDetailAssertion&gt;
                            &lt;L7p:Detail stringValue=&quot;error: invalid_request, error_description: Access token disabled, status: ${xpathStatus.result}&quot;/&gt;
                        &lt;/L7p:AuditDetailAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;OTkz&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:FalseAssertion/&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;status&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;dateTime&quot;/&gt;
                            &lt;L7p:DateOffsetExpression stringValue=&quot;&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;now&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${now.seconds}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item dataType=&quot;included&quot;&gt;
                                    &lt;L7p:Type variableDataType=&quot;int&quot;/&gt;
                                &lt;/L7p:item&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;LE&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;${xpathExpiration.result}&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:AuditDetailAssertion&gt;
                            &lt;L7p:Detail stringValue=&quot;error: invalid_request, error_description: Access token expired, expiration: ${xpathExpiration.result}, time_now: ${gateway.time.seconds}&quot;/&gt;
                        &lt;/L7p:AuditDetailAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;OTkw&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:FalseAssertion/&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;expiration&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:Encapsulated&gt;
                        &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;f78f0f85-00e2-49b1-95e4-e520df255c9c&quot;/&gt;
                        &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK SCOPE Verification&quot;/&gt;
                        &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;any&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;false&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;fail&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;${scope_fail}&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;scope.granted&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;${xpathScope.result}&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;scope.required&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;${scope_required}&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Parameters&gt;
                    &lt;/L7p:Encapsulated&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:AuditDetailAssertion&gt;
                            &lt;L7p:Detail stringValue=&quot;error: invalid_request, error_description: Access token was not granted for required scope, required: ${scope_required}, granted: ${xpathScope.result}&quot;/&gt;
                        &lt;/L7p:AuditDetailAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;OTkx&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:FalseAssertion/&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;scope&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Expression1 stringValue=&quot;${onetime}&quot;/&gt;
                        &lt;L7p:Expression2 stringValue=&quot;false&quot;/&gt;
                        &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                            &lt;L7p:item binary=&quot;included&quot;&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:RightValue stringValue=&quot;false&quot;/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:Encapsulated&gt;
                                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;ada963ed-0428-4ead-8576-9ef79193752c&quot;/&gt;
                                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Token Delete&quot;/&gt;
                                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;access_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${access_token}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_key&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;refresh_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;temp_token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Parameters&gt;
                            &lt;/L7p:Encapsulated&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Expression1 stringValue=&quot;${result}&quot;/&gt;
                                &lt;L7p:Expression2 stringValue=&quot;1 token(s) deleted&quot;/&gt;
                                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;1 token(s) deleted&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                        &lt;/wsp:All&gt;
                        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:AuditDetailAssertion&gt;
                                &lt;L7p:Detail stringValue=&quot;error: invalid_request, error_description: Access token may still be usable although it was marked as one-time access_token&quot;/&gt;
                            &lt;/L7p:AuditDetailAssertion&gt;
                        &lt;/wsp:All&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;remove&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;isonetime&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Check for one-time usage&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;=== MAC token profile specific validations and token secret lookup&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;xpathSecret&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;tokenValues&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:secret/text()&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:Regex&gt;
                            &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:CaptureVar stringValue=&quot;ts&quot;/&gt;
                            &lt;L7p:FindAll booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;auth_header&quot;/&gt;
                            &lt;L7p:Regex stringValue=&quot;ts\s*=&amp;quot;\s*([^&amp;quot;]*)&amp;quot;&quot;/&gt;
                            &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                        &lt;/L7p:Regex&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${ts[1]}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHt0c1sxXX0=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;timestamp_sec&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:Regex&gt;
                            &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:CaptureVar stringValue=&quot;nonce&quot;/&gt;
                            &lt;L7p:FindAll booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;auth_header&quot;/&gt;
                            &lt;L7p:Regex stringValue=&quot;nonce\s*=&amp;quot;\s*([^&amp;quot;]*)&amp;quot;&quot;/&gt;
                            &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                        &lt;/L7p:Regex&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${nonce[1]}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtub25jZVsxXX0=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;nonce&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHt0aW1lc3RhbXBfc2VjfSR7bm9uY2V9JHt0b2tlbn0=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;replay_arg&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:WssReplayProtection&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Set the right timeframe!&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:CustomExpiryTime intValue=&quot;300000&quot;/&gt;
                            &lt;L7p:CustomIdentifierVariable stringValue=&quot;replay_arg&quot;/&gt;
                            &lt;L7p:CustomProtection booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:CustomScope stringValue=&quot;${service.oid}&quot;/&gt;
                        &lt;/L7p:WssReplayProtection&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:Regex&gt;
                                    &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:CaptureVar stringValue=&quot;ext&quot;/&gt;
                                    &lt;L7p:FindAll booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;auth_header&quot;/&gt;
                                    &lt;L7p:Regex stringValue=&quot;ext\s*=&amp;quot;\s*([^&amp;quot;]*)&amp;quot;&quot;/&gt;
                                    &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                                &lt;/L7p:Regex&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${ext[1]}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHtleHRbMV19&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;ext&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                            &lt;/wsp:All&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;ext&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;ext is optional&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHt4cGF0aFNlY3JldC5yZXN1bHR9&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;mac_key&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${mac_key}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;aG1hYy1zaGEtMQ==&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;mac_algorithm&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:Regex&gt;
                            &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:CaptureVar stringValue=&quot;request_mac&quot;/&gt;
                            &lt;L7p:FindAll booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;auth_header&quot;/&gt;
                            &lt;L7p:Regex stringValue=&quot;mac\s*=&amp;quot;\s*([^&amp;quot;]*)&amp;quot;&quot;/&gt;
                            &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                        &lt;/L7p:Regex&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${request_mac[1]}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtyZXF1ZXN0X21hY1sxXX0=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;request_mac&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:CommentAssertion&gt;
                            &lt;L7p:Comment stringValue=&quot;Generate mac and compare to mac in the request message&quot;/&gt;
                        &lt;/L7p:CommentAssertion&gt;
                        &lt;L7p:Include&gt;
                            &lt;L7p:PolicyGuid stringValue=&quot;31b00c3c-a333-4e44-8e00-6bfd51b974a8&quot;/&gt;
                        &lt;/L7p:Include&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${request_mac}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;${mac}&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:RightValue stringValue=&quot;${mac}&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:CommentAssertion&gt;
                            &lt;L7p:Comment stringValue=&quot;===&quot;/&gt;
                        &lt;/L7p:CommentAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;xpathClientKey&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;tokenValues&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:client_key&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;xpathOwner&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;tokenValues&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:resource_owner&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:VariablePrefix stringValue=&quot;xpathCustom&quot;/&gt;
                            &lt;L7p:XmlMsgSrc stringValue=&quot;tokenValues&quot;/&gt;
                            &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                &lt;L7p:Expression stringValue=&quot;/ns:values/ns:value/ns:custom&quot;/&gt;
                                &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-tokenstore&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Namespaces&gt;
                                &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                            &lt;/L7p:XpathExpression&gt;
                        &lt;/L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;PHZhbGlkYXRpb24geG1sbnM9Imh0dHA6Ly9ucy5sN3RlY2guY29tLzIwMTIvMTEvb3RrLW92cCI+DQogICA8cmVzdWx0PnZhbGlkPC9yZXN1bHQ+DQogICA8Y2xpZW50X2tleT48IVtDREFUQVske3hwYXRoQ2xpZW50S2V5LnJlc3VsdH1dXT48L2NsaWVudF9rZXk+DQogICA8cmVzb3VyY2Vfb3duZXI+PCFbQ0RBVEFbJHt4cGF0aE93bmVyLnJlc3VsdH1dXT48L3Jlc291cmNlX293bmVyPg0KICAgPHNjb3BlPjwhW0NEQVRBWyR7eHBhdGhTY29wZS5yZXN1bHR9XV0+PC9zY29wZT4NCiAgIDxleHBpcmF0aW9uPjwhW0NEQVRBWyR7eHBhdGhFeHBpcmF0aW9uLnJlc3VsdH1dXT48L2V4cGlyYXRpb24+DQogICA8Y3VzdG9tPjwhW0NEQVRBWyR7eHBhdGhDdXN0b20ucmVzdWx0fV1dPjwvY3VzdG9tPg0KPC92YWxpZGF0aW9uPg==&quot;/&gt;
                            &lt;L7p:ContentType stringValue=&quot;text/xml;charset=UTF-8&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;dGV4dC94bWw7Y2hhcnNldD1VVEYtOA==&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;MAC specific&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;do some MAC token profile specific validations&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:AuditDetailAssertion&gt;
                            &lt;L7p:Detail stringValue=&quot;Something during MAC token validation went wrong&quot;/&gt;
                        &lt;/L7p:AuditDetailAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:FalseAssertion/&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;response&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Do MAC specific validations and create response&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:ComparisonAssertion&gt;
                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                &lt;L7p:Expression1 stringValue=&quot;${tokenValues.mainpart}&quot;/&gt;
                &lt;L7p:Expression2 stringValue=&quot;&amp;lt;token&gt;&quot;/&gt;
                &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                &lt;L7p:Operator operator=&quot;CONTAINS&quot;/&gt;
                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                        &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                        &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                        &lt;L7p:Operator operator=&quot;CONTAINS&quot;/&gt;
                        &lt;L7p:RightValue stringValue=&quot;&amp;lt;token&gt;&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Predicates&gt;
            &lt;/L7p:ComparisonAssertion&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK OAuth 2.0 Token Validation - MAC</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd336</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.845Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="e001cfd0c1c1ffaa18e187b5e72fd336" version="0">
                            <l7:Name>OTK OAuth 2.0 Token Validation - MAC</l7:Name>
                            <l7:Guid>93e26a5f-02b5-4a0e-8d76-7ba7e171871a</l7:Guid>
                            <l7:PolicyReference id="e001cfd0c1c1ffaa18e187b5e72fd1e7" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>tokenValues</l7:ArgumentName>
                                    <l7:ArgumentType>message</l7:ArgumentType>
                                    <l7:GuiLabel>Token values</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>http_method</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Used HTTP method</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>url</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Request URL</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>scope_fail</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>5</l7:Ordinal>
                                    <l7:ArgumentName>scope_required</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>6</l7:Ordinal>
                                    <l7:ArgumentName>access_token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>7</l7:Ordinal>
                                    <l7:ArgumentName>onetime</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>8</l7:Ordinal>
                                    <l7:ArgumentName>auth_header</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiPrompt>false</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>resp</l7:ResultName>
                                    <l7:ResultType>message</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="artifactVersion">
                                    <l7:StringValue>c08a08af82a37b3eaa30209bc5077f13eddc4bb5</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Validates a given MAC token profile access_token.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>OAuth_Validation</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_usage">
                                    <l7:StringValue>Internal</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>validate.gif</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>55caa40c-7b56-40ff-a5b1-2933934b787f</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Require OAuth 2.0 Token</l7:Name>
                    <l7:Id>e001cfd0c1c1ffaa18e187b5e72fd841</l7:Id>
                    <l7:Type>POLICY</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.884Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Policy guid="495c191d-9fb1-4f22-a8ec-76ecacf8bef4" id="e001cfd0c1c1ffaa18e187b5e72fd841" version="0">
                            <l7:PolicyDetail folderId="e001cfd0c1c1ffaa18e187b5e72fd08e" guid="495c191d-9fb1-4f22-a8ec-76ecacf8bef4" id="e001cfd0c1c1ffaa18e187b5e72fd841" version="0">
                                <l7:Name>OTK Require OAuth 2.0 Token</l7:Name>
                                <l7:PolicyType>Include</l7:PolicyType>
                                <l7:Properties>
                                    <l7:Property key="revision">
                                        <l7:LongValue>1</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:PolicyDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === ***  THIS POLICY IS READ ONLY ***&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === If you have the need to customize this policy&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; === please contact CA APIM Support so we can improve customization capability&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot; ============================================&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This policy can be found and should be used as 'Encapsulated Assertion'!&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;Include this policy in a service policy to authorize api access based on an oauth 2.0 access token&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:Encapsulated&gt;
            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;7e2b4f64-e226-4a03-980a-c4603163acc0&quot;/&gt;
            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK OVP Configuration&quot;/&gt;
        &lt;/L7p:Encapsulated&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;error code&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;overwritten in case of an error&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;error msg&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;overwritten in case of an error&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;error.msg&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;L7p:Encapsulated&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;find&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;find the access_token, fails if not found&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;dc16f9da-c833-4b0a-8525-8a41ce420795&quot;/&gt;
                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Access Token Retrieval&quot;/&gt;
                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;allow_header&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;true&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;allow_query&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;true&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;auth_header&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;${request.http.header.authorization}&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;auth_param_token&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;${request.http.parameters.access_token}&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;given_access_token&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;${given_access_token}&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Parameters&gt;
            &lt;/L7p:Encapsulated&gt;
            &lt;L7p:Encapsulated&gt;
                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error code&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error code is provided from previous assertion&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:AssertionComment&gt;
                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;${error.code}&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Parameters&gt;
            &lt;/L7p:Encapsulated&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;find the access_token&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Validation location&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Set the location to validate the access_token&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:Base64Expression stringValue=&quot;ZmFsc2U=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;isLocal&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${auth_scheme}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;Bearer&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;Bearer&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;The cacheKey is a combination of access_token, required SCOPE, and the SCOPE-fail-flag&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;CacheKey&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;The key used for caching the token validation result&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHthY2Nlc3NfdG9rZW59JHtzY29wZV9mYWlsfSR7c2NvcGVfcmVxdWlyZWR9&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;cacheKey&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;68ad78a1-f4a1-4568-91e1-0980d95c75cd&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Cache Look Up&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheID&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;accessTokenValidation&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheKey&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${cacheKey}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;maxAcceptableAge&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${cache_lifetime}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;maxEntryAge&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${cache_lifetime}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${host_oauth_ovp_server}&quot;/&gt;
                                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item regex=&quot;included&quot;&gt;
                                    &lt;L7p:Pattern stringValue=&quot;http[s]?://(localhost|127[.]0[.]0[.]1).+&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;set local&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Set the location to validate access token&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;dHJ1ZQ==&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;isLocal&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:Encapsulated&gt;
                                    &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;19902efe-b202-49da-a5d9-619c57ee842a&quot;/&gt;
                                    &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Token Get (token)&quot;/&gt;
                                    &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_key&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;queryOffset&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;0&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;resource_owner&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;return_json&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;false&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;rtoken&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${access_token}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;token_status&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Parameters&gt;
                                &lt;/L7p:Encapsulated&gt;
                                &lt;L7p:Encapsulated&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;It implicitly also uses 'scope_required' and 'scope_fail' and 'access_token'&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;2c8a8e1d-fbcd-4d9a-b866-981d923aeb83&quot;/&gt;
                                    &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK OAuth 2.0 Token Validation - BEARER&quot;/&gt;
                                    &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;tokenValues&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;resp&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Parameters&gt;
                                &lt;/L7p:Encapsulated&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Validate locally&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${isLocal}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;false&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:EncodeDecode&gt;
                                    &lt;L7p:SourceVariableName stringValue=&quot;scope_required&quot;/&gt;
                                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                                    &lt;L7p:TargetVariableName stringValue=&quot;scope_required&quot;/&gt;
                                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                                &lt;/L7p:EncodeDecode&gt;
                                &lt;L7p:EncodeDecode&gt;
                                    &lt;L7p:SourceVariableName stringValue=&quot;access_token&quot;/&gt;
                                    &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                                    &lt;L7p:TargetVariableName stringValue=&quot;access_token&quot;/&gt;
                                    &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                                &lt;/L7p:EncodeDecode&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                                    &lt;L7p:ContentType stringValue=&quot;text/plain; charset=UTF-8&quot;/&gt;
                                    &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;emptyMessage&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:HttpRoutingAssertion&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;no-fail&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;always succeed&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:CurrentSecurityHeaderHandling intValue=&quot;3&quot;/&gt;
                                    &lt;L7p:FailOnErrorStatus booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:HttpMethod httpMethod=&quot;GET&quot;/&gt;
                                    &lt;L7p:PassThroughSoapFaults booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:ProtectedServiceUrl stringValue=&quot;${host_oauth_ovp_server}/oauth/validation/validate/v2/token?access_token=${access_token}&amp;amp;isonetime=${onetime}&amp;amp;auth_scheme=Bearer&amp;amp;scope_required=${scope_required}&amp;amp;scope_fail=${scope_fail}&quot;/&gt;
                                    &lt;L7p:ProxyPassword stringValueNull=&quot;null&quot;/&gt;
                                    &lt;L7p:ProxyUsername stringValueNull=&quot;null&quot;/&gt;
                                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                                    &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;/&gt;
                                    &lt;/L7p:RequestHeaderRules&gt;
                                    &lt;L7p:RequestMsgSrc stringValue=&quot;emptyMessage&quot;/&gt;
                                    &lt;L7p:RequestParamRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                                    &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;/&gt;
                                    &lt;/L7p:RequestParamRules&gt;
                                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                                    &lt;L7p:ForwardAll booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;&gt;
                                    &lt;L7p:item httpPassthroughRule=&quot;included&quot;&gt;
                                    &lt;L7p:Name stringValue=&quot;x-ca-err&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Rules&gt;
                                    &lt;/L7p:ResponseHeaderRules&gt;
                                    &lt;L7p:ResponseMsgDest stringValue=&quot;resp&quot;/&gt;
                                    &lt;L7p:SamlAssertionVersion intValue=&quot;2&quot;/&gt;
                                &lt;/L7p:HttpRoutingAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLmh0dHAuaGVhZGVyLngtY2EtZXJyfQ==&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                                    &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${httpRouting.reasonCode}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;500&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;LT&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;LT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;500&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                    &lt;/L7p:ComparisonAssertion&gt;
                                    &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                    &lt;/L7p:ComparisonAssertion&gt;
                                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                    &lt;L7p:AuditDetailAssertion&gt;
                                    &lt;L7p:Detail stringValue=&quot;routing failed!&quot;/&gt;
                                    &lt;/L7p:AuditDetailAssertion&gt;
                                    &lt;L7p:SetVariable&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error code&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;set error code to 000&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                                    &lt;/L7p:SetVariable&gt;
                                    &lt;L7p:FalseAssertion/&gt;
                                    &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:assertionComment&gt;
                                    &lt;/wsp:All&gt;
                                    &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;routing errors&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;check if the routing assertion was successful&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:assertionComment&gt;
                                &lt;/wsp:OneOrMore&gt;
                                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                                    &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                    &lt;/L7p:ComparisonAssertion&gt;
                                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                    &lt;L7p:Regex&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;capture&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;capture the last 3 digits&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;

                                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;error.code&quot;/&gt;
                                    &lt;L7p:Regex stringValue=&quot;(\d{0,16})(\d{3})$&quot;/&gt;
                                    &lt;L7p:Replace booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Replacement stringValue=&quot;$2&quot;/&gt;
                                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                                    &lt;/L7p:Regex&gt;
                                    &lt;L7p:FalseAssertion/&gt;
                                    &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:assertionComment&gt;
                                    &lt;/wsp:All&gt;
                                    &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error code&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;check for an error code&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:assertionComment&gt;
                                &lt;/wsp:OneOrMore&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLmh0dHAuaGVhZGVyLmNvbnRlbnQtdHlwZX0=&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Validate remotely&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;local or remote validation&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:ResponseXpathAssertion&gt;
                                &lt;L7p:VariablePrefix stringValue=&quot;xpathClientId&quot;/&gt;
                                &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                                &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                    &lt;L7p:Expression stringValue=&quot;/ns:validation/ns:client_key/text()&quot;/&gt;
                                    &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-ovp&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Namespaces&gt;
                                    &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                                &lt;/L7p:XpathExpression&gt;
                            &lt;/L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:ResponseXpathAssertion&gt;
                                &lt;L7p:VariablePrefix stringValue=&quot;xpathOwner&quot;/&gt;
                                &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                                &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                    &lt;L7p:Expression stringValue=&quot;/ns:validation/ns:resource_owner/text()&quot;/&gt;
                                    &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-ovp&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Namespaces&gt;
                                    &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                                &lt;/L7p:XpathExpression&gt;
                            &lt;/L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:ResponseXpathAssertion&gt;
                                &lt;L7p:VariablePrefix stringValue=&quot;xpathScope&quot;/&gt;
                                &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                                &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                    &lt;L7p:Expression stringValue=&quot;/ns:validation/ns:scope/text()&quot;/&gt;
                                    &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-ovp&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Namespaces&gt;
                                    &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                                &lt;/L7p:XpathExpression&gt;
                            &lt;/L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:ResponseXpathAssertion&gt;
                                &lt;L7p:VariablePrefix stringValue=&quot;xpathExpiration&quot;/&gt;
                                &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                                &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                    &lt;L7p:Expression stringValue=&quot;/ns:validation/ns:expiration/text()&quot;/&gt;
                                    &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-ovp&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Namespaces&gt;
                                    &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                                &lt;/L7p:XpathExpression&gt;
                            &lt;/L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:ResponseXpathAssertion&gt;
                                &lt;L7p:VariablePrefix stringValue=&quot;xpathCustom&quot;/&gt;
                                &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                                &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                                    &lt;L7p:Expression stringValue=&quot;/ns:validation/ns:custom&quot;/&gt;
                                    &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-ovp&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Namespaces&gt;
                                    &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                                &lt;/L7p:XpathExpression&gt;
                            &lt;/L7p:ResponseXpathAssertion&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue=&quot;JHt4cGF0aENsaWVudElkLnJlc3VsdH0jQCMke3hwYXRoT3duZXIucmVzdWx0fSNAIyR7eHBhdGhTY29wZS5yZXN1bHR9I0AjJHt4cGF0aEV4cGlyYXRpb24ucmVzdWx0fSNAIyR7eHBhdGhDdXN0b20ucmVzdWx0fQ==&quot;/&gt;
                                &lt;L7p:ContentType stringValue=&quot;text/plain; charset=UTF-8&quot;/&gt;
                                &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                                &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
                            &lt;/L7p:SetVariable&gt;
                            &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${onetime}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;true&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:Encapsulated&gt;
                                    &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;e5ee8bcf-1796-4297-88dd-c838031a6f6a&quot;/&gt;
                                    &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Cache Store&quot;/&gt;
                                    &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheID&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;accessTokenValidation&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheKey&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${cacheKey}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;doNotCacheSoapFaults&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;true&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;maxEntries&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;100000&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;maxEntryAge&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${cache_lifetime}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;maxEntrySize&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;10000&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;msg&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;resp&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Parameters&gt;
                                &lt;/L7p:Encapsulated&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;caching&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;only if it is not a one time access_token&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:OneOrMore&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;collect validation response data&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:All&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;New validation&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                                &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                                &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                                &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                            &lt;/L7p:SetVariable&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;set error.code to '000' if we do not have one (which should not be the case)&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtlcnJvci5jb2RlfQ==&quot;/&gt;
                            &lt;L7p:ContentType stringValue=&quot;text/plain; charset=UTF-8&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;e5ee8bcf-1796-4297-88dd-c838031a6f6a&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Cache Store&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheID&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;accessTokenValidation&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;cacheKey&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${cacheKey}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;doNotCacheSoapFaults&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;true&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;maxEntries&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;100000&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;maxEntryAge&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${cache_lifetime}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;maxEntrySize&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;10000&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;msg&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;resp&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;validation error. Set cache content for invalid token to ''&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Validation&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;Create response variables&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;may contain an error.code&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:AssertionComment&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLm1haW5wYXJ0fQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;resp&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:Regex&gt;
                            &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:CaptureVar stringValue=&quot;resp.details&quot;/&gt;
                            &lt;L7p:OtherTargetMessageVariable stringValue=&quot;resp&quot;/&gt;
                            &lt;L7p:Regex stringValue=&quot;(.{1,128})#@#(.{1,128})#@#(.{1,512})#@#([0-9]{10})#@#(.*)&quot;/&gt;
                            &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                            &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                        &lt;/L7p:Regex&gt;
                        &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                    &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${auth_scheme}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                    &lt;/L7p:ComparisonAssertion&gt;
                                    &lt;L7p:AddHeader&gt;
                                    &lt;L7p:HeaderName stringValue=&quot;WWW-Authenticate&quot;/&gt;
                                    &lt;L7p:HeaderValue stringValue=&quot;${auth_scheme} error=&amp;quot;Invalid request&amp;quot;&quot;/&gt;
                                    &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                                    &lt;/L7p:AddHeader&gt;
                                &lt;/wsp:All&gt;
                                &lt;L7p:TrueAssertion/&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Add WWW-Authenticate header&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:OneOrMore&gt;
                            &lt;L7p:Encapsulated&gt;
                                &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;resp&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;'resp' contains an error code, created during validation&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:AssertionComment&gt;
                                &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                                &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                                &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${resp}&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Parameters&gt;
                            &lt;/L7p:Encapsulated&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;validation error. Set cache content for invalid token to ''&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:All&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;resp&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;check if there is valid content. Respond with an error otherwise&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;MjAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLmRldGFpbHNbMV19&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;session.client_id&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLmRldGFpbHNbMl19&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;session.subscriber_id&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLmRldGFpbHNbM119&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;session.scope&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLmRldGFpbHNbNF19&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;session.expires_at&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLmRldGFpbHNbNV19&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;session.custom&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;create response&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;BEARER token&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${auth_scheme}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;MAC&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:RightValue stringValue=&quot;MAC&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXF1ZXN0Lmh0dHAubWV0aG9kfQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;request_http_method&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtyZXF1ZXN0LnVybH0=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;request_url&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;Caching is not possible for MAC token profile&quot;/&gt;
                &lt;/L7p:CommentAssertion&gt;
                &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${host_oauth_ovp_server}&quot;/&gt;
                            &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item regex=&quot;included&quot;&gt;
                                    &lt;L7p:Pattern stringValue=&quot;http[s]?://(localhost|127[.]0[.]0[.]1).+&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;set local&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Set the location to validate access token&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;dHJ1ZQ==&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;isLocal&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;19902efe-b202-49da-a5d9-619c57ee842a&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Token Get (token)&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;client_key&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;queryOffset&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;0&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;resource_owner&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;return_json&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;false&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;rtoken&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;token&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${access_token}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;token_status&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;93e26a5f-02b5-4a0e-8d76-7ba7e171871a&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK OAuth 2.0 Token Validation - MAC&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;http_method&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${request_http_method}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;tokenValues&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;resp&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;url&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${request_url}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;validate locally&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;L7p:ComparisonAssertion&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Expression1 stringValue=&quot;${isLocal}&quot;/&gt;
                            &lt;L7p:Expression2 stringValue=&quot;false&quot;/&gt;
                            &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;false&quot;/&gt;
                                &lt;/L7p:item&gt;
                            &lt;/L7p:Predicates&gt;
                        &lt;/L7p:ComparisonAssertion&gt;
                        &lt;L7p:EncodeDecode&gt;
                            &lt;L7p:SourceVariableName stringValue=&quot;request_url&quot;/&gt;
                            &lt;L7p:TargetDataType variableDataType=&quot;string&quot;/&gt;
                            &lt;L7p:TargetVariableName stringValue=&quot;request_url&quot;/&gt;
                            &lt;L7p:TransformType transformType=&quot;URL_ENCODE&quot;/&gt;
                        &lt;/L7p:EncodeDecode&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;YXV0aF9zY2hlbWU9TUFDJmh0dHBfbWV0aG9kPSR7cmVxdWVzdF9odHRwX21ldGhvZH0mdXJsPSR7cmVxdWVzdF91cmx9Jmlzb25ldGltZT0ke29uZXRpbWV9&quot;/&gt;
                            &lt;L7p:ContentType stringValue=&quot;application/x-www-form-urlencoded; charset=UTF-8&quot;/&gt;
                            &lt;L7p:DataType variableDataType=&quot;message&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;message&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:HttpRoutingAssertion&gt;
                            &lt;L7p:CurrentSecurityHeaderHandling intValue=&quot;3&quot;/&gt;
                            &lt;L7p:FailOnErrorStatus booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:HttpMethod httpMethod=&quot;POST&quot;/&gt;
                            &lt;L7p:PassThroughSoapFaults booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:ProtectedServiceUrl stringValue=&quot;${host_oauth_ovp_server}/oauth/validation/validate/v2/token&quot;/&gt;
                            &lt;L7p:ProxyPassword stringValueNull=&quot;null&quot;/&gt;
                            &lt;L7p:ProxyUsername stringValueNull=&quot;null&quot;/&gt;
                            &lt;L7p:RequestHeaderRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                                &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;&gt;
                                    &lt;L7p:item httpPassthroughRule=&quot;included&quot;&gt;
                                    &lt;L7p:CustomizeValue stringValue=&quot;${auth_header}&quot;/&gt;
                                    &lt;L7p:Name stringValue=&quot;authorization&quot;/&gt;
                                    &lt;L7p:UsesCustomizedValue booleanValue=&quot;true&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Rules&gt;
                            &lt;/L7p:RequestHeaderRules&gt;
                            &lt;L7p:RequestMsgSrc stringValue=&quot;message&quot;/&gt;
                            &lt;L7p:RequestParamRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                                &lt;L7p:ForwardAll booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;/&gt;
                            &lt;/L7p:RequestParamRules&gt;
                            &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                                &lt;L7p:ForwardAll booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;&gt;
                                    &lt;L7p:item httpPassthroughRule=&quot;included&quot;&gt;
                                    &lt;L7p:Name stringValue=&quot;Set-Cookie&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Rules&gt;
                            &lt;/L7p:ResponseHeaderRules&gt;
                            &lt;L7p:ResponseMsgDest stringValue=&quot;resp&quot;/&gt;
                            &lt;L7p:SamlAssertionVersion intValue=&quot;2&quot;/&gt;
                        &lt;/L7p:HttpRoutingAssertion&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLmh0dHAuaGVhZGVyLngtY2EtZXJyfQ==&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Expression1 stringValue=&quot;${httpRouting.reasonCode}&quot;/&gt;
                                &lt;L7p:Expression2 stringValue=&quot;500&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;LT&quot;/&gt;
                                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;LT&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;500&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                                &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                                &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:AuditDetailAssertion&gt;
                                    &lt;L7p:Detail stringValue=&quot;routing failed!&quot;/&gt;
                                &lt;/L7p:AuditDetailAssertion&gt;
                                &lt;L7p:SetVariable&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error code&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;set error code to 000&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:Base64Expression stringValue=&quot;MDAw&quot;/&gt;
                                    &lt;L7p:VariableToSet stringValue=&quot;error.code&quot;/&gt;
                                &lt;/L7p:SetVariable&gt;
                                &lt;L7p:FalseAssertion/&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;routing errors&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;check if the routing assertion was successful&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                                &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                                &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:Regex&gt;
                                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;capture&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;capture the last 3 digits&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                    &lt;/L7p:AssertionComment&gt;
                                    &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;error.code&quot;/&gt;
                                    &lt;L7p:Regex stringValue=&quot;(\d{0,16})(\d{3})$&quot;/&gt;
                                    &lt;L7p:Replace booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Replacement stringValue=&quot;$2&quot;/&gt;
                                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                                &lt;/L7p:Regex&gt;
                                &lt;L7p:FalseAssertion/&gt;
                                &lt;L7p:assertionComment&gt;
                                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;/L7p:Properties&gt;
                                &lt;/L7p:assertionComment&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error code&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;check for an error code&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:SetVariable&gt;
                            &lt;L7p:Base64Expression stringValue=&quot;JHtyZXNwLmh0dHAuaGVhZGVyLmNvbnRlbnQtdHlwZX0=&quot;/&gt;
                            &lt;L7p:VariableToSet stringValue=&quot;content-type&quot;/&gt;
                        &lt;/L7p:SetVariable&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;validate remotely&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                                &lt;L7p:ComparisonAssertion&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Expression1 stringValue=&quot;${auth_scheme}&quot;/&gt;
                                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                                    &lt;L7p:Negate booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                                    &lt;L7p:item binary=&quot;included&quot;&gt;
                                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                                    &lt;L7p:Negated booleanValue=&quot;true&quot;/&gt;
                                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                                    &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                                    &lt;/L7p:item&gt;
                                    &lt;/L7p:Predicates&gt;
                                &lt;/L7p:ComparisonAssertion&gt;
                                &lt;L7p:AddHeader&gt;
                                    &lt;L7p:HeaderName stringValue=&quot;WWW-Authenticate&quot;/&gt;
                                    &lt;L7p:HeaderValue stringValue=&quot;${auth_scheme} error=&amp;quot;Invalid request&amp;quot;&quot;/&gt;
                                    &lt;L7p:Target target=&quot;RESPONSE&quot;/&gt;
                                &lt;/L7p:AddHeader&gt;
                            &lt;/wsp:All&gt;
                            &lt;L7p:TrueAssertion/&gt;
                            &lt;L7p:assertionComment&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;Add WWW-Authenticate header&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:assertionComment&gt;
                        &lt;/wsp:OneOrMore&gt;
                        &lt;L7p:Encapsulated&gt;
                            &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error code&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                    &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error code provided by previous assertions&quot;/&gt;
                                    &lt;/L7p:entry&gt;
                                &lt;/L7p:Properties&gt;
                            &lt;/L7p:AssertionComment&gt;
                            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;${error.code}&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Parameters&gt;
                        &lt;/L7p:Encapsulated&gt;
                        &lt;L7p:assertionComment&gt;
                            &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;error&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Properties&gt;
                        &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;Validation&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:OneOrMore&gt;
                &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:VariablePrefix stringValue=&quot;xpathClientId&quot;/&gt;
                        &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                        &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                            &lt;L7p:Expression stringValue=&quot;/ns:validation/ns:client_key/text()&quot;/&gt;
                            &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-ovp&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Namespaces&gt;
                            &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                        &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:VariablePrefix stringValue=&quot;xpathOwner&quot;/&gt;
                        &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                        &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                            &lt;L7p:Expression stringValue=&quot;/ns:validation/ns:resource_owner/text()&quot;/&gt;
                            &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-ovp&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Namespaces&gt;
                            &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                        &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:VariablePrefix stringValue=&quot;xpathScope&quot;/&gt;
                        &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                        &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                            &lt;L7p:Expression stringValue=&quot;/ns:validation/ns:scope/text()&quot;/&gt;
                            &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-ovp&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Namespaces&gt;
                            &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                        &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:VariablePrefix stringValue=&quot;xpathExpiration&quot;/&gt;
                        &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                        &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                            &lt;L7p:Expression stringValue=&quot;/ns:validation/ns:expiration/text()&quot;/&gt;
                            &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-ovp&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Namespaces&gt;
                            &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                        &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                        &lt;L7p:VariablePrefix stringValue=&quot;xpathCustom&quot;/&gt;
                        &lt;L7p:XmlMsgSrc stringValue=&quot;resp&quot;/&gt;
                        &lt;L7p:XpathExpression xpathExpressionValue=&quot;included&quot;&gt;
                            &lt;L7p:Expression stringValue=&quot;/ns:validation/ns:custom&quot;/&gt;
                            &lt;L7p:Namespaces mapValue=&quot;included&quot;&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;ns&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://ns.l7tech.com/2012/11/otk-ovp&quot;/&gt;
                                &lt;/L7p:entry&gt;
                                &lt;L7p:entry&gt;
                                    &lt;L7p:key stringValue=&quot;s&quot;/&gt;
                                    &lt;L7p:value stringValue=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;/&gt;
                                &lt;/L7p:entry&gt;
                            &lt;/L7p:Namespaces&gt;
                            &lt;L7p:XpathVersion xpathVersion=&quot;XPATH_1_0&quot;/&gt;
                        &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;MjAw&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;status&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHt4cGF0aENsaWVudElkLnJlc3VsdH0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;session.client_id&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHt4cGF0aE93bmVyLnJlc3VsdH0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;session.subscriber_id&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHt4cGF0aFNjb3BlLnJlc3VsdH0=&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;session.scope&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHt4cGF0aEV4cGlyYXRpb24ucmVzdWx0fQ==&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;session.expires_at&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue=&quot;JHt4cGF0aEN1c3RvbS5yZXN1bHR9&quot;/&gt;
                        &lt;L7p:VariableToSet stringValue=&quot;session.custom&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;create response variables&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                &lt;/wsp:All&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;MAC token&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${error.code}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:Operator operator=&quot;EMPTY&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:Encapsulated&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;000&quot;/&gt;
                            &lt;/L7p:entry&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;something unknown happened&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;56bd8147-3ab4-4d09-9460-8b2de02b7a9e&quot;/&gt;
                    &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Fail with error message&quot;/&gt;
                    &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;apiPrefix&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;&quot;/&gt;
                        &lt;/L7p:entry&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;givenErrorCode&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;000&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Parameters&gt;
                &lt;/L7p:Encapsulated&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;error. Something unexpected happened&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;validate&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Policy>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>OTK Require OAuth 2.0 Token</l7:Name>
                    <l7:Id>3f6b5c92ca2ac3665bc7d8780bc4d718</l7:Id>
                    <l7:Type>ENCAPSULATED_ASSERTION</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.884Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:EncapsulatedAssertion id="3f6b5c92ca2ac3665bc7d8780bc4d718" version="0">
                            <l7:Name>OTK Require OAuth 2.0 Token</l7:Name>
                            <l7:Guid>393bcb93-82ad-4b55-8333-1119f607a560</l7:Guid>
                            <l7:PolicyReference id="e001cfd0c1c1ffaa18e187b5e72fd841" resourceUri="http://ns.l7tech.com/2010/04/gateway-management/policies"/>
                            <l7:EncapsulatedArguments>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>1</l7:Ordinal>
                                    <l7:ArgumentName>scope_required</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Required SCOPE(s)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>2</l7:Ordinal>
                                    <l7:ArgumentName>cache_lifetime</l7:ArgumentName>
                                    <l7:ArgumentType>int</l7:ArgumentType>
                                    <l7:GuiLabel>Cache validation result (s)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>3</l7:Ordinal>
                                    <l7:ArgumentName>onetime</l7:ArgumentName>
                                    <l7:ArgumentType>boolean</l7:ArgumentType>
                                    <l7:GuiLabel>Is this a one-time access_token?</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>4</l7:Ordinal>
                                    <l7:ArgumentName>scope_fail</l7:ArgumentName>
                                    <l7:ArgumentType>boolean</l7:ArgumentType>
                                    <l7:GuiLabel>Fail if this SCOPE was granted?</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                                <l7:EncapsulatedAssertionArgument>
                                    <l7:Ordinal>5</l7:Ordinal>
                                    <l7:ArgumentName>given_access_token</l7:ArgumentName>
                                    <l7:ArgumentType>string</l7:ArgumentType>
                                    <l7:GuiLabel>Access Token (Bearer only, optional)</l7:GuiLabel>
                                    <l7:GuiPrompt>true</l7:GuiPrompt>
                                </l7:EncapsulatedAssertionArgument>
                            </l7:EncapsulatedArguments>
                            <l7:EncapsulatedResults>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>access_token</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>content-type</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.code</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>error.msg</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>session.client_id</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>session.custom</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>session.expires_at</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>session.scope</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>session.subscriber_id</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                                <l7:EncapsulatedAssertionResult>
                                    <l7:ResultName>status</l7:ResultName>
                                    <l7:ResultType>string</l7:ResultType>
                                </l7:EncapsulatedAssertionResult>
                            </l7:EncapsulatedResults>
                            <l7:Properties>
                                <l7:Property key="allowTracing">
                                    <l7:StringValue>true</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="description">
                                    <l7:StringValue>Validates an OAuth 2.0 access_token for a request. By default the request will fail if the given access_token has expired or does not match the given configuration.</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_category">
                                    <l7:StringValue>Access_Control</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_in_cache_lifetime">
                                    <l7:StringValue>Time in seconds for which the access_token will not be validated again. Use this value as a compromise between increasing performance and security. A typical value would be '30'</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_in_given_access_token">
                                    <l7:StringValue>Use this field if no access_token is received through the request message but was issued out-of-band</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_in_onetime">
                                    <l7:StringValue>If set to 'true' the access_token (and the associated refresh_token) will be invalidated after being used once. Default = 'false'</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_in_scope_fail">
                                    <l7:StringValue>If set to 'true' the assertion fails if the given SCOPE was granted for this access_token</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_in_scope_required">
                                    <l7:StringValue>A space separated list of SCOPE values this access_token MUST have been granted for</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_out_access_token">
                                    <l7:StringValue>The access_token of the request</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_out_content-type">
                                    <l7:StringValue>The content-type of the 'error.msg' if it exists</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_out_session.client_id">
                                    <l7:StringValue>The client_id for which the access_token was granted</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_out_session.custom">
                                    <l7:StringValue>A JSON structure containing the used grant_type, the client_type and values specified in the custom field of the associated client_id</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_out_session.scope">
                                    <l7:StringValue>The SCOPE that was granted to the access_token</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="doc_out_session.subscriber_id">
                                    <l7:StringValue>The user who granted the access_token/ client</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteFolder">
                                    <l7:StringValue>internalAssertions</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="paletteIconResourceName">
                                    <l7:StringValue>oauth.png</l7:StringValue>
                                </l7:Property>
                                <l7:Property key="policyGuid">
                                    <l7:StringValue>495c191d-9fb1-4f22-a8ec-76ecacf8bef4</l7:StringValue>
                                </l7:Property>
                            </l7:Properties>
                        </l7:EncapsulatedAssertion>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>protected/resource/products</l7:Name>
                    <l7:Id>cbeedf1e2650e80f4d660a7fdb8ffa8b</l7:Id>
                    <l7:Type>SERVICE</l7:Type>
                    <l7:TimeStamp>2019-04-05T18:12:22.926Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Service id="cbeedf1e2650e80f4d660a7fdb8ffa8b" version="3">
                            <l7:ServiceDetail folderId="eed408a0ac7bfb3a931f0533fd581c85" id="cbeedf1e2650e80f4d660a7fdb8ffa8b" version="3">
                                <l7:Name>protected/resource/products</l7:Name>
                                <l7:Enabled>true</l7:Enabled>
                                <l7:ServiceMappings>
                                    <l7:HttpMapping>
                                        <l7:UrlPattern>/protected/resource/products</l7:UrlPattern>
                                        <l7:Verbs>
                                            <l7:Verb>GET</l7:Verb>
                                            <l7:Verb>POST</l7:Verb>
                                            <l7:Verb>PUT</l7:Verb>
                                            <l7:Verb>DELETE</l7:Verb>
                                        </l7:Verbs>
                                    </l7:HttpMapping>
                                </l7:ServiceMappings>
                                <l7:Properties>
                                    <l7:Property key="internal">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                    <l7:Property key="policyRevision">
                                        <l7:LongValue>11</l7:LongValue>
                                    </l7:Property>
                                    <l7:Property key="soap">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                    <l7:Property key="tracingEnabled">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                    <l7:Property key="wssProcessingEnabled">
                                        <l7:BooleanValue>false</l7:BooleanValue>
                                    </l7:Property>
                                </l7:Properties>
                            </l7:ServiceDetail>
                            <l7:Resources>
                                <l7:ResourceSet tag="policy">
                                    <l7:Resource type="policy" version="10">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This is a test endpoint to use ssl mutual authentication for testing purposes&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue=&quot;This endpoint can safely be disabled or deleted.&quot;/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:AuditDetailAssertion&gt;
            &lt;L7p:Detail stringValueReference=&quot;inline&quot;&gt;&lt;![CDATA[${request.tcp.remoteIP} [${gateway.time.local}] &quot;${request.http.method} ${request.url}&quot;
Authorization: ${request.http.header.authorization}]]&gt;&lt;/L7p:Detail&gt;
            &lt;L7p:Level stringValue=&quot;WARNING&quot;/&gt;
        &lt;/L7p:AuditDetailAssertion&gt;
        &lt;L7p:AuditAssertion&gt;
            &lt;L7p:SaveRequest booleanValue=&quot;true&quot;/&gt;
            &lt;L7p:SaveResponse booleanValue=&quot;true&quot;/&gt;
        &lt;/L7p:AuditAssertion&gt;
        &lt;L7p:CustomizeErrorResponse&gt;
            &lt;L7p:Content stringValue=&quot;${error.msg}&quot;/&gt;
            &lt;L7p:ContentType stringValue=&quot;${content-type}&quot;/&gt;
            &lt;L7p:ExtraHeaders nameValuePairArray=&quot;included&quot;&gt;
                &lt;L7p:item nameValuePair=&quot;included&quot;&gt;
                    &lt;L7p:Key stringValue=&quot;Cache-Control&quot;/&gt;
                    &lt;L7p:Value stringValue=&quot;no-store&quot;/&gt;
                &lt;/L7p:item&gt;
                &lt;L7p:item nameValuePair=&quot;included&quot;&gt;
                    &lt;L7p:Key stringValue=&quot;Pragma&quot;/&gt;
                    &lt;L7p:Value stringValue=&quot;no-cache&quot;/&gt;
                &lt;/L7p:item&gt;
                &lt;L7p:item nameValuePair=&quot;included&quot;&gt;
                    &lt;L7p:Key stringValue=&quot;x-ca-err&quot;/&gt;
                    &lt;L7p:Value stringValue=&quot;0001${error.code}&quot;/&gt;
                &lt;/L7p:item&gt;
            &lt;/L7p:ExtraHeaders&gt;
            &lt;L7p:HttpStatus stringValue=&quot;${status}&quot;/&gt;
        &lt;/L7p:CustomizeErrorResponse&gt;
        &lt;L7p:Encapsulated&gt;
            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;ce9faafc-7d76-4818-9c56-0bb9a4b68e9c&quot;/&gt;
            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;MSSO Require Registered Device - Mutual SSL&quot;/&gt;
            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;lookupDevice&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;true&quot;/&gt;
                &lt;/L7p:entry&gt;
            &lt;/L7p:Parameters&gt;
        &lt;/L7p:Encapsulated&gt;
        &lt;L7p:Encapsulated&gt;
            &lt;L7p:EncapsulatedAssertionConfigGuid stringValue=&quot;393bcb93-82ad-4b55-8333-1119f607a560&quot;/&gt;
            &lt;L7p:EncapsulatedAssertionConfigName stringValue=&quot;OTK Require OAuth 2.0 Token&quot;/&gt;
            &lt;L7p:Parameters mapValue=&quot;included&quot;&gt;
                &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;cache_lifetime&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;30&quot;/&gt;
                &lt;/L7p:entry&gt;
                &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;given_access_token&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                &lt;/L7p:entry&gt;
                &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;onetime&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;false&quot;/&gt;
                &lt;/L7p:entry&gt;
                &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;scope_fail&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;false&quot;/&gt;
                &lt;/L7p:entry&gt;
                &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;scope_required&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;&quot;/&gt;
                &lt;/L7p:entry&gt;
            &lt;/L7p:Parameters&gt;
        &lt;/L7p:Encapsulated&gt;
        &lt;L7p:SetVariable&gt;
            &lt;L7p:Base64Expression stringValue=&quot;JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLm9wZXJhdGlvbn0=&quot;/&gt;
            &lt;L7p:VariableToSet stringValue=&quot;operation&quot;/&gt;
        &lt;/L7p:SetVariable&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${operation}&quot;/&gt;
                    &lt;L7p:ExpressionIsVariable booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;listProducts&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:RateLimit&gt;
                    &lt;L7p:CounterName stringValue=&quot;PRESET(40dedeb4e6122752)&quot;/&gt;
                    &lt;L7p:MaxRequestsPerSecond stringValue=&quot;1&quot;/&gt;
                &lt;/L7p:RateLimit&gt;
                &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;200&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue=&quot;eyAicHJvZHVjdHMiOiBbCiAgICB7ImlkIjogMSwgIm5hbWUiOiAiQW1lcmljYW4gQmVhdXR5IiwgInByaWNlIjogIjUuOTUifSwKICAgIHsiaWQiOiAyLCAibmFtZSI6ICI5MCBNaW51dGUgSVBBIiwgInByaWNlIjogIjYuOTUifSwKICAgIHsiaWQiOiA0LCAibmFtZSI6ICJCb2F0IEJlZXIiLCAicHJpY2UiOiAiNC44NSJ9LAogICAgeyJpZCI6IDksICJuYW1lIjogIlBlZXBlciBBbGUiLCAicHJpY2UiOiAiNS41MCJ9LAogICAgeyJpZCI6IDgsICJuYW1lIjogIkhvcEhhbmRzIiwgInByaWNlIjogIjUuOTkifSwKICAgIHsiaWQiOiAxMCwgIm5hbWUiOiAiSG9wc2xhbSBBbGUiLCAicHJpY2UiOiAiNi41MCJ9CiAgXSwKICAiZGV2aWNlX2dlbyI6ICIke3JlcXVlc3QuaHR0cC5oZWFkZXIuZ2VvLWxvY2F0aW9ufSIsCiAgImNsaWVudENlcnQuc3ViamVjdCI6ICIke3JlcXVlc3Quc3NsLmNsaWVudENlcnRpZmljYXRlLnN1YmplY3R9Igp9&quot;/&gt;
                    &lt;L7p:ResponseContentType stringValue=&quot;application/json; charset=utf-8&quot;/&gt;
                &lt;/L7p:HardcodedResponse&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;List Products&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${operation}&quot;/&gt;
                    &lt;L7p:ExpressionIsVariable booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                        &lt;L7p:item dataType=&quot;included&quot;&gt;
                            &lt;L7p:Type variableDataType=&quot;string&quot;/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item binary=&quot;included&quot;&gt;
                            &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                            &lt;L7p:RightValue stringValue=&quot;listProducts&quot;/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                &lt;/L7p:ComparisonAssertion&gt;
                &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                        &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                                &lt;L7p:value stringValue=&quot;200&quot;/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue=&quot;eyAicHJvZHVjdHMiOiBbCiAgICB7ImlkIjogMSwgIm5hbWUiOiAiVG9vIEZhc3QiLCAicHJpY2UiOiAieC54eCJ9LAogICAgeyJpZCI6IDIsICJuYW1lIjogIlRvbyBGYXN0IiwgInByaWNlIjogIngueHgifQogIF0sCiAgImRldmljZV9nZW8iOiAiJHtyZXF1ZXN0Lmh0dHAuaGVhZGVyLmdlby1sb2NhdGlvbn0iLAogICJjbGllbnRDZXJ0LnN1YmplY3QiOiAiJHtyZXF1ZXN0LnNzbC5jbGllbnRDZXJ0aWZpY2F0ZS5zdWJqZWN0fSIKfQ==&quot;/&gt;
                    &lt;L7p:ResponseContentType stringValue=&quot;application/json; charset=utf-8&quot;/&gt;
                &lt;/L7p:HardcodedResponse&gt;
                &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                        &lt;L7p:entry&gt;
                            &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                            &lt;L7p:value stringValue=&quot;List Products&quot;/&gt;
                        &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                &lt;/L7p:assertionComment&gt;
            &lt;/wsp:All&gt;
            &lt;L7p:FalseAssertion/&gt;
            &lt;L7p:assertionComment&gt;
                &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue=&quot;LEFT.COMMENT&quot;/&gt;
                        &lt;L7p:value stringValue=&quot;Find operation&quot;/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:assertionComment&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                                </l7:ResourceSet>
                            </l7:Resources>
                        </l7:Service>
                    </l7:Resource>
                </l7:Item>
            </l7:References>
            <l7:Mappings>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d169147d0" srcUri="https://mas.docker.local:8443/restman/1.0/folders/161861da3a78c5dcdc62696d169147d0" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="c2656fd5ff575252902a7e330e355f53" srcUri="https://mas.docker.local:8443/restman/1.0/policies/c2656fd5ff575252902a7e330e355f53" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d16914896" srcUri="https://mas.docker.local:8443/restman/1.0/policies/161861da3a78c5dcdc62696d16914896" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d16914883" srcUri="https://mas.docker.local:8443/restman/1.0/policies/161861da3a78c5dcdc62696d16914883" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d1691481a" srcUri="https://mas.docker.local:8443/restman/1.0/folders/161861da3a78c5dcdc62696d1691481a" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d16914861" srcUri="https://mas.docker.local:8443/restman/1.0/policies/161861da3a78c5dcdc62696d16914861" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d16914bbb" srcUri="https://mas.docker.local:8443/restman/1.0/policies/161861da3a78c5dcdc62696d16914bbb" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d16914c21" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/161861da3a78c5dcdc62696d16914c21" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d16914781" srcUri="https://mas.docker.local:8443/restman/1.0/folders/161861da3a78c5dcdc62696d16914781" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="bc9a31b7578652a08a514d7d4fef9afd" srcUri="https://mas.docker.local:8443/restman/1.0/policies/bc9a31b7578652a08a514d7d4fef9afd" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="cbeedf1e2650e80f4d660a7fdb8fee5f" srcUri="https://mas.docker.local:8443/restman/1.0/folders/cbeedf1e2650e80f4d660a7fdb8fee5f" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="4523fc52bc5d9d089bb24fe624c30982" srcUri="https://mas.docker.local:8443/restman/1.0/policies/4523fc52bc5d9d089bb24fe624c30982" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="4523fc52bc5d9d089bb24fe624c30a28" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/4523fc52bc5d9d089bb24fe624c30a28" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="020d2de3d0ee651635de40e179c5f83a" srcUri="https://mas.docker.local:8443/restman/1.0/policies/020d2de3d0ee651635de40e179c5f83a" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="020d2de3d0ee651635de40e179c5f84e" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/020d2de3d0ee651635de40e179c5f84e" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d16914be5" srcUri="https://mas.docker.local:8443/restman/1.0/policies/161861da3a78c5dcdc62696d16914be5" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="161861da3a78c5dcdc62696d16914c44" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/161861da3a78c5dcdc62696d16914c44" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd08e" srcUri="https://mas.docker.local:8443/restman/1.0/folders/e001cfd0c1c1ffaa18e187b5e72fd08e" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="d1bde3d2021a469e82ebf8cac288bbd1" srcUri="https://mas.docker.local:8443/restman/1.0/policies/d1bde3d2021a469e82ebf8cac288bbd1" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="d1bde3d2021a469e82ebf8cac288bd97" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/d1bde3d2021a469e82ebf8cac288bd97" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="Ignore" srcId="44a7a65d79dc7272d4675d318261cfc0" srcUri="https://mas.docker.local:8443/restman/1.0/identityProviders/44a7a65d79dc7272d4675d318261cfc0" type="ID_PROVIDER_CONFIG"/>
                <l7:Mapping action="NewOrExisting" srcId="24e6fd7c5b6fb3a96690246c8ac49304" srcUri="https://mas.docker.local:8443/restman/1.0/policies/24e6fd7c5b6fb3a96690246c8ac49304" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fc858" srcUri="https://mas.docker.local:8443/restman/1.0/folders/e001cfd0c1c1ffaa18e187b5e72fc858" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fc9d0" srcUri="https://mas.docker.local:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fc9d0" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fcac5" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/e001cfd0c1c1ffaa18e187b5e72fcac5" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="Ignore" srcId="cbeedf1e2650e80f4d660a7fdb8fea13" srcUri="https://mas.docker.local:8443/restman/1.0/jdbcConnections/cbeedf1e2650e80f4d660a7fdb8fea13" type="JDBC_CONNECTION"/>
                <l7:Mapping action="NewOrExisting" srcId="cbeedf1e2650e80f4d660a7fdb8fef1f" srcUri="https://mas.docker.local:8443/restman/1.0/folders/cbeedf1e2650e80f4d660a7fdb8fef1f" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="cbeedf1e2650e80f4d660a7fdb8fefff" srcUri="https://mas.docker.local:8443/restman/1.0/policies/cbeedf1e2650e80f4d660a7fdb8fefff" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="cbeedf1e2650e80f4d660a7fdb8ff423" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/cbeedf1e2650e80f4d660a7fdb8ff423" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="Ignore" type="CASSANDRA_CONFIGURATION">
                    <l7:Properties>
                        <l7:Property key="MapBy">
                            <l7:StringValue>name</l7:StringValue>
                        </l7:Property>
                        <l7:Property key="MapTo">
                            <l7:StringValue>MAG_OAuth_Cassandra</l7:StringValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="cbeedf1e2650e80f4d660a7fdb8ff320" srcUri="https://mas.docker.local:8443/restman/1.0/policies/cbeedf1e2650e80f4d660a7fdb8ff320" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="cbeedf1e2650e80f4d660a7fdb8ff609" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/cbeedf1e2650e80f4d660a7fdb8ff609" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="00000000000000000000000000000002:SSL" srcUri="https://mas.docker.local:8443/restman/1.0/privateKeys/00000000000000000000000000000002:SSL" type="SSG_KEY_ENTRY">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="cbeedf1e2650e80f4d660a7fdb8fed5f" srcUri="https://mas.docker.local:8443/restman/1.0/folders/cbeedf1e2650e80f4d660a7fdb8fed5f" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="cbeedf1e2650e80f4d660a7fdb8fefd7" srcUri="https://mas.docker.local:8443/restman/1.0/policies/cbeedf1e2650e80f4d660a7fdb8fefd7" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="cbeedf1e2650e80f4d660a7fdb8ff3d5" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/cbeedf1e2650e80f4d660a7fdb8ff3d5" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="cbeedf1e2650e80f4d660a7fdb8ff104" srcUri="https://mas.docker.local:8443/restman/1.0/policies/cbeedf1e2650e80f4d660a7fdb8ff104" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="a94971d96bb22d04d7aa77886bae39d8" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/a94971d96bb22d04d7aa77886bae39d8" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="24e6fd7c5b6fb3a96690246c8ac492ec" srcUri="https://mas.docker.local:8443/restman/1.0/policies/24e6fd7c5b6fb3a96690246c8ac492ec" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd82d" srcUri="https://mas.docker.local:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fd82d" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fda9a" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/e001cfd0c1c1ffaa18e187b5e72fda9a" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fcfce" srcUri="https://mas.docker.local:8443/restman/1.0/folders/e001cfd0c1c1ffaa18e187b5e72fcfce" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd86a" srcUri="https://mas.docker.local:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fd86a" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fdaa0" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/e001cfd0c1c1ffaa18e187b5e72fdaa0" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="Ignore" srcId="4432207d16a1b505e8a6ed59993eaa24" srcUri="https://mas.docker.local:8443/restman/1.0/jdbcConnections/4432207d16a1b505e8a6ed59993eaa24" type="JDBC_CONNECTION"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fcbcd" srcUri="https://mas.docker.local:8443/restman/1.0/folders/e001cfd0c1c1ffaa18e187b5e72fcbcd" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fcc49" srcUri="https://mas.docker.local:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fcc49" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fce1e" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/e001cfd0c1c1ffaa18e187b5e72fce1e" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fcd11" srcUri="https://mas.docker.local:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fcd11" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fce6a" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/e001cfd0c1c1ffaa18e187b5e72fce6a" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd1ab" srcUri="https://mas.docker.local:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fd1ab" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd20f" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/e001cfd0c1c1ffaa18e187b5e72fd20f" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="0000000000000000fffffffffff5519f" srcUri="https://mas.docker.local:8443/restman/1.0/clusterProperties/0000000000000000fffffffffff5519f" type="CLUSTER_PROPERTY">
                    <l7:Properties>
                        <l7:Property key="MapBy">
                            <l7:StringValue>name</l7:StringValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="24e6fd7c5b6fb3a96690246c8ac49335" srcUri="https://mas.docker.local:8443/restman/1.0/policies/24e6fd7c5b6fb3a96690246c8ac49335" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd183" srcUri="https://mas.docker.local:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fd183" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd2da" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/e001cfd0c1c1ffaa18e187b5e72fd2da" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd147" srcUri="https://mas.docker.local:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fd147" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd28f" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/e001cfd0c1c1ffaa18e187b5e72fd28f" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fccc1" srcUri="https://mas.docker.local:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fccc1" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fcdfa" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/e001cfd0c1c1ffaa18e187b5e72fcdfa" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fcce9" srcUri="https://mas.docker.local:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fcce9" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fce5a" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/e001cfd0c1c1ffaa18e187b5e72fce5a" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd16f" srcUri="https://mas.docker.local:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fd16f" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd25d" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/e001cfd0c1c1ffaa18e187b5e72fd25d" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd1d3" srcUri="https://mas.docker.local:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fd1d3" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd322" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/e001cfd0c1c1ffaa18e187b5e72fd322" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fc898" srcUri="https://mas.docker.local:8443/restman/1.0/folders/e001cfd0c1c1ffaa18e187b5e72fc898" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd0f6" srcUri="https://mas.docker.local:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fd0f6" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd1e7" srcUri="https://mas.docker.local:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fd1e7" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd336" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/e001cfd0c1c1ffaa18e187b5e72fd336" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="e001cfd0c1c1ffaa18e187b5e72fd841" srcUri="https://mas.docker.local:8443/restman/1.0/policies/e001cfd0c1c1ffaa18e187b5e72fd841" type="POLICY"/>
                <l7:Mapping action="NewOrExisting" srcId="3f6b5c92ca2ac3665bc7d8780bc4d718" srcUri="https://mas.docker.local:8443/restman/1.0/encapsulatedAssertions/3f6b5c92ca2ac3665bc7d8780bc4d718" type="ENCAPSULATED_ASSERTION"/>
                <l7:Mapping action="NewOrExisting" srcId="eed408a0ac7bfb3a931f0533fd581c85" srcUri="https://mas.docker.local:8443/restman/1.0/folders/eed408a0ac7bfb3a931f0533fd581c85" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrUpdate" srcId="cbeedf1e2650e80f4d660a7fdb8ffa8b" srcUri="https://mas.docker.local:8443/restman/1.0/services/cbeedf1e2650e80f4d660a7fdb8ffa8b" type="SERVICE"/>
            </l7:Mappings>
        </l7:Bundle>